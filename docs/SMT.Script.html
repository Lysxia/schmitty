<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="SMT.Theory.html" class="Module">SMT.Theory</a>

<a id="25" class="Keyword">module</a> <a id="32" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="43" class="Symbol">{</a><a id="44" href="SMT.Script.html#44" class="Bound">theory</a> <a id="51" class="Symbol">:</a> <a id="53" href="SMT.Theory.html#849" class="Record">Theory</a><a id="59" class="Symbol">}</a> <a id="61" class="Symbol">(</a><a id="62" href="SMT.Script.html#62" class="Bound">printable</a> <a id="72" class="Symbol">:</a> <a id="74" href="SMT.Theory.html#1152" class="Record">Printable</a> <a id="84" href="SMT.Script.html#44" class="Bound">theory</a><a id="90" class="Symbol">)</a> <a id="92" class="Symbol">(</a><a id="93" href="SMT.Script.html#93" class="Bound">parsable</a> <a id="102" class="Symbol">:</a> <a id="104" href="SMT.Theory.html#1391" class="Record">Parsable</a> <a id="113" href="SMT.Script.html#44" class="Bound">theory</a><a id="119" class="Symbol">)</a> <a id="121" class="Keyword">where</a>

<a id="128" class="Keyword">open</a> <a id="133" class="Keyword">import</a> <a id="140" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="149" class="Symbol">as</a> <a id="152" class="Module">Fin</a> <a id="156" class="Keyword">using</a> <a id="162" class="Symbol">(</a><a id="163" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a><a id="166" class="Symbol">)</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.List.html" class="Module">Data.List</a> <a id="190" class="Symbol">as</a> <a id="193" class="Module">List</a> <a id="198" class="Keyword">using</a> <a id="204" class="Symbol">(</a><a id="205" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="209" class="Symbol">;</a> <a id="211" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="214" class="Symbol">;</a> <a id="216" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="218" class="Symbol">;</a> <a id="220" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="224" class="Symbol">)</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="257" class="Symbol">as</a> <a id="260" class="Module">List⁺</a> <a id="266" class="Keyword">using</a> <a id="272" class="Symbol">(</a><a id="273" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a><a id="278" class="Symbol">;</a> <a id="280" href="Data.List.NonEmpty.html#1364" class="InductiveConstructor Operator">_∷_</a><a id="283" class="Symbol">)</a>
<a id="285" class="Keyword">open</a> <a id="290" class="Keyword">import</a> <a id="297" href="Data.Product.html" class="Module">Data.Product</a> <a id="310" class="Symbol">as</a> <a id="313" class="Module">Prod</a> <a id="318" class="Keyword">using</a> <a id="324" class="Symbol">(</a><a id="325" href="Data.Product.html#1369" class="Function">∃</a><a id="326" class="Symbol">;</a> <a id="328" href="Data.Product.html#1788" class="Function">∃-syntax</a><a id="336" class="Symbol">;</a> <a id="338" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="341" class="Symbol">)</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="372" class="Keyword">using</a> <a id="378" class="Symbol">(</a><a id="379" href="Relation.Nullary.html#1508" class="Record">Dec</a><a id="382" class="Symbol">;</a> <a id="384" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a><a id="387" class="Symbol">;</a> <a id="389" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a><a id="391" class="Symbol">)</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="432" class="Keyword">using</a> <a id="438" class="Symbol">(</a><a id="439" href="Relation.Nullary.Decidable.Core.html#1365" class="Function">True</a><a id="443" class="Symbol">)</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="495" class="Keyword">using</a> <a id="501" class="Symbol">(</a><a id="502" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="505" class="Symbol">;</a> <a id="507" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="511" class="Symbol">)</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="SMT.Logics.html" class="Module">SMT.Logics</a>
<a id="536" class="Keyword">open</a> <a id="541" class="Keyword">import</a> <a id="548" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="565" class="Symbol">as</a> <a id="568" class="Module">Env</a> <a id="572" class="Keyword">using</a> <a id="578" class="Symbol">(</a><a id="579" href="Data.Environment.html#360" class="Datatype">Env</a><a id="582" class="Symbol">;</a> <a id="584" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="587" class="Symbol">;</a> <a id="589" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="591" class="Symbol">)</a>

<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="621" class="Keyword">open</a> <a id="626" class="Keyword">import</a> <a id="633" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="654" class="Symbol">as</a> <a id="657" class="Module">StateCat</a> <a id="666" class="Keyword">using</a> <a id="672" class="Symbol">(</a><a id="673" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="687" class="Symbol">;</a> <a id="689" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="696" class="Symbol">)</a>
<a id="698" class="Keyword">open</a> <a id="703" class="Keyword">import</a> <a id="710" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="732" class="Symbol">as</a> <a id="735" class="Module">Stream</a> <a id="742" class="Keyword">using</a> <a id="748" class="Symbol">(</a><a id="749" href="Codata.Musical.Stream.html#674" class="Datatype">Stream</a><a id="755" class="Symbol">)</a>
<a id="757" class="Keyword">open</a> <a id="762" class="Keyword">import</a> <a id="769" href="Data.Char.html" class="Module">Data.Char</a> <a id="779" class="Symbol">as</a> <a id="782" class="Module">Char</a> <a id="787" class="Keyword">using</a> <a id="793" class="Symbol">(</a><a id="794" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="798" class="Symbol">)</a>
<a id="800" class="Keyword">open</a> <a id="805" class="Keyword">import</a> <a id="812" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="823" class="Symbol">as</a> <a id="826" class="Module">Maybe</a> <a id="832" class="Keyword">using</a> <a id="838" class="Symbol">(</a><a id="839" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="844" class="Symbol">;</a> <a id="846" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="850" class="Symbol">;</a> <a id="852" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="859" class="Symbol">)</a>
<a id="861" class="Keyword">open</a> <a id="866" class="Keyword">import</a> <a id="873" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="882" class="Symbol">as</a> <a id="885" class="Module">Nat</a> <a id="889" class="Keyword">using</a> <a id="895" class="Symbol">(</a><a id="896" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="897" class="Symbol">)</a>
<a id="899" class="Keyword">open</a> <a id="904" class="Keyword">import</a> <a id="911" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="925" class="Keyword">renaming</a> <a id="934" class="Symbol">(</a><a id="935" href="Data.Nat.Show.html#1076" class="Function">show</a> <a id="940" class="Symbol">to</a> <a id="Show.show"></a><a id="943" href="SMT.Script.html#943" class="Function">showℕ</a><a id="948" class="Symbol">)</a>
<a id="950" class="Keyword">open</a> <a id="955" class="Keyword">import</a> <a id="962" href="Data.Product.html" class="Module">Data.Product</a> <a id="975" class="Symbol">as</a> <a id="978" class="Module">Product</a> <a id="986" class="Keyword">using</a> <a id="992" class="Symbol">(</a><a id="993" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="996" class="Symbol">;</a> <a id="998" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1001" class="Symbol">;</a> <a id="1003" href="Data.Product.html#2196" class="Function Operator">-,_</a><a id="1006" class="Symbol">;</a> <a id="1008" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1013" class="Symbol">;</a> <a id="1015" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1020" class="Symbol">)</a>
<a id="1022" class="Keyword">open</a> <a id="1027" class="Keyword">import</a> <a id="1034" href="Data.String.html" class="Module">Data.String</a> <a id="1046" class="Symbol">as</a> <a id="1049" class="Module">String</a> <a id="1056" class="Keyword">using</a> <a id="1062" class="Symbol">(</a><a id="1063" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1069" class="Symbol">)</a>
<a id="1071" class="Keyword">open</a> <a id="1076" class="Keyword">import</a> <a id="1083" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1093" class="Symbol">as</a> <a id="1096" class="Module">Unit</a> <a id="1101" class="Keyword">using</a> <a id="1107" class="Symbol">(</a><a id="1108" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1109" class="Symbol">)</a>
<a id="1111" class="Keyword">open</a> <a id="1116" class="Keyword">import</a> <a id="1123" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1132" class="Symbol">as</a> <a id="1135" class="Module">Vec</a> <a id="1139" class="Keyword">using</a> <a id="1145" class="Symbol">(</a><a id="1146" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="1149" class="Symbol">)</a>
<a id="1151" class="Keyword">open</a> <a id="1156" class="Keyword">import</a> <a id="1163" href="Function.html" class="Module">Function</a> <a id="1172" class="Keyword">using</a> <a id="1178" class="Symbol">(</a><a id="1179" href="Function.Base.html#636" class="Function">const</a><a id="1184" class="Symbol">;</a> <a id="1186" href="Function.Base.html#615" class="Function">id</a><a id="1188" class="Symbol">;</a> <a id="1190" href="Function.Base.html#992" class="Function Operator">_∘_</a><a id="1193" class="Symbol">;</a> <a id="1195" href="Function.Base.html#1577" class="Function Operator">_$_</a><a id="1198" class="Symbol">)</a>
<a id="1200" class="Keyword">import</a> <a id="1207" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1237" class="Symbol">as</a> <a id="1240" class="Module">Identity</a>
<a id="1249" class="Keyword">open</a> <a id="1254" class="Keyword">import</a> <a id="1261" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="1280" class="Symbol">as</a> <a id="1283" class="Module">P</a> <a id="1285" class="Keyword">hiding</a> <a id="1292" class="Symbol">(</a><a id="1293" href="Text.Parser.String.html#3950" class="Function Operator">_&gt;&gt;=_</a><a id="1298" class="Symbol">)</a>
<a id="1300" class="Keyword">open</a> <a id="1305" class="Keyword">import</a> <a id="1312" href="Reflection.html" class="Module">Reflection</a> <a id="1323" class="Keyword">using</a> <a id="1329" class="Symbol">(</a><a id="1330" href="Agda.Builtin.Reflection.html#4404" class="InductiveConstructor">con</a><a id="1333" class="Symbol">;</a> <a id="1335" href="Reflection.Argument.html#1071" class="InductiveConstructor">vArg</a><a id="1339" class="Symbol">)</a>

<a id="1342" class="Keyword">open</a> <a id="1347" class="Keyword">import</a> <a id="1354" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1370" href="SMT.Script.html#44" class="Bound">theory</a>
<a id="1377" class="Keyword">open</a> <a id="1382" class="Keyword">import</a> <a id="1389" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1406" href="SMT.Script.html#44" class="Bound">theory</a>

<a id="1414" class="Keyword">open</a> <a id="1419" href="SMT.Theory.html#849" class="Module">Theory</a> <a id="1426" href="SMT.Script.html#44" class="Bound">theory</a>
<a id="1433" class="Keyword">open</a> <a id="1438" href="SMT.Theory.html#1152" class="Module">Printable</a> <a id="1448" href="SMT.Script.html#62" class="Bound">printable</a>
<a id="1458" class="Keyword">open</a> <a id="1463" href="SMT.Theory.html#1391" class="Module">Parsable</a> <a id="1472" href="SMT.Script.html#93" class="Bound">parsable</a>

<a id="1482" class="Keyword">private</a>
  <a id="1492" class="Keyword">variable</a>
    <a id="1505" href="SMT.Script.html#1505" class="Generalizable">σ</a> <a id="1507" href="SMT.Script.html#1507" class="Generalizable">σ′</a>    <a id="1513" class="Symbol">:</a> <a id="1515" href="SMT.Theory.html#881" class="Function">Sort</a>
    <a id="1524" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="1526" href="SMT.Script.html#1526" class="Generalizable">Γ′</a> <a id="1529" href="SMT.Script.html#1529" class="Generalizable">δΓ</a> <a id="1532" class="Symbol">:</a> <a id="1534" href="SMT.Script.Base.html#693" class="Function">Ctxt</a>
    <a id="1543" href="SMT.Script.html#1543" class="Generalizable">Δ</a> <a id="1545" href="SMT.Script.html#1545" class="Generalizable">Δ′</a>    <a id="1551" class="Symbol">:</a> <a id="1553" href="SMT.Script.Base.html#693" class="Function">Ctxt</a>
    <a id="1562" href="SMT.Script.html#1562" class="Generalizable">Σ</a>       <a id="1570" class="Symbol">:</a> <a id="1572" href="SMT.Theory.html#329" class="Record">Signature</a> <a id="1582" href="SMT.Script.html#1505" class="Generalizable">σ</a>
    <a id="1588" href="SMT.Script.html#1588" class="Generalizable">Σ′</a>      <a id="1596" class="Symbol">:</a> <a id="1598" href="SMT.Theory.html#329" class="Record">Signature</a> <a id="1608" href="SMT.Script.html#1507" class="Generalizable">σ′</a>
    <a id="1615" href="SMT.Script.html#1615" class="Generalizable">ξ</a> <a id="1617" href="SMT.Script.html#1617" class="Generalizable">ξ′</a>    <a id="1623" class="Symbol">:</a> <a id="1625" href="SMT.Script.Base.html#2713" class="Datatype">OutputType</a>
    <a id="1640" href="SMT.Script.html#1640" class="Generalizable">Ξ</a> <a id="1642" href="SMT.Script.html#1642" class="Generalizable">Ξ′</a> <a id="1645" href="SMT.Script.html#1645" class="Generalizable">δΞ</a> <a id="1648" class="Symbol">:</a> <a id="1650" href="SMT.Script.Base.html#2807" class="Function">OutputCtxt</a>


<a id="1663" class="Comment">-- |Create an S-expression from a list of strings.</a>
<a id="1714" class="Comment">--</a>
<a id="1717" class="Comment">-- @</a>
<a id="1722" class="Comment">--   mkSTerm (&quot;*&quot; ∷ &quot;4&quot; ∷ &quot;5&quot;) ≡ &quot;(* 4 5)&quot;</a>
<a id="1765" class="Comment">-- @</a>
<a id="1770" class="Comment">--</a>
<a id="mkSTerm"></a><a id="1773" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="1781" class="Symbol">:</a> <a id="1783" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1788" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="1795" class="Symbol">→</a> <a id="1797" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
<a id="1804" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="1812" class="Symbol">=</a> <a id="1814" href="Data.String.Base.html#2863" class="Function">String.parens</a> <a id="1828" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1830" href="Data.String.Base.html#2805" class="Function">String.unwords</a>


<a id="1847" class="Comment">-- * Variable parsers</a>

<a id="1870" class="Comment">-- |Environment of variable parsers.</a>
<a id="VarParsers"></a><a id="1907" href="SMT.Script.html#1907" class="Function">VarParsers</a> <a id="1918" class="Symbol">:</a> <a id="1920" href="SMT.Script.Base.html#693" class="Function">Ctxt</a> <a id="1925" class="Symbol">→</a> <a id="1927" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1931" href="SMT.Script.html#1907" class="Function">VarParsers</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="1948" class="Symbol">(λ</a> <a id="1951" href="SMT.Script.html#1951" class="Bound">σ</a> <a id="1953" href="SMT.Script.html#1953" class="Bound">Γ</a> <a id="1955" class="Symbol">→</a> <a id="1957" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1960" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="1967" class="Symbol">((</a><a id="1969" href="SMT.Script.html#1951" class="Bound">σ</a> <a id="1971" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1973" href="SMT.Script.html#1953" class="Bound">Γ</a><a id="1974" class="Symbol">)</a> <a id="1976" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="1978" href="SMT.Script.html#1951" class="Bound">σ</a><a id="1979" class="Symbol">)</a> <a id="1981" href="Relation.Unary.html#3359" class="Function">]</a><a id="1982" class="Symbol">)</a>

<a id="1985" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
<a id="mkVarParser"></a><a id="2065" href="SMT.Script.html#2065" class="Function">mkVarParser</a> <a id="2077" class="Symbol">:</a> <a id="2079" href="SMT.Script.html#1907" class="Function">VarParsers</a> <a id="2090" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="2092" class="Symbol">→</a> <a id="2094" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2097" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="2104" class="Symbol">(</a><a id="2105" href="Data.Product.html#1788" class="Function">∃[</a> <a id="2108" href="SMT.Script.html#2108" class="Bound">σ</a> <a id="2110" href="Data.Product.html#1788" class="Function">]</a> <a id="2112" class="Symbol">(</a><a id="2113" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="2115" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="2117" href="SMT.Script.html#2108" class="Bound">σ</a><a id="2118" class="Symbol">))</a> <a id="2121" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2123" href="SMT.Script.html#2065" class="Function">mkVarParser</a> <a id="2135" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="2149" class="Symbol">=</a> <a id="2151" href="Text.Parser.String.html#4391" class="Function">fail</a>
<a id="2156" href="SMT.Script.html#2065" class="Function">mkVarParser</a> <a id="2168" class="Symbol">(</a><a id="2169" href="SMT.Script.html#2169" class="Bound">p</a> <a id="2171" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="2173" href="SMT.Script.html#2173" class="Bound">env</a><a id="2176" class="Symbol">)</a> <a id="2178" class="Symbol">{</a><a id="2179" href="SMT.Script.html#2179" class="Bound">x</a><a id="2180" class="Symbol">}</a> <a id="2182" class="Symbol">=</a> <a id="2184" class="Symbol">(</a><a id="2185" href="Data.Product.html#2196" class="Function Operator">-,_</a> <a id="2189" href="Text.Parser.String.html#4562" class="Function Operator">&lt;$&gt;</a> <a id="2193" href="SMT.Script.html#2169" class="Bound">p</a> <a id="2195" class="Symbol">{</a><a id="2196" href="SMT.Script.html#2179" class="Bound">x</a><a id="2197" class="Symbol">})</a> <a id="2200" href="Text.Parser.String.html#4464" class="Function Operator">&lt;|&gt;</a> <a id="2204" class="Symbol">(</a><a id="2205" href="Data.Product.html#2435" class="Function">Prod.map</a> <a id="2214" href="Function.Base.html#615" class="Function">id</a> <a id="2217" href="SMT.Script.Base.html#1708" class="Function">extendVar</a> <a id="2227" href="Text.Parser.String.html#4562" class="Function Operator">&lt;$&gt;</a> <a id="2231" href="SMT.Script.html#2065" class="Function">mkVarParser</a> <a id="2243" href="SMT.Script.html#2173" class="Bound">env</a> <a id="2247" class="Symbol">{</a><a id="2248" href="SMT.Script.html#2179" class="Bound">x</a><a id="2249" class="Symbol">})</a>


<a id="2254" class="Comment">-- * Output parsers</a>

<a id="2275" class="Comment">-- |Mapping from output types to parser types.</a>
<a id="OutputParser"></a><a id="2322" href="SMT.Script.html#2322" class="Function">OutputParser</a> <a id="2335" class="Symbol">:</a> <a id="2337" href="SMT.Script.Base.html#2713" class="Datatype">OutputType</a> <a id="2348" class="Symbol">→</a> <a id="2350" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2354" href="SMT.Script.html#2322" class="Function">OutputParser</a> <a id="2367" href="SMT.Script.html#2367" class="Bound">ξ</a> <a id="2369" class="Symbol">=</a> <a id="2371" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2374" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="2381" class="Symbol">(</a><a id="2382" href="SMT.Script.Base.html#3777" class="Function">Output</a> <a id="2389" href="SMT.Script.html#2367" class="Bound">ξ</a><a id="2390" class="Symbol">)</a> <a id="2392" href="Relation.Unary.html#3359" class="Function">]</a>

<a id="2395" class="Comment">-- |Mapping from output contexts to parser types.</a>
<a id="OutputParsers"></a><a id="2445" href="SMT.Script.html#2445" class="Function">OutputParsers</a> <a id="2459" class="Symbol">:</a> <a id="2461" href="SMT.Script.Base.html#2807" class="Function">OutputCtxt</a> <a id="2472" class="Symbol">→</a> <a id="2474" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2478" href="SMT.Script.html#2445" class="Function">OutputParsers</a> <a id="2492" href="SMT.Script.html#2492" class="Bound">Ξ</a> <a id="2494" class="Symbol">=</a> <a id="2496" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2500" class="Symbol">(λ</a> <a id="2503" href="SMT.Script.html#2503" class="Bound">ξ</a> <a id="2505" href="SMT.Script.html#2505" class="Bound Operator">_Ξ</a> <a id="2508" class="Symbol">→</a> <a id="2510" href="SMT.Script.html#2322" class="Function">OutputParser</a> <a id="2523" href="SMT.Script.html#2503" class="Bound">ξ</a><a id="2524" class="Symbol">)</a> <a id="2526" href="SMT.Script.html#2492" class="Bound">Ξ</a>

<a id="2529" class="Comment">-- |Parse a satisfiability result.</a>
<a id="parseSat"></a><a id="2564" href="SMT.Script.html#2564" class="Function">parseSat</a> <a id="2573" class="Symbol">:</a> <a id="2575" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2578" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="2585" href="SMT.Script.Base.html#2958" class="Datatype">Sat</a> <a id="2589" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2591" href="SMT.Script.html#2564" class="Function">parseSat</a> <a id="2600" class="Symbol">=</a> <a id="2602" href="Text.Parser.String.html#5841" class="Function">withSpaces</a> <a id="2613" class="Symbol">(</a><a id="2614" href="SMT.Script.html#2656" class="Function">pSat</a> <a id="2619" href="Text.Parser.String.html#4464" class="Function Operator">&lt;|&gt;</a> <a id="2623" href="SMT.Script.html#2693" class="Function">pUnsat</a> <a id="2630" href="Text.Parser.String.html#4464" class="Function Operator">&lt;|&gt;</a> <a id="2634" href="SMT.Script.html#2732" class="Function">pUnknown</a><a id="2642" class="Symbol">)</a>
  <a id="2646" class="Keyword">where</a>
    <a id="2656" href="SMT.Script.html#2656" class="Function">pSat</a>     <a id="2665" class="Symbol">=</a> <a id="2667" href="SMT.Script.Base.html#2976" class="InductiveConstructor">sat</a>     <a id="2675" href="Text.Parser.String.html#4658" class="Function Operator">&lt;$</a> <a id="2678" href="Text.Parser.String.html#5485" class="Function">text</a> <a id="2683" class="String">&quot;sat&quot;</a>
    <a id="2693" href="SMT.Script.html#2693" class="Function">pUnsat</a>   <a id="2702" class="Symbol">=</a> <a id="2704" href="SMT.Script.Base.html#2992" class="InductiveConstructor">unsat</a>   <a id="2712" href="Text.Parser.String.html#4658" class="Function Operator">&lt;$</a> <a id="2715" href="Text.Parser.String.html#5485" class="Function">text</a> <a id="2720" class="String">&quot;unsat&quot;</a>
    <a id="2732" href="SMT.Script.html#2732" class="Function">pUnknown</a> <a id="2741" class="Symbol">=</a> <a id="2743" href="SMT.Script.Base.html#3008" class="InductiveConstructor">unknown</a> <a id="2751" href="Text.Parser.String.html#4658" class="Function Operator">&lt;$</a> <a id="2754" href="Text.Parser.String.html#5485" class="Function">text</a> <a id="2759" class="String">&quot;unknown&quot;</a>


<a id="2771" href="SMT.Script.html#2771" class="Function">_</a> <a id="2773" class="Symbol">:</a> <a id="2775" href="SMT.Script.html#2564" class="Function">parseSat</a> <a id="2784" href="Text.Parser.String.html#7068" class="Function Operator">parses</a> <a id="2791" class="String">&quot;sat&quot;</a> <a id="2797" href="Text.Parser.String.html#7068" class="Function Operator">as</a> <a id="2800" class="Symbol">(</a><a id="2801" href="SMT.Script.Base.html#3023" class="Function Operator">_≟-Sat</a> <a id="2808" href="SMT.Script.Base.html#2976" class="InductiveConstructor">sat</a><a id="2811" class="Symbol">)</a>
<a id="2813" class="Symbol">_</a> <a id="2815" class="Symbol">=</a> <a id="2817" class="Symbol">_</a>

<a id="2820" href="SMT.Script.html#2820" class="Function">_</a> <a id="2822" class="Symbol">:</a> <a id="2824" href="SMT.Script.html#2564" class="Function">parseSat</a> <a id="2833" href="Text.Parser.String.html#7068" class="Function Operator">parses</a> <a id="2840" class="String">&quot;unsat&quot;</a> <a id="2848" href="Text.Parser.String.html#7068" class="Function Operator">as</a> <a id="2851" class="Symbol">(</a><a id="2852" href="SMT.Script.Base.html#3023" class="Function Operator">_≟-Sat</a> <a id="2859" href="SMT.Script.Base.html#2992" class="InductiveConstructor">unsat</a><a id="2864" class="Symbol">)</a>
<a id="2866" class="Symbol">_</a> <a id="2868" class="Symbol">=</a> <a id="2870" class="Symbol">_</a>

<a id="2873" href="SMT.Script.html#2873" class="Function">_</a> <a id="2875" class="Symbol">:</a> <a id="2877" href="SMT.Script.html#2564" class="Function">parseSat</a> <a id="2886" href="Text.Parser.String.html#7068" class="Function Operator">parses</a> <a id="2893" class="String">&quot;unknown&quot;</a> <a id="2903" href="Text.Parser.String.html#7068" class="Function Operator">as</a> <a id="2906" class="Symbol">(</a><a id="2907" href="SMT.Script.Base.html#3023" class="Function Operator">_≟-Sat</a> <a id="2914" href="SMT.Script.Base.html#3008" class="InductiveConstructor">unknown</a><a id="2921" class="Symbol">)</a>
<a id="2923" class="Symbol">_</a> <a id="2925" class="Symbol">=</a> <a id="2927" class="Symbol">_</a>

<a id="2930" href="SMT.Script.html#2930" class="Function">_</a> <a id="2932" class="Symbol">:</a> <a id="2934" href="SMT.Script.html#2564" class="Function">parseSat</a> <a id="2943" href="Text.Parser.String.html#7561" class="Function Operator">rejects</a> <a id="2951" class="String">&quot;dogfood&quot;</a>
<a id="2961" class="Symbol">_</a> <a id="2963" class="Symbol">=</a> <a id="2965" class="Symbol">_</a>


<a id="2969" class="Comment">-- Connect the output of showScript, via parseVarAssign, to parse models.</a>
<a id="parseModel"></a><a id="3043" href="SMT.Script.html#3043" class="Function">parseModel</a> <a id="3054" class="Symbol">:</a> <a id="3056" href="SMT.Script.html#1907" class="Function">VarParsers</a> <a id="3067" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="3069" class="Symbol">→</a> <a id="3071" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3074" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="3081" class="Symbol">(</a><a id="3082" href="SMT.Script.Base.html#3658" class="Datatype">Model</a> <a id="3088" href="SMT.Script.html#1524" class="Generalizable">Γ</a><a id="3089" class="Symbol">)</a> <a id="3091" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3093" href="SMT.Script.html#3043" class="Function">parseModel</a> <a id="3104" class="Symbol">{</a><a id="3105" href="SMT.Script.html#3105" class="Bound">Γ</a><a id="3106" class="Symbol">}</a> <a id="3108" href="SMT.Script.html#3108" class="Bound">vps</a> <a id="3112" class="Symbol">=</a>
  <a id="3116" href="Text.Parser.String.html#3860" class="Function">guardM</a> <a id="3123" href="SMT.Script.html#5162" class="Function">checkModel</a> <a id="3134" class="Symbol">((</a><a id="3136" href="SMT.Script.html#4856" class="Function">unsafeBuildModel</a> <a id="3153" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3155" href="Data.List.NonEmpty.html#1760" class="Function">List⁺.toList</a><a id="3167" class="Symbol">)</a> <a id="3169" href="Text.Parser.String.html#4562" class="Function Operator">&lt;$&gt;</a> <a id="3173" href="SMT.Script.html#4269" class="Function">parseVarAssigns</a><a id="3188" class="Symbol">)</a>
  <a id="3192" class="Keyword">where</a>
    <a id="3202" href="SMT.Script.html#3202" class="Function">parseVarName</a> <a id="3215" class="Symbol">:</a> <a id="3217" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3220" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="3227" class="Symbol">(</a><a id="3228" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3231" href="SMT.Script.html#3231" class="Bound">σ</a> <a id="3233" href="Data.Product.html#1788" class="Function">]</a> <a id="3235" class="Symbol">(</a><a id="3236" href="SMT.Script.html#3105" class="Bound">Γ</a> <a id="3238" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="3240" href="SMT.Script.html#3231" class="Bound">σ</a><a id="3241" class="Symbol">))</a> <a id="3244" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="3250" href="SMT.Script.html#3202" class="Function">parseVarName</a> <a id="3263" class="Symbol">=</a> <a id="3265" href="Text.Parser.String.html#5841" class="Function">withSpaces</a> <a id="3276" class="Symbol">(</a><a id="3277" href="SMT.Script.html#2065" class="Function">mkVarParser</a> <a id="3289" class="Symbol">{</a><a id="3290" href="SMT.Script.html#3105" class="Bound">Γ</a><a id="3291" class="Symbol">}</a> <a id="3293" href="SMT.Script.html#3108" class="Bound">vps</a><a id="3296" class="Symbol">)</a>

    <a id="3303" class="Comment">-- |Parse a variable assignment.</a>
    <a id="3340" href="SMT.Script.html#3340" class="Function">parseVarAssign</a> <a id="3355" class="Symbol">:</a> <a id="3357" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3360" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="3367" class="Symbol">(</a><a id="3368" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3371" href="SMT.Script.html#3371" class="Bound">σ</a> <a id="3373" href="Data.Product.html#1788" class="Function">]</a> <a id="3375" class="Symbol">(</a><a id="3376" href="SMT.Script.html#3105" class="Bound">Γ</a> <a id="3378" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="3380" href="SMT.Script.html#3371" class="Bound">σ</a> <a id="3382" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3384" href="SMT.Theory.html#970" class="Function">Value</a> <a id="3390" href="SMT.Script.html#3371" class="Bound">σ</a><a id="3391" class="Symbol">))</a> <a id="3394" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="3400" href="SMT.Script.html#3340" class="Function">parseVarAssign</a> <a id="3415" class="Symbol">=</a> <a id="3417" href="Text.Parser.String.html#5764" class="Function">parens</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Text.Parser.String.html#4324" class="Function">box</a> <a id="3429" class="Symbol">(</a><a id="3430" href="Text.Parser.String.html#3860" class="Function">guardM</a> <a id="3437" href="SMT.Script.html#3999" class="Function">checkVarAssign</a> <a id="3452" href="SMT.Script.html#3744" class="Function">unsafeParseVarAssign</a><a id="3472" class="Symbol">))</a>
      <a id="3481" class="Keyword">where</a>
      <a id="3493" class="Comment">-- Parse a pair of a sort and a value of that sort.</a>
      <a id="3551" href="SMT.Script.html#3551" class="Function">parseSortValue</a> <a id="3566" class="Symbol">:</a> <a id="3568" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3571" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="3578" class="Symbol">(</a><a id="3579" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3582" href="SMT.Script.html#3582" class="Bound">σ</a> <a id="3584" href="Data.Product.html#1788" class="Function">]</a> <a id="3586" class="Symbol">(</a><a id="3587" href="SMT.Theory.html#970" class="Function">Value</a> <a id="3593" href="SMT.Script.html#3582" class="Bound">σ</a><a id="3594" class="Symbol">))</a> <a id="3597" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="3605" href="SMT.Script.html#3551" class="Function">parseSortValue</a> <a id="3620" class="Symbol">=</a> <a id="3622" href="SMT.Theory.html#1464" class="Field">readSort</a> <a id="3631" href="Text.Parser.String.html#3950" class="Function Operator">P.&gt;&gt;=</a> <a id="3637" class="Symbol">λ</a> <a id="3639" href="SMT.Script.html#3639" class="Bound">σ</a> <a id="3641" class="Symbol">→</a> <a id="3643" href="Text.Parser.String.html#4324" class="Function">box</a> <a id="3647" class="Symbol">(</a><a id="3648" href="Data.Product.html#2196" class="Function Operator">-,_</a> <a id="3652" href="Text.Parser.String.html#4562" class="Function Operator">&lt;$&gt;</a> <a id="3656" href="SMT.Theory.html#1498" class="Field">readValue</a> <a id="3666" href="SMT.Script.html#3639" class="Bound">σ</a><a id="3667" class="Symbol">)</a>

      <a id="3676" class="Comment">-- Parse a variable assignment, with possibly distinct sorts.</a>
      <a id="3744" href="SMT.Script.html#3744" class="Function">unsafeParseVarAssign</a> <a id="3765" class="Symbol">:</a> <a id="3767" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3770" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="3777" class="Symbol">(</a><a id="3778" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3781" href="SMT.Script.html#3781" class="Bound">σ</a> <a id="3783" href="Data.Product.html#1788" class="Function">]</a> <a id="3785" class="Symbol">(</a><a id="3786" href="SMT.Script.html#3105" class="Bound">Γ</a> <a id="3788" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="3790" href="SMT.Script.html#3781" class="Bound">σ</a><a id="3791" class="Symbol">)</a> <a id="3793" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3795" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3798" href="SMT.Script.html#3798" class="Bound">σ</a> <a id="3800" href="Data.Product.html#1788" class="Function">]</a> <a id="3802" class="Symbol">(</a><a id="3803" href="SMT.Theory.html#970" class="Function">Value</a> <a id="3809" href="SMT.Script.html#3798" class="Bound">σ</a><a id="3810" class="Symbol">))</a> <a id="3813" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="3821" href="SMT.Script.html#3744" class="Function">unsafeParseVarAssign</a> <a id="3842" class="Symbol">=</a>
        <a id="3852" href="Text.Parser.String.html#5485" class="Function">text</a> <a id="3857" class="String">&quot;define-fun&quot;</a> <a id="3870" href="Text.Parser.String.html#4243" class="Function Operator">&amp;&gt;</a> <a id="3873" href="Text.Parser.String.html#4324" class="Function">box</a> <a id="3877" class="Symbol">(</a><a id="3878" href="SMT.Script.html#3202" class="Function">parseVarName</a> <a id="3891" href="Text.Parser.String.html#4072" class="Function Operator">&lt;&amp;&gt;</a> <a id="3895" href="Text.Parser.String.html#4324" class="Function">box</a> <a id="3899" class="Symbol">(</a><a id="3900" href="Text.Parser.String.html#5485" class="Function">text</a> <a id="3905" class="String">&quot;()&quot;</a> <a id="3910" href="Text.Parser.String.html#4243" class="Function Operator">&amp;&gt;</a> <a id="3913" href="Text.Parser.String.html#4324" class="Function">box</a> <a id="3917" href="SMT.Script.html#3551" class="Function">parseSortValue</a><a id="3931" class="Symbol">))</a>

      <a id="3941" class="Comment">-- Check if the expect and actual sorts correspond.</a>
      <a id="3999" href="SMT.Script.html#3999" class="Function">checkVarAssign</a> <a id="4014" class="Symbol">:</a> <a id="4016" href="Data.Product.html#1788" class="Function">∃[</a> <a id="4019" href="SMT.Script.html#4019" class="Bound">σ</a> <a id="4021" href="Data.Product.html#1788" class="Function">]</a> <a id="4023" class="Symbol">(</a><a id="4024" href="SMT.Script.html#3105" class="Bound">Γ</a> <a id="4026" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="4028" href="SMT.Script.html#4019" class="Bound">σ</a><a id="4029" class="Symbol">)</a> <a id="4031" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4033" href="Data.Product.html#1788" class="Function">∃[</a> <a id="4036" href="SMT.Script.html#4036" class="Bound">σ</a> <a id="4038" href="Data.Product.html#1788" class="Function">]</a> <a id="4040" class="Symbol">(</a><a id="4041" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4047" href="SMT.Script.html#4036" class="Bound">σ</a><a id="4048" class="Symbol">)</a> <a id="4050" class="Symbol">→</a> <a id="4052" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4058" class="Symbol">(</a><a id="4059" href="Data.Product.html#1788" class="Function">∃[</a> <a id="4062" href="SMT.Script.html#4062" class="Bound">σ</a> <a id="4064" href="Data.Product.html#1788" class="Function">]</a> <a id="4066" class="Symbol">(</a><a id="4067" href="SMT.Script.html#3105" class="Bound">Γ</a> <a id="4069" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="4071" href="SMT.Script.html#4062" class="Bound">σ</a> <a id="4073" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4075" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4081" href="SMT.Script.html#4062" class="Bound">σ</a><a id="4082" class="Symbol">))</a>
      <a id="4091" href="SMT.Script.html#3999" class="Function">checkVarAssign</a> <a id="4106" class="Symbol">((</a><a id="4108" href="SMT.Script.html#4108" class="Bound">σ₁</a> <a id="4111" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4113" href="SMT.Script.html#4113" class="Bound">x</a><a id="4114" class="Symbol">)</a> <a id="4116" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4118" class="Symbol">(</a><a id="4119" href="SMT.Script.html#4119" class="Bound">σ₂</a> <a id="4122" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4124" href="SMT.Script.html#4124" class="Bound">v</a><a id="4125" class="Symbol">))</a> <a id="4128" class="Keyword">with</a> <a id="4133" href="SMT.Script.html#4108" class="Bound">σ₁</a> <a id="4136" href="SMT.Theory.html#902" class="Function Operator">≟-Sort</a> <a id="4143" href="SMT.Script.html#4119" class="Bound">σ₂</a>
      <a id="4152" class="Symbol">...</a> <a id="4156" class="Symbol">|</a> <a id="4158" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="4162" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4167" class="Symbol">=</a> <a id="4169" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4174" class="Symbol">(</a><a id="4175" class="Bound">σ₂</a> <a id="4178" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4180" class="Bound">x</a> <a id="4182" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4184" class="Bound">v</a><a id="4185" class="Symbol">)</a>
      <a id="4193" class="Symbol">...</a> <a id="4197" class="Symbol">|</a> <a id="4199" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="4203" class="Symbol">_</a>    <a id="4208" class="Symbol">=</a> <a id="4210" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

    <a id="4223" class="Comment">-- Parse a series of variable assigments.</a>
    <a id="4269" href="SMT.Script.html#4269" class="Function">parseVarAssigns</a> <a id="4285" class="Symbol">:</a> <a id="4287" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4290" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="4297" class="Symbol">(</a><a id="4298" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="4304" class="Symbol">(</a><a id="4305" href="Data.Product.html#1788" class="Function">∃[</a> <a id="4308" href="SMT.Script.html#4308" class="Bound">σ</a> <a id="4310" href="Data.Product.html#1788" class="Function">]</a> <a id="4312" class="Symbol">(</a><a id="4313" href="SMT.Script.html#3105" class="Bound">Γ</a> <a id="4315" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="4317" href="SMT.Script.html#4308" class="Bound">σ</a> <a id="4319" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4321" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4327" href="SMT.Script.html#4308" class="Bound">σ</a><a id="4328" class="Symbol">)))</a> <a id="4332" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="4338" href="SMT.Script.html#4269" class="Function">parseVarAssigns</a> <a id="4354" class="Symbol">=</a> <a id="4356" href="Text.Parser.String.html#4997" class="Function">list⁺</a> <a id="4362" href="SMT.Script.html#3340" class="Function">parseVarAssign</a>

    <a id="4382" class="Comment">-- Insert a variable assignment into an unchecked model.</a>
    <a id="4443" href="SMT.Script.html#4443" class="Function">unsafeInsertModel</a> <a id="4461" class="Symbol">:</a>
      <a id="4469" class="Symbol">∀</a> <a id="4471" class="Symbol">{</a><a id="4472" href="SMT.Script.html#4472" class="Bound">Γ</a><a id="4473" class="Symbol">}</a> <a id="4475" class="Symbol">→</a> <a id="4477" href="Data.Product.html#1788" class="Function">∃[</a> <a id="4480" href="SMT.Script.html#4480" class="Bound">σ</a> <a id="4482" href="Data.Product.html#1788" class="Function">]</a> <a id="4484" class="Symbol">(</a><a id="4485" href="SMT.Script.html#4472" class="Bound">Γ</a> <a id="4487" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="4489" href="SMT.Script.html#4480" class="Bound">σ</a> <a id="4491" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4493" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4499" href="SMT.Script.html#4480" class="Bound">σ</a><a id="4500" class="Symbol">)</a> <a id="4502" class="Symbol">→</a> <a id="4504" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="4508" class="Symbol">(λ</a> <a id="4511" href="SMT.Script.html#4511" class="Bound">σ</a> <a id="4513" href="SMT.Script.html#4513" class="Bound Operator">_Γ</a> <a id="4516" class="Symbol">→</a> <a id="4518" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4523" class="Symbol">(</a><a id="4524" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4530" href="SMT.Script.html#4511" class="Bound">σ</a><a id="4531" class="Symbol">))</a> <a id="4534" href="SMT.Script.html#4472" class="Bound">Γ</a> <a id="4536" class="Symbol">→</a> <a id="4538" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="4542" class="Symbol">(λ</a> <a id="4545" href="SMT.Script.html#4545" class="Bound">σ</a> <a id="4547" href="SMT.Script.html#4547" class="Bound Operator">_Γ</a> <a id="4550" class="Symbol">→</a> <a id="4552" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4557" class="Symbol">(</a><a id="4558" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4564" href="SMT.Script.html#4545" class="Bound">σ</a><a id="4565" class="Symbol">))</a> <a id="4568" href="SMT.Script.html#4472" class="Bound">Γ</a>
    <a id="4574" href="SMT.Script.html#4443" class="Function">unsafeInsertModel</a> <a id="4592" class="Symbol">{</a><a id="4593" class="DottedPattern Symbol">.</a><a id="4594" class="DottedPattern">σ</a> <a id="4596" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4598" href="SMT.Script.html#4598" class="Bound">Γ</a><a id="4599" class="Symbol">}</a> <a id="4601" class="Symbol">(</a><a id="4602" href="SMT.Script.html#4602" class="Bound">σ</a> <a id="4604" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4606" class="Symbol">(</a><a id="4607" href="Data.Fin.Base.html#1088" class="InductiveConstructor">Fin.zero</a>  <a id="4617" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4619" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="4623" class="Symbol">)</a> <a id="4625" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4627" href="SMT.Script.html#4627" class="Bound">v</a><a id="4628" class="Symbol">)</a> <a id="4630" class="Symbol">(</a><a id="4631" href="SMT.Script.html#4631" class="Bound">vs</a> <a id="4634" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4636" href="SMT.Script.html#4636" class="Bound">env</a><a id="4639" class="Symbol">)</a> <a id="4641" class="Symbol">=</a> <a id="4643" class="Symbol">(</a><a id="4644" href="SMT.Script.html#4627" class="Bound">v</a> <a id="4646" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4648" href="SMT.Script.html#4631" class="Bound">vs</a><a id="4650" class="Symbol">)</a> <a id="4652" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4654" href="SMT.Script.html#4636" class="Bound">env</a>
    <a id="4662" href="SMT.Script.html#4443" class="Function">unsafeInsertModel</a> <a id="4680" class="Symbol">{</a><a id="4681" href="SMT.Script.html#4681" class="Bound">σ′</a> <a id="4684" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4686" href="SMT.Script.html#4686" class="Bound">Γ</a><a id="4687" class="Symbol">}</a> <a id="4689" class="Symbol">(</a><a id="4690" href="SMT.Script.html#4690" class="Bound">σ</a> <a id="4692" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4694" class="Symbol">(</a><a id="4695" href="Data.Fin.Base.html#1119" class="InductiveConstructor">Fin.suc</a> <a id="4703" href="SMT.Script.html#4703" class="Bound">i</a> <a id="4705" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4707" href="SMT.Script.html#4707" class="Bound">p</a><a id="4708" class="Symbol">)</a>    <a id="4713" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4715" href="SMT.Script.html#4715" class="Bound">v</a><a id="4716" class="Symbol">)</a> <a id="4718" class="Symbol">(</a><a id="4719" href="SMT.Script.html#4719" class="Bound">vs</a> <a id="4722" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4724" href="SMT.Script.html#4724" class="Bound">env</a><a id="4727" class="Symbol">)</a> <a id="4729" class="Symbol">=</a>
      <a id="4737" href="SMT.Script.html#4719" class="Bound">vs</a> <a id="4740" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4742" href="SMT.Script.html#4443" class="Function">unsafeInsertModel</a> <a id="4760" class="Symbol">(</a><a id="4761" href="SMT.Script.html#4690" class="Bound">σ</a> <a id="4763" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4765" class="Symbol">(</a><a id="4766" href="SMT.Script.html#4703" class="Bound">i</a> <a id="4768" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4770" href="SMT.Script.html#4707" class="Bound">p</a><a id="4771" class="Symbol">)</a> <a id="4773" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4775" href="SMT.Script.html#4715" class="Bound">v</a><a id="4776" class="Symbol">)</a> <a id="4778" href="SMT.Script.html#4724" class="Bound">env</a>

    <a id="4787" class="Comment">-- Build an unchecked model from a list of variable assignments.</a>
    <a id="4856" href="SMT.Script.html#4856" class="Function">unsafeBuildModel</a> <a id="4873" class="Symbol">:</a> <a id="4875" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4880" class="Symbol">(</a><a id="4881" href="Data.Product.html#1788" class="Function">∃[</a> <a id="4884" href="SMT.Script.html#4884" class="Bound">σ</a> <a id="4886" href="Data.Product.html#1788" class="Function">]</a> <a id="4888" class="Symbol">(</a><a id="4889" href="SMT.Script.html#3105" class="Bound">Γ</a> <a id="4891" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="4893" href="SMT.Script.html#4884" class="Bound">σ</a> <a id="4895" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4897" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4903" href="SMT.Script.html#4884" class="Bound">σ</a><a id="4904" class="Symbol">))</a> <a id="4907" class="Symbol">→</a> <a id="4909" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="4913" class="Symbol">(λ</a> <a id="4916" href="SMT.Script.html#4916" class="Bound">σ</a> <a id="4918" href="SMT.Script.html#4918" class="Bound Operator">_Γ</a> <a id="4921" class="Symbol">→</a> <a id="4923" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4928" class="Symbol">(</a><a id="4929" href="SMT.Theory.html#970" class="Function">Value</a> <a id="4935" href="SMT.Script.html#4916" class="Bound">σ</a><a id="4936" class="Symbol">))</a> <a id="4939" href="SMT.Script.html#3105" class="Bound">Γ</a>
    <a id="4945" href="SMT.Script.html#4856" class="Function">unsafeBuildModel</a> <a id="4962" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="4971" class="Symbol">=</a> <a id="4973" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="4984" class="Symbol">(λ</a> <a id="4987" href="SMT.Script.html#4987" class="Bound Operator">_σ</a> <a id="4990" href="SMT.Script.html#4990" class="Bound Operator">_Γ</a> <a id="4993" class="Symbol">→</a> <a id="4995" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4997" class="Symbol">)</a> <a id="4999" href="SMT.Script.html#3105" class="Bound">Γ</a>
    <a id="5005" href="SMT.Script.html#4856" class="Function">unsafeBuildModel</a> <a id="5022" class="Symbol">(</a><a id="5023" href="SMT.Script.html#5023" class="Bound">v</a> <a id="5025" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5027" href="SMT.Script.html#5027" class="Bound">vs</a><a id="5029" class="Symbol">)</a> <a id="5031" class="Symbol">=</a> <a id="5033" href="SMT.Script.html#4443" class="Function">unsafeInsertModel</a> <a id="5051" href="SMT.Script.html#5023" class="Bound">v</a> <a id="5053" class="Symbol">(</a><a id="5054" href="SMT.Script.html#4856" class="Function">unsafeBuildModel</a> <a id="5071" href="SMT.Script.html#5027" class="Bound">vs</a><a id="5073" class="Symbol">)</a>

    <a id="5080" class="Comment">-- Check if each variable has been assigned a value, is essentially traverse.</a>
    <a id="5162" href="SMT.Script.html#5162" class="Function">checkModel</a> <a id="5173" class="Symbol">:</a> <a id="5175" class="Symbol">∀</a> <a id="5177" class="Symbol">{</a><a id="5178" href="SMT.Script.html#5178" class="Bound">Γ</a><a id="5179" class="Symbol">}</a> <a id="5181" class="Symbol">→</a> <a id="5183" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="5187" class="Symbol">(λ</a> <a id="5190" href="SMT.Script.html#5190" class="Bound">σ</a> <a id="5192" href="SMT.Script.html#5192" class="Bound Operator">_Γ</a> <a id="5195" class="Symbol">→</a> <a id="5197" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5202" class="Symbol">(</a><a id="5203" href="SMT.Theory.html#970" class="Function">Value</a> <a id="5209" href="SMT.Script.html#5190" class="Bound">σ</a><a id="5210" class="Symbol">))</a> <a id="5213" href="SMT.Script.html#5178" class="Bound">Γ</a> <a id="5215" class="Symbol">→</a> <a id="5217" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5223" class="Symbol">(</a><a id="5224" href="SMT.Script.Base.html#3658" class="Datatype">Model</a> <a id="5230" href="SMT.Script.html#5178" class="Bound">Γ</a><a id="5231" class="Symbol">)</a>
    <a id="5237" href="SMT.Script.html#5162" class="Function">checkModel</a> <a id="5248" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="5251" class="Symbol">=</a> <a id="5253" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5258" href="SMT.Script.Base.html#3691" class="InductiveConstructor">[]</a>
    <a id="5265" href="SMT.Script.html#5162" class="Function">checkModel</a> <a id="5276" class="Symbol">(</a><a id="5277" href="SMT.Script.html#5277" class="Bound">vs</a> <a id="5280" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5282" href="SMT.Script.html#5282" class="Bound">env</a><a id="5285" class="Symbol">)</a> <a id="5287" class="Symbol">=</a> <a id="5289" href="Data.Maybe.Base.html#2766" class="Function">Maybe.zipWith</a> <a id="5303" href="SMT.Script.Base.html#3708" class="InductiveConstructor Operator">_∷_</a> <a id="5307" class="Symbol">(</a><a id="5308" href="SMT.Script.html#5354" class="Function">only</a> <a id="5313" href="SMT.Script.html#5277" class="Bound">vs</a><a id="5315" class="Symbol">)</a> <a id="5317" class="Symbol">(</a><a id="5318" href="SMT.Script.html#5162" class="Function">checkModel</a> <a id="5329" href="SMT.Script.html#5282" class="Bound">env</a><a id="5332" class="Symbol">)</a>
      <a id="5340" class="Keyword">where</a>
        <a id="5354" href="SMT.Script.html#5354" class="Function">only</a> <a id="5359" class="Symbol">:</a> <a id="5361" class="Symbol">{</a><a id="5362" href="SMT.Script.html#5362" class="Bound">A</a> <a id="5364" class="Symbol">:</a> <a id="5366" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="5369" class="Symbol">}</a> <a id="5371" class="Symbol">→</a> <a id="5373" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5378" href="SMT.Script.html#5362" class="Bound">A</a> <a id="5380" class="Symbol">→</a> <a id="5382" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5388" href="SMT.Script.html#5362" class="Bound">A</a>
        <a id="5398" href="SMT.Script.html#5354" class="Function">only</a> <a id="5403" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5406" class="Symbol">=</a> <a id="5408" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
        <a id="5424" href="SMT.Script.html#5354" class="Function">only</a> <a id="5429" class="Symbol">(</a><a id="5430" href="SMT.Script.html#5430" class="Bound">v</a> <a id="5432" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5434" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5436" class="Symbol">)</a> <a id="5438" class="Symbol">=</a> <a id="5440" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5445" href="SMT.Script.html#5430" class="Bound">v</a>
        <a id="5455" href="SMT.Script.html#5354" class="Function">only</a> <a id="5460" class="Symbol">(_</a> <a id="5463" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5465" class="Symbol">_</a> <a id="5467" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5469" class="Symbol">_)</a> <a id="5472" class="Symbol">=</a> <a id="5474" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

<a id="mkOutputParsers⁺"></a><a id="5483" href="SMT.Script.html#5483" class="Function">mkOutputParsers⁺</a> <a id="5500" class="Symbol">:</a> <a id="5502" href="SMT.Script.html#2445" class="Function">OutputParsers</a> <a id="5516" class="Symbol">(</a><a id="5517" href="SMT.Script.html#1615" class="Generalizable">ξ</a> <a id="5519" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5521" href="SMT.Script.html#1640" class="Generalizable">Ξ</a><a id="5522" class="Symbol">)</a> <a id="5524" class="Symbol">→</a> <a id="5526" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5529" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="5536" class="Symbol">(</a><a id="5537" href="SMT.Script.Base.html#4167" class="Datatype">Outputs</a> <a id="5545" class="Symbol">(</a><a id="5546" href="SMT.Script.html#1615" class="Generalizable">ξ</a> <a id="5548" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5550" href="SMT.Script.html#1640" class="Generalizable">Ξ</a><a id="5551" class="Symbol">))</a> <a id="5554" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="5556" href="SMT.Script.html#5483" class="Function">mkOutputParsers⁺</a> <a id="5573" class="Symbol">(</a><a id="5574" href="SMT.Script.html#5574" class="Bound">op</a> <a id="5577" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5579" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="5581" class="Symbol">)</a>          <a id="5592" class="Symbol">=</a> <a id="5594" class="Symbol">(</a><a id="5595" href="SMT.Script.Base.html#4227" class="InductiveConstructor Operator">_∷</a> <a id="5598" href="SMT.Script.Base.html#4208" class="InductiveConstructor">[]</a><a id="5600" class="Symbol">)</a> <a id="5602" href="Text.Parser.String.html#4562" class="Function Operator">&lt;$&gt;</a> <a id="5606" href="SMT.Script.html#5574" class="Bound">op</a>
<a id="5609" href="SMT.Script.html#5483" class="Function">mkOutputParsers⁺</a> <a id="5626" class="Symbol">(</a><a id="5627" href="SMT.Script.html#5627" class="Bound">op</a> <a id="5630" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5632" href="SMT.Script.html#5632" class="Bound">ops</a><a id="5635" class="Symbol">@(_</a> <a id="5639" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5641" class="Symbol">_))</a> <a id="5645" class="Symbol">=</a> <a id="5647" href="SMT.Script.Base.html#4227" class="InductiveConstructor Operator">_∷_</a> <a id="5651" href="Text.Parser.String.html#4562" class="Function Operator">&lt;$&gt;</a> <a id="5655" href="SMT.Script.html#5627" class="Bound">op</a> <a id="5658" href="Text.Parser.String.html#4746" class="Function Operator">&lt;*&gt;</a> <a id="5662" href="Text.Parser.String.html#4324" class="Function">box</a> <a id="5666" class="Symbol">(</a><a id="5667" href="SMT.Script.html#5483" class="Function">mkOutputParsers⁺</a> <a id="5684" href="SMT.Script.html#5632" class="Bound">ops</a><a id="5687" class="Symbol">)</a>

<a id="mkOutputParsers"></a><a id="5690" href="SMT.Script.html#5690" class="Function">mkOutputParsers</a> <a id="5706" class="Symbol">:</a> <a id="5708" href="SMT.Script.html#2445" class="Function">OutputParsers</a> <a id="5722" href="SMT.Script.html#1640" class="Generalizable">Ξ</a> <a id="5724" class="Symbol">→</a> <a id="5726" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5729" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="5736" class="Symbol">(</a><a id="5737" href="SMT.Script.Base.html#4167" class="Datatype">Outputs</a> <a id="5745" href="SMT.Script.html#1640" class="Generalizable">Ξ</a><a id="5746" class="Symbol">)</a> <a id="5748" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="5750" href="SMT.Script.html#5690" class="Function">mkOutputParsers</a> <a id="5766" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="5769" class="Symbol">=</a> <a id="5771" href="SMT.Script.Base.html#4208" class="InductiveConstructor">[]</a> <a id="5774" href="Text.Parser.String.html#4658" class="Function Operator">&lt;$</a> <a id="5777" href="Text.Parser.String.html#5294" class="Function">spaces</a>
<a id="5784" href="SMT.Script.html#5690" class="Function">mkOutputParsers</a> <a id="5800" href="SMT.Script.html#5800" class="Bound">ops</a><a id="5803" class="Symbol">@(_</a> <a id="5807" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5809" class="Symbol">_)</a> <a id="5812" class="Symbol">=</a> <a id="5814" href="SMT.Script.html#5483" class="Function">mkOutputParsers⁺</a> <a id="5831" href="SMT.Script.html#5800" class="Bound">ops</a>


<a id="5837" class="Comment">-- * Name state monad</a>

<a id="NameState"></a><a id="5860" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="5870" class="Symbol">:</a> <a id="5872" class="Symbol">(</a><a id="5873" href="SMT.Script.html#5873" class="Bound">Γ</a> <a id="5875" href="SMT.Script.html#5875" class="Bound">Γ′</a> <a id="5878" class="Symbol">:</a> <a id="5880" href="SMT.Script.Base.html#693" class="Function">Ctxt</a><a id="5884" class="Symbol">)</a> <a id="5886" class="Symbol">→</a> <a id="5888" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5892" class="Symbol">→</a> <a id="5894" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="5898" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="5908" href="SMT.Script.html#5908" class="Bound">Γ</a> <a id="5910" href="SMT.Script.html#5910" class="Bound">Γ′</a> <a id="5913" href="SMT.Script.html#5913" class="Bound">A</a> <a id="5915" class="Symbol">=</a> <a id="5917" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="5925" class="Symbol">(λ</a> <a id="5928" href="SMT.Script.html#5928" class="Bound">Γ</a> <a id="5930" class="Symbol">→</a> <a id="5932" href="SMT.Script.Names.html#1995" class="Record">Names</a> <a id="5938" href="SMT.Script.html#5928" class="Bound">Γ</a> <a id="5940" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5942" href="SMT.Script.html#1907" class="Function">VarParsers</a> <a id="5953" href="SMT.Script.html#5928" class="Bound">Γ</a><a id="5954" class="Symbol">)</a> <a id="5956" href="Function.Base.html#615" class="Function">id</a> <a id="5959" href="SMT.Script.html#5908" class="Bound">Γ</a> <a id="5961" href="SMT.Script.html#5910" class="Bound">Γ′</a> <a id="5964" href="SMT.Script.html#5913" class="Bound">A</a>

<a id="5967" class="Comment">-- When showing terms, we need to pass around a name state,</a>
<a id="6027" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
<a id="6092" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
<a id="6154" class="Keyword">private</a>
  <a id="monadStateNameState"></a><a id="6164" href="SMT.Script.html#6164" class="Function">monadStateNameState</a> <a id="6184" class="Symbol">=</a>
    <a id="6190" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="6217" class="Symbol">(λ</a> <a id="6220" href="SMT.Script.html#6220" class="Bound">Γ</a> <a id="6222" class="Symbol">→</a> <a id="6224" href="SMT.Script.Names.html#1995" class="Record">Names</a> <a id="6230" href="SMT.Script.html#6220" class="Bound">Γ</a> <a id="6232" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6234" href="SMT.Script.html#1907" class="Function">VarParsers</a> <a id="6245" href="SMT.Script.html#6220" class="Bound">Γ</a><a id="6246" class="Symbol">)</a> <a id="6248" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

<a id="6264" class="Keyword">open</a> <a id="6269" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="6284" href="SMT.Script.html#6164" class="Function">monadStateNameState</a>
  <a id="6306" class="Keyword">using</a> <a id="6312" class="Symbol">(</a><a id="6313" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="6319" class="Symbol">;</a> <a id="6321" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="6326" class="Symbol">;</a> <a id="6328" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="6332" class="Symbol">;</a> <a id="6334" href="Category.Monad.State.html#2831" class="Field">put</a><a id="6337" class="Symbol">;</a> <a id="6339" href="Category.Monad.State.html#2799" class="Field">get</a><a id="6342" class="Symbol">;</a> <a id="6344" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="6350" class="Symbol">)</a>

<a id="freshNameS"></a><a id="6353" href="SMT.Script.html#6353" class="Function">freshNameS</a> <a id="6364" class="Symbol">:</a> <a id="6366" class="Symbol">(</a><a id="6367" href="SMT.Script.html#6367" class="Bound">σ</a> <a id="6369" class="Symbol">:</a> <a id="6371" href="SMT.Theory.html#881" class="Function">Sort</a><a id="6375" class="Symbol">)</a> <a id="6377" class="Symbol">→</a> <a id="6379" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="6389" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6391" class="Symbol">(</a><a id="6392" href="SMT.Script.html#6367" class="Bound">σ</a> <a id="6394" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6396" href="SMT.Script.html#1524" class="Generalizable">Γ</a><a id="6397" class="Symbol">)</a> <a id="6399" href="SMT.Script.Names.html#1407" class="Function">Name</a>
<a id="6404" href="SMT.Script.html#6353" class="Function">freshNameS</a> <a id="6415" href="SMT.Script.html#6415" class="Bound">σ</a> <a id="6417" class="Symbol">=</a> <a id="6419" class="Keyword">do</a>
  <a id="6424" class="Symbol">(</a><a id="6425" href="SMT.Script.html#6425" class="Bound">ns</a> <a id="6428" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6430" href="SMT.Script.html#6430" class="Bound">vps</a><a id="6433" class="Symbol">)</a> <a id="6435" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6437" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="6443" class="Keyword">let</a> <a id="6447" class="Symbol">(</a><a id="6448" href="SMT.Script.html#6448" class="Bound">n</a> <a id="6450" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6452" href="SMT.Script.html#6452" class="Bound">ns</a><a id="6454" class="Symbol">)</a> <a id="6456" class="Symbol">=</a> <a id="6458" href="SMT.Script.Names.html#2205" class="Function">freshName</a> <a id="6468" href="SMT.Script.html#6415" class="Bound">σ</a> <a id="6470" href="SMT.Script.html#6425" class="Bound">ns</a>
  <a id="6475" class="Keyword">let</a> <a id="6479" href="SMT.Script.html#6479" class="Bound">vps</a> <a id="6483" class="Symbol">=</a> <a id="6485" class="Symbol">((</a><a id="6487" href="Data.Fin.Base.html#1088" class="InductiveConstructor">Fin.zero</a> <a id="6496" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6498" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="6502" class="Symbol">)</a> <a id="6504" href="Text.Parser.String.html#4658" class="Function Operator">&lt;$</a> <a id="6507" href="Text.Parser.String.html#5669" class="Function">exacts</a> <a id="6514" href="SMT.Script.html#6448" class="Bound">n</a><a id="6515" class="Symbol">)</a> <a id="6517" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6519" href="SMT.Script.html#6430" class="Bound">vps</a>
  <a id="6525" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="6529" class="Symbol">(</a><a id="6530" href="SMT.Script.html#6452" class="Bound">ns</a> <a id="6533" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6535" href="SMT.Script.html#6479" class="Bound">vps</a><a id="6538" class="Symbol">)</a>
  <a id="6542" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6549" href="SMT.Script.html#6448" class="Bound">n</a>

<a id="dropNameS"></a><a id="6552" href="SMT.Script.html#6552" class="Function">dropNameS</a> <a id="6562" class="Symbol">:</a> <a id="6564" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="6574" class="Symbol">(</a><a id="6575" href="SMT.Script.html#1505" class="Generalizable">σ</a> <a id="6577" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6579" href="SMT.Script.html#1524" class="Generalizable">Γ</a><a id="6580" class="Symbol">)</a> <a id="6582" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6584" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="6586" href="SMT.Script.html#6552" class="Function">dropNameS</a> <a id="6596" class="Symbol">=</a> <a id="6598" class="Keyword">do</a>
  <a id="6603" class="Symbol">(</a><a id="6604" href="SMT.Script.html#6604" class="Bound">ns</a> <a id="6607" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6609" class="Symbol">_</a> <a id="6611" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6613" href="SMT.Script.html#6613" class="Bound">vps</a><a id="6616" class="Symbol">)</a> <a id="6618" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6620" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="6626" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="6630" class="Symbol">(</a><a id="6631" href="SMT.Script.Names.html#2493" class="Function">dropName</a> <a id="6640" href="SMT.Script.html#6604" class="Bound">ns</a> <a id="6643" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6645" href="SMT.Script.html#6613" class="Bound">vps</a><a id="6648" class="Symbol">)</a>
  <a id="6652" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6659" class="Symbol">_</a>

<a id="lookupNameS"></a><a id="6662" href="SMT.Script.html#6662" class="Function">lookupNameS</a> <a id="6674" class="Symbol">:</a> <a id="6676" class="Symbol">(</a><a id="6677" href="SMT.Script.html#6677" class="Bound">i</a> <a id="6679" class="Symbol">:</a> <a id="6681" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6683" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="6685" href="SMT.Script.html#1505" class="Generalizable">σ</a><a id="6686" class="Symbol">)</a> <a id="6688" class="Symbol">→</a> <a id="6690" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="6700" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6702" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6704" href="SMT.Script.Names.html#1407" class="Function">Name</a>
<a id="6709" href="SMT.Script.html#6662" class="Function">lookupNameS</a> <a id="6721" class="Symbol">(</a><a id="6722" href="SMT.Script.html#6722" class="Bound">i</a> <a id="6724" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6726" href="SMT.Script.html#6726" class="Bound Operator">_p</a><a id="6728" class="Symbol">)</a> <a id="6730" class="Symbol">=</a> <a id="6732" class="Keyword">do</a>
  <a id="6737" class="Symbol">(</a><a id="6738" href="SMT.Script.html#6738" class="Bound">ns</a> <a id="6741" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6743" href="SMT.Script.html#6743" class="Bound Operator">_vps</a><a id="6747" class="Symbol">)</a> <a id="6749" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6751" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="6757" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6764" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="6766" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="6777" class="Symbol">(</a><a id="6778" href="SMT.Script.Names.html#2036" class="Field">Names.nameEnv</a> <a id="6792" href="SMT.Script.html#6738" class="Bound">ns</a><a id="6794" class="Symbol">)</a> <a id="6796" href="SMT.Script.html#6722" class="Bound">i</a>


<a id="6800" class="Comment">-- * Printing functions</a>

<a id="6825" class="Keyword">mutual</a>

  <a id="6835" class="Comment">-- |Show a term as an S-expression.</a>
  <a id="showTermS"></a><a id="6873" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="6883" class="Symbol">:</a> <a id="6885" href="SMT.Script.Base.html#1101" class="Datatype">Term</a> <a id="6890" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6892" href="SMT.Script.html#1505" class="Generalizable">σ</a> <a id="6894" class="Symbol">→</a> <a id="6896" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="6906" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6908" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="6910" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="6919" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="6929" class="Symbol">(</a><a id="6930" href="SMT.Script.Base.html#1146" class="InductiveConstructor">var</a> <a id="6934" href="SMT.Script.html#6934" class="Bound">i</a><a id="6935" class="Symbol">)</a> <a id="6937" class="Symbol">=</a> <a id="6939" class="Keyword">do</a>
    <a id="6946" href="SMT.Script.html#6946" class="Bound">n</a> <a id="6948" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6950" href="SMT.Script.html#6662" class="Function">lookupNameS</a> <a id="6962" href="SMT.Script.html#6934" class="Bound">i</a>
    <a id="6968" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6975" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="6977" href="SMT.Script.Names.html#1453" class="Function">showName</a> <a id="6986" href="SMT.Script.html#6946" class="Bound">n</a>
  <a id="6990" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="7000" class="Symbol">(</a><a id="7001" href="SMT.Script.Base.html#1188" class="InductiveConstructor">lit</a> <a id="7005" href="SMT.Script.html#7005" class="Bound">l</a><a id="7006" class="Symbol">)</a> <a id="7008" class="Symbol">=</a> <a id="7010" class="Keyword">do</a>
    <a id="7017" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7024" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7026" href="SMT.Theory.html#1260" class="Function">showLiteral</a> <a id="7038" href="SMT.Script.html#7005" class="Bound">l</a>
  <a id="7042" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="7052" class="Symbol">(</a><a id="7053" href="SMT.Script.Base.html#1234" class="InductiveConstructor">app</a> <a id="7057" href="SMT.Script.html#7057" class="Bound">x</a> <a id="7059" href="SMT.Script.html#7059" class="Bound">xs</a><a id="7061" class="Symbol">)</a> <a id="7063" class="Symbol">=</a> <a id="7065" class="Keyword">do</a>
    <a id="7072" class="Keyword">let</a> <a id="7076" href="SMT.Script.html#7076" class="Bound">x</a> <a id="7078" class="Symbol">=</a> <a id="7080" href="SMT.Theory.html#1313" class="Function">showIdentifier</a> <a id="7095" href="SMT.Script.html#7057" class="Bound">x</a>
    <a id="7101" href="SMT.Script.html#7101" class="Bound">xs</a> <a id="7104" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7106" href="SMT.Script.html#7486" class="Function">showArgsS</a> <a id="7116" href="SMT.Script.html#7059" class="Bound">xs</a>
    <a id="7123" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7130" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7132" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="7140" class="Symbol">(</a><a id="7141" href="SMT.Script.html#7076" class="Bound">x</a> <a id="7143" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7145" href="SMT.Script.html#7101" class="Bound">xs</a><a id="7147" class="Symbol">)</a>
  <a id="7151" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="7161" class="Symbol">(</a><a id="7162" href="SMT.Script.Base.html#1328" class="InductiveConstructor">forAll</a> <a id="7169" href="SMT.Script.html#7169" class="Bound">σ</a> <a id="7171" href="SMT.Script.html#7171" class="Bound">x</a><a id="7172" class="Symbol">)</a> <a id="7174" class="Symbol">=</a> <a id="7176" class="Keyword">do</a>
    <a id="7183" href="SMT.Script.html#7183" class="Bound">n</a> <a id="7185" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7187" href="SMT.Script.html#6353" class="Function">freshNameS</a> <a id="7198" href="SMT.Script.html#7169" class="Bound">σ</a>
    <a id="7204" href="SMT.Script.html#7204" class="Bound">x</a> <a id="7206" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7208" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="7218" href="SMT.Script.html#7171" class="Bound">x</a>
    <a id="7224" href="SMT.Script.html#6552" class="Function">dropNameS</a>
    <a id="7238" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7245" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7247" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="7255" class="Symbol">(</a><a id="7256" class="String">&quot;forall&quot;</a> <a id="7265" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7267" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="7275" class="Symbol">(</a><a id="7276" href="SMT.Script.Names.html#1453" class="Function">showName</a> <a id="7285" href="SMT.Script.html#7183" class="Bound">n</a> <a id="7287" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7289" href="SMT.Theory.html#1225" class="Function">showSort</a> <a id="7298" href="SMT.Script.html#7169" class="Bound">σ</a> <a id="7300" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7302" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7304" class="Symbol">)</a> <a id="7306" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7308" href="SMT.Script.html#7204" class="Bound">x</a> <a id="7310" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7312" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7314" class="Symbol">)</a>
  <a id="7318" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="7328" class="Symbol">(</a><a id="7329" href="SMT.Script.Base.html#1392" class="InductiveConstructor">exists</a> <a id="7336" href="SMT.Script.html#7336" class="Bound">σ</a> <a id="7338" href="SMT.Script.html#7338" class="Bound">x</a><a id="7339" class="Symbol">)</a> <a id="7341" class="Symbol">=</a> <a id="7343" class="Keyword">do</a>
    <a id="7350" href="SMT.Script.html#7350" class="Bound">n</a> <a id="7352" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7354" href="SMT.Script.html#6353" class="Function">freshNameS</a> <a id="7365" href="SMT.Script.html#7336" class="Bound">σ</a>
    <a id="7371" href="SMT.Script.html#7371" class="Bound">x</a> <a id="7373" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7375" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="7385" href="SMT.Script.html#7338" class="Bound">x</a>
    <a id="7391" href="SMT.Script.html#6552" class="Function">dropNameS</a>
    <a id="7405" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7412" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7414" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="7422" class="Symbol">(</a><a id="7423" class="String">&quot;exists&quot;</a> <a id="7432" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7434" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="7442" class="Symbol">(</a><a id="7443" href="SMT.Script.Names.html#1453" class="Function">showName</a> <a id="7452" href="SMT.Script.html#7350" class="Bound">n</a> <a id="7454" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7456" href="SMT.Theory.html#1225" class="Function">showSort</a> <a id="7465" href="SMT.Script.html#7336" class="Bound">σ</a> <a id="7467" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7469" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7471" class="Symbol">)</a> <a id="7473" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7475" href="SMT.Script.html#7371" class="Bound">x</a> <a id="7477" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7479" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7481" class="Symbol">)</a>

  <a id="showArgsS"></a><a id="7486" href="SMT.Script.html#7486" class="Function">showArgsS</a> <a id="7496" class="Symbol">:</a> <a id="7498" href="SMT.Script.Base.html#1455" class="Function">Args</a> <a id="7503" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="7505" href="SMT.Script.html#1543" class="Generalizable">Δ</a> <a id="7507" class="Symbol">→</a> <a id="7509" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="7519" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="7521" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="7523" class="Symbol">(</a><a id="7524" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7529" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="7535" class="Symbol">)</a>
  <a id="7539" href="SMT.Script.html#7486" class="Function">showArgsS</a> <a id="7549" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>       <a id="7558" class="Symbol">=</a> <a id="7560" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7567" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="7572" href="SMT.Script.html#7486" class="Function">showArgsS</a> <a id="7582" class="Symbol">(</a><a id="7583" href="SMT.Script.html#7583" class="Bound">x</a> <a id="7585" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7587" href="SMT.Script.html#7587" class="Bound">xs</a><a id="7589" class="Symbol">)</a> <a id="7591" class="Symbol">=</a> <a id="7593" class="Keyword">do</a> <a id="7596" href="SMT.Script.html#7596" class="Bound">x</a> <a id="7598" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7600" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="7610" href="SMT.Script.html#7583" class="Bound">x</a><a id="7611" class="Symbol">;</a> <a id="7613" href="SMT.Script.html#7613" class="Bound">xs</a> <a id="7616" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7618" href="SMT.Script.html#7486" class="Function">showArgsS</a> <a id="7628" href="SMT.Script.html#7587" class="Bound">xs</a><a id="7630" class="Symbol">;</a> <a id="7632" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7639" class="Symbol">(</a><a id="7640" href="SMT.Script.html#7596" class="Bound">x</a> <a id="7642" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7644" href="SMT.Script.html#7613" class="Bound">xs</a><a id="7646" class="Symbol">)</a>


<a id="7650" class="Comment">-- |Show a command as an S-expression, and build up an environment of output parsers.</a>
<a id="showCommandS"></a><a id="7736" href="SMT.Script.html#7736" class="Function">showCommandS</a> <a id="7749" class="Symbol">:</a> <a id="7751" href="SMT.Script.Base.html#5837" class="Datatype">Command</a> <a id="7759" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="7761" href="SMT.Script.html#1640" class="Generalizable">Ξ</a> <a id="7763" href="SMT.Script.html#1529" class="Generalizable">δΓ</a> <a id="7766" href="SMT.Script.html#1645" class="Generalizable">δΞ</a> <a id="7769" class="Symbol">→</a> <a id="7771" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="7781" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="7783" class="Symbol">(</a><a id="7784" href="SMT.Script.html#1529" class="Generalizable">δΓ</a> <a id="7787" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="7790" href="SMT.Script.html#1524" class="Generalizable">Γ</a><a id="7791" class="Symbol">)</a> <a id="7793" class="Symbol">(</a><a id="7794" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="7801" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7803" href="SMT.Script.html#2445" class="Function">OutputParsers</a> <a id="7817" href="SMT.Script.html#1645" class="Generalizable">δΞ</a><a id="7819" class="Symbol">)</a>
<a id="7821" href="SMT.Script.html#7736" class="Function">showCommandS</a> <a id="7834" class="Symbol">(</a><a id="7835" href="SMT.Script.Base.html#5919" class="InductiveConstructor">set-logic</a> <a id="7845" href="SMT.Script.html#7845" class="Bound">l</a><a id="7846" class="Symbol">)</a> <a id="7848" class="Symbol">=</a> <a id="7850" class="Keyword">do</a>
  <a id="7855" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7862" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7864" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="7872" class="Symbol">(</a><a id="7873" class="String">&quot;set-logic&quot;</a> <a id="7885" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7887" href="SMT.Logics.html#6232" class="Function">showLogic</a> <a id="7897" href="SMT.Script.html#7845" class="Bound">l</a> <a id="7899" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7901" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7903" class="Symbol">)</a> <a id="7905" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7907" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7910" href="SMT.Script.html#7736" class="Function">showCommandS</a> <a id="7923" class="Symbol">(</a><a id="7924" href="SMT.Script.Base.html#5969" class="InductiveConstructor">declare-const</a> <a id="7938" href="SMT.Script.html#7938" class="Bound">σ</a><a id="7939" class="Symbol">)</a> <a id="7941" class="Symbol">=</a> <a id="7943" class="Keyword">do</a>
  <a id="7948" href="SMT.Script.html#7948" class="Bound">n</a> <a id="7950" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7952" href="SMT.Script.html#6353" class="Function">freshNameS</a> <a id="7963" href="SMT.Script.html#7938" class="Bound">σ</a>
  <a id="7967" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7974" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7976" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="7984" class="Symbol">(</a><a id="7985" class="String">&quot;declare-const&quot;</a> <a id="8001" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8003" href="SMT.Script.Names.html#1453" class="Function">showName</a> <a id="8012" href="SMT.Script.html#7948" class="Bound">n</a> <a id="8014" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8016" href="SMT.Theory.html#1225" class="Function">showSort</a> <a id="8025" href="SMT.Script.html#7938" class="Bound">σ</a> <a id="8027" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8029" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8031" class="Symbol">)</a> <a id="8033" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8035" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="8038" href="SMT.Script.html#7736" class="Function">showCommandS</a> <a id="8051" class="Symbol">(</a><a id="8052" href="SMT.Script.Base.html#6024" class="InductiveConstructor">assert</a> <a id="8059" href="SMT.Script.html#8059" class="Bound">x</a><a id="8060" class="Symbol">)</a> <a id="8062" class="Symbol">=</a> <a id="8064" class="Keyword">do</a>
  <a id="8069" href="SMT.Script.html#8069" class="Bound">x</a> <a id="8071" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8073" href="SMT.Script.html#6873" class="Function">showTermS</a> <a id="8083" href="SMT.Script.html#8059" class="Bound">x</a>
  <a id="8087" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8094" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="8096" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="8104" class="Symbol">(</a><a id="8105" class="String">&quot;assert&quot;</a> <a id="8114" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8116" href="SMT.Script.html#8069" class="Bound">x</a> <a id="8118" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8120" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8122" class="Symbol">)</a> <a id="8124" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8126" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="8129" href="SMT.Script.html#7736" class="Function">showCommandS</a> <a id="8142" href="SMT.Script.Base.html#6074" class="InductiveConstructor">check-sat</a> <a id="8152" class="Symbol">=</a> <a id="8154" class="Keyword">do</a>
  <a id="8159" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8166" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="8168" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="8176" class="Symbol">(</a><a id="8177" class="String">&quot;check-sat&quot;</a> <a id="8189" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8191" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8193" class="Symbol">)</a> <a id="8195" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8197" href="SMT.Script.html#2564" class="Function">parseSat</a> <a id="8206" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="8208" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="8211" href="SMT.Script.html#7736" class="Function">showCommandS</a> <a id="8224" href="SMT.Script.Base.html#6118" class="InductiveConstructor">get-model</a> <a id="8234" class="Symbol">=</a> <a id="8236" class="Keyword">do</a>
  <a id="8241" class="Symbol">(</a><a id="8242" href="SMT.Script.html#8242" class="Bound Operator">_ns</a> <a id="8246" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8248" href="SMT.Script.html#8248" class="Bound">vps</a><a id="8251" class="Symbol">)</a> <a id="8253" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8255" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="8261" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8268" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="8270" href="SMT.Script.html#1773" class="Function">mkSTerm</a> <a id="8278" class="Symbol">(</a><a id="8279" class="String">&quot;get-model&quot;</a> <a id="8291" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8293" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8295" class="Symbol">)</a> <a id="8297" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8299" href="SMT.Script.html#3043" class="Function">parseModel</a> <a id="8310" href="SMT.Script.html#8248" class="Bound">vps</a> <a id="8314" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="8316" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>

<a id="8320" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
<a id="showScriptS"></a><a id="8405" href="SMT.Script.html#8405" class="Function">showScriptS</a> <a id="8417" class="Symbol">:</a> <a id="8419" href="SMT.Script.Base.html#6267" class="Datatype">Script</a> <a id="8426" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="8428" href="SMT.Script.html#1526" class="Generalizable">Γ′</a> <a id="8431" href="SMT.Script.html#1640" class="Generalizable">Ξ</a> <a id="8433" class="Symbol">→</a> <a id="8435" href="SMT.Script.html#5860" class="Function">NameState</a> <a id="8445" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="8447" href="SMT.Script.html#1526" class="Generalizable">Γ′</a> <a id="8450" class="Symbol">(</a><a id="8451" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8456" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="8463" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8465" href="SMT.Script.html#2445" class="Function">OutputParsers</a> <a id="8479" href="SMT.Script.html#1640" class="Generalizable">Ξ</a><a id="8480" class="Symbol">)</a>
<a id="8482" href="SMT.Script.html#8405" class="Function">showScriptS</a> <a id="8494" href="SMT.Script.Base.html#6330" class="InductiveConstructor">[]</a> <a id="8497" class="Symbol">=</a> <a id="8499" class="Keyword">do</a>
  <a id="8504" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8511" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="8513" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8516" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8518" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="8521" href="SMT.Script.html#8405" class="Function">showScriptS</a> <a id="8533" class="Symbol">(</a><a id="8534" href="SMT.Script.html#8534" class="Bound">cmd</a> <a id="8538" href="SMT.Script.Base.html#6352" class="InductiveConstructor Operator">∷</a> <a id="8540" href="SMT.Script.html#8540" class="Bound">scr</a><a id="8543" class="Symbol">)</a> <a id="8545" class="Symbol">=</a> <a id="8547" class="Keyword">do</a>
  <a id="8552" class="Symbol">(</a><a id="8553" href="SMT.Script.html#8553" class="Bound">cmd</a> <a id="8557" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8559" href="SMT.Script.html#8559" class="Bound">ops₁</a><a id="8563" class="Symbol">)</a> <a id="8565" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8567" href="SMT.Script.html#7736" class="Function">showCommandS</a> <a id="8580" href="SMT.Script.html#8534" class="Bound">cmd</a>
  <a id="8586" class="Symbol">(</a><a id="8587" href="SMT.Script.html#8587" class="Bound">scr</a> <a id="8591" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8593" href="SMT.Script.html#8593" class="Bound">ops₂</a><a id="8597" class="Symbol">)</a> <a id="8599" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8601" href="SMT.Script.html#8405" class="Function">showScriptS</a> <a id="8613" href="SMT.Script.html#8540" class="Bound">scr</a>
  <a id="8619" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8626" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="8628" href="SMT.Script.html#8553" class="Bound">cmd</a> <a id="8632" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8634" href="SMT.Script.html#8587" class="Bound">scr</a> <a id="8638" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8640" href="Data.Environment.html#1225" class="Function">Env.append</a> <a id="8651" href="Function.Base.html#615" class="Function">id</a> <a id="8654" href="SMT.Script.html#8559" class="Bound">ops₁</a> <a id="8659" href="SMT.Script.html#8593" class="Bound">ops₂</a>

<a id="8665" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
<a id="showScript"></a><a id="8748" href="SMT.Script.html#8748" class="Function">showScript</a> <a id="8759" class="Symbol">:</a> <a id="8761" href="SMT.Script.Base.html#6267" class="Datatype">Script</a> <a id="8768" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8771" href="SMT.Script.html#1524" class="Generalizable">Γ</a> <a id="8773" href="SMT.Script.html#1640" class="Generalizable">Ξ</a> <a id="8775" class="Symbol">→</a> <a id="8777" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="8784" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8786" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="8789" href="Text.Parser.String.html#2571" class="Function">Parser</a> <a id="8796" class="Symbol">(</a><a id="8797" href="SMT.Script.Base.html#4167" class="Datatype">Outputs</a> <a id="8805" href="SMT.Script.html#1640" class="Generalizable">Ξ</a><a id="8806" class="Symbol">)</a> <a id="8808" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="8810" href="SMT.Script.html#8748" class="Function">showScript</a> <a id="8821" href="SMT.Script.html#8821" class="Bound">scr</a> <a id="8825" class="Symbol">=</a> <a id="8827" href="Data.Product.html#2435" class="Function">Prod.map</a> <a id="8836" href="Data.String.Base.html#2550" class="Function">String.unlines</a> <a id="8851" href="SMT.Script.html#5690" class="Function">mkOutputParsers</a> <a id="8867" class="Symbol">(</a><a id="8868" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8874" class="Symbol">(</a><a id="8875" href="SMT.Script.html#8405" class="Function">showScriptS</a> <a id="8887" href="SMT.Script.html#8821" class="Bound">scr</a> <a id="8891" class="Symbol">(</a><a id="8892" href="SMT.Script.Names.html#2712" class="Function">x′es</a> <a id="8897" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8899" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="8901" class="Symbol">)))</a>

<a id="8906" class="Comment">-- -}</a>
<a id="8912" class="Comment">-- -}</a>
<a id="8918" class="Comment">-- -}</a>
</pre></body></html>