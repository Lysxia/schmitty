<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="SMT.Theory.html" class="Module">SMT.Theory</a>

<a id="25" class="Keyword">module</a> <a id="32" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="43" class="Symbol">(</a><a id="44" href="SMT.Script.html#44" class="Bound">theory</a> <a id="51" class="Symbol">:</a> <a id="53" href="SMT.Theory.html#1654" class="Record">Theory</a><a id="59" class="Symbol">)</a> <a id="61" class="Keyword">where</a>

<a id="68" class="Keyword">open</a> <a id="73" class="Keyword">import</a> <a id="80" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="89" class="Symbol">as</a> <a id="92" class="Module">Fin</a> <a id="96" class="Keyword">using</a> <a id="102" class="Symbol">(</a><a id="103" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a><a id="106" class="Symbol">;</a> <a id="108" href="Data.Fin.Base.html#1119" class="InductiveConstructor">suc</a><a id="111" class="Symbol">;</a> <a id="113" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a><a id="117" class="Symbol">)</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.List.html" class="Module">Data.List</a> <a id="141" class="Symbol">as</a> <a id="144" class="Module">List</a> <a id="149" class="Keyword">using</a> <a id="155" class="Symbol">(</a><a id="156" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="160" class="Symbol">;</a> <a id="162" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="165" class="Symbol">;</a> <a id="167" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="169" class="Symbol">;</a> <a id="171" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="175" class="Symbol">)</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="208" class="Symbol">as</a> <a id="211" class="Module">List⁺</a> <a id="217" class="Keyword">using</a> <a id="223" class="Symbol">(</a><a id="224" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a><a id="229" class="Symbol">;</a> <a id="231" href="Data.List.NonEmpty.html#1364" class="InductiveConstructor Operator">_∷_</a><a id="234" class="Symbol">)</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="Data.Product.html" class="Module">Data.Product</a> <a id="261" class="Symbol">as</a> <a id="264" class="Module">Prod</a> <a id="269" class="Keyword">using</a> <a id="275" class="Symbol">(</a><a id="276" href="Data.Product.html#1369" class="Function">∃</a><a id="277" class="Symbol">;</a> <a id="279" href="Data.Product.html#1788" class="Function">∃-syntax</a><a id="287" class="Symbol">;</a> <a id="289" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="292" class="Symbol">)</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="323" class="Keyword">using</a> <a id="329" class="Symbol">(</a><a id="330" href="Relation.Nullary.html#1508" class="Record">Dec</a><a id="333" class="Symbol">;</a> <a id="335" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a><a id="338" class="Symbol">;</a> <a id="340" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a><a id="342" class="Symbol">)</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="383" class="Keyword">using</a> <a id="389" class="Symbol">(</a><a id="390" href="Relation.Nullary.Decidable.Core.html#1365" class="Function">True</a><a id="394" class="Symbol">)</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="446" class="Keyword">using</a> <a id="452" class="Symbol">(</a><a id="453" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="456" class="Symbol">;</a> <a id="458" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="462" class="Symbol">)</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="SMT.Logics.html" class="Module">SMT.Logics</a>
<a id="487" class="Keyword">open</a> <a id="492" class="Keyword">import</a> <a id="499" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="516" class="Symbol">as</a> <a id="519" class="Module">Env</a> <a id="523" class="Keyword">using</a> <a id="529" class="Symbol">(</a><a id="530" href="Data.Environment.html#360" class="Datatype">Env</a><a id="533" class="Symbol">;</a> <a id="535" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="538" class="Symbol">;</a> <a id="540" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="542" class="Symbol">)</a>

<a id="545" class="Keyword">open</a> <a id="550" class="Keyword">import</a> <a id="557" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="605" class="Symbol">as</a> <a id="608" class="Module">StateCat</a> <a id="617" class="Keyword">using</a> <a id="623" class="Symbol">(</a><a id="624" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="638" class="Symbol">;</a> <a id="640" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="647" class="Symbol">)</a>
<a id="649" class="Keyword">open</a> <a id="654" class="Keyword">import</a> <a id="661" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="683" class="Symbol">as</a> <a id="686" class="Module">Stream</a> <a id="693" class="Keyword">using</a> <a id="699" class="Symbol">(</a><a id="700" href="Codata.Musical.Stream.html#674" class="Datatype">Stream</a><a id="706" class="Symbol">)</a>
<a id="708" class="Keyword">open</a> <a id="713" class="Keyword">import</a> <a id="720" href="Data.Char.html" class="Module">Data.Char</a> <a id="730" class="Symbol">as</a> <a id="733" class="Module">Char</a> <a id="738" class="Keyword">using</a> <a id="744" class="Symbol">(</a><a id="745" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="749" class="Symbol">)</a>
<a id="751" class="Keyword">open</a> <a id="756" class="Keyword">import</a> <a id="763" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="774" class="Symbol">as</a> <a id="777" class="Module">Maybe</a> <a id="783" class="Keyword">using</a> <a id="789" class="Symbol">(</a><a id="790" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="795" class="Symbol">;</a> <a id="797" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="801" class="Symbol">;</a> <a id="803" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="810" class="Symbol">)</a>
<a id="812" class="Keyword">open</a> <a id="817" class="Keyword">import</a> <a id="824" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="833" class="Symbol">as</a> <a id="836" class="Module">Nat</a> <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="848" class="Symbol">)</a>
<a id="850" class="Keyword">open</a> <a id="855" class="Keyword">import</a> <a id="862" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="876" class="Keyword">renaming</a> <a id="885" class="Symbol">(</a><a id="886" href="Data.Nat.Show.html#1076" class="Function">show</a> <a id="891" class="Symbol">to</a> <a id="Show.show"></a><a id="894" href="SMT.Script.html#894" class="Function">showℕ</a><a id="899" class="Symbol">)</a>
<a id="901" class="Keyword">open</a> <a id="906" class="Keyword">import</a> <a id="913" href="Data.Product.html" class="Module">Data.Product</a> <a id="926" class="Symbol">as</a> <a id="929" class="Module">Product</a> <a id="937" class="Keyword">using</a> <a id="943" class="Symbol">(</a><a id="944" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="947" class="Symbol">;</a> <a id="949" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="952" class="Symbol">;</a> <a id="954" href="Data.Product.html#2196" class="Function Operator">-,_</a><a id="957" class="Symbol">;</a> <a id="959" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="964" class="Symbol">;</a> <a id="966" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="971" class="Symbol">)</a>
<a id="973" class="Keyword">open</a> <a id="978" class="Keyword">import</a> <a id="985" href="Data.String.html" class="Module">Data.String</a> <a id="997" class="Symbol">as</a> <a id="1000" class="Module">String</a> <a id="1007" class="Keyword">using</a> <a id="1013" class="Symbol">(</a><a id="1014" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1020" class="Symbol">)</a>
<a id="1022" class="Keyword">open</a> <a id="1027" class="Keyword">import</a> <a id="1034" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1044" class="Symbol">as</a> <a id="1047" class="Module">Unit</a> <a id="1052" class="Keyword">using</a> <a id="1058" class="Symbol">(</a><a id="1059" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1060" class="Symbol">)</a>
<a id="1062" class="Keyword">open</a> <a id="1067" class="Keyword">import</a> <a id="1074" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1083" class="Symbol">as</a> <a id="1086" class="Module">Vec</a> <a id="1090" class="Keyword">using</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="1100" class="Symbol">)</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Function.html" class="Module">Function</a> <a id="1123" class="Keyword">using</a> <a id="1129" class="Symbol">(</a><a id="1130" href="Function.Base.html#636" class="Function">const</a><a id="1135" class="Symbol">;</a> <a id="1137" href="Function.Base.html#615" class="Function">id</a><a id="1139" class="Symbol">;</a> <a id="1141" href="Function.Base.html#992" class="Function Operator">_∘_</a><a id="1144" class="Symbol">;</a> <a id="1146" href="Function.Base.html#1577" class="Function Operator">_$_</a><a id="1149" class="Symbol">)</a>
<a id="1151" class="Keyword">import</a> <a id="1158" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1188" class="Symbol">as</a> <a id="1191" class="Module">Identity</a>
<a id="1200" class="Keyword">open</a> <a id="1205" class="Keyword">import</a> <a id="1212" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="1231" class="Symbol">as</a> <a id="1234" class="Module">P</a> <a id="1236" class="Keyword">hiding</a> <a id="1243" class="Symbol">(</a><a id="1244" href="Text.Parser.String.html#3776" class="Function Operator">_&gt;&gt;=_</a><a id="1249" class="Symbol">)</a>
<a id="1251" class="Keyword">import</a> <a id="1258" href="Reflection.html" class="Module">Reflection</a> <a id="1269" class="Symbol">as</a> <a id="1272" class="Module">Rfl</a>

<a id="1277" class="Keyword">open</a> <a id="1282" href="SMT.Theory.html#1654" class="Module">Theory</a> <a id="1289" href="SMT.Script.html#44" class="Bound">theory</a>

<a id="1297" class="Keyword">open</a> <a id="1302" class="Keyword">import</a> <a id="1309" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1325" href="SMT.Theory.html#1686" class="Field">baseTheory</a> <a id="1336" class="Keyword">public</a>
<a id="1343" class="Keyword">open</a> <a id="1348" class="Keyword">import</a> <a id="1355" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1372" href="SMT.Theory.html#1686" class="Field">baseTheory</a>

<a id="1384" class="Keyword">private</a>
  <a id="1394" class="Keyword">variable</a>
    <a id="1407" href="SMT.Script.html#1407" class="Generalizable">σ</a> <a id="1409" href="SMT.Script.html#1409" class="Generalizable">σ′</a>    <a id="1415" class="Symbol">:</a> <a id="1417" href="SMT.Theory.html#908" class="Function">Sort</a>
    <a id="1426" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="1428" href="SMT.Script.html#1428" class="Generalizable">Γ′</a> <a id="1431" href="SMT.Script.html#1431" class="Generalizable">δΓ</a> <a id="1434" class="Symbol">:</a> <a id="1436" href="SMT.Script.Base.html#905" class="Function">Ctxt</a>
    <a id="1445" href="SMT.Script.html#1445" class="Generalizable">Δ</a> <a id="1447" href="SMT.Script.html#1447" class="Generalizable">Δ′</a>    <a id="1453" class="Symbol">:</a> <a id="1455" href="SMT.Script.Base.html#905" class="Function">Ctxt</a>
    <a id="1464" href="SMT.Script.html#1464" class="Generalizable">Σ</a>       <a id="1472" class="Symbol">:</a> <a id="1474" href="SMT.Theory.html#352" class="Record">Signature</a> <a id="1484" href="SMT.Script.html#1407" class="Generalizable">σ</a>
    <a id="1490" href="SMT.Script.html#1490" class="Generalizable">Σ′</a>      <a id="1498" class="Symbol">:</a> <a id="1500" href="SMT.Theory.html#352" class="Record">Signature</a> <a id="1510" href="SMT.Script.html#1409" class="Generalizable">σ′</a>
    <a id="1517" href="SMT.Script.html#1517" class="Generalizable">ξ</a> <a id="1519" href="SMT.Script.html#1519" class="Generalizable">ξ′</a>    <a id="1525" class="Symbol">:</a> <a id="1527" href="SMT.Script.Base.html#3210" class="Datatype">OutputType</a>
    <a id="1542" href="SMT.Script.html#1542" class="Generalizable">Ξ</a> <a id="1544" href="SMT.Script.html#1544" class="Generalizable">Ξ′</a> <a id="1547" href="SMT.Script.html#1547" class="Generalizable">δΞ</a> <a id="1550" class="Symbol">:</a> <a id="1552" href="SMT.Script.Base.html#3304" class="Function">OutputCtxt</a>


<a id="1565" class="Keyword">private</a>
  <a id="1575" class="Comment">-- |Create an S-expression from a list of strings.</a>
  <a id="1628" class="Comment">--</a>
  <a id="1633" class="Comment">-- @</a>
  <a id="1640" class="Comment">--   mkSTerm (&quot;*&quot; ∷ &quot;4&quot; ∷ &quot;5&quot;) ≡ &quot;(* 4 5)&quot;</a>
  <a id="1685" class="Comment">-- @</a>
  <a id="1692" class="Comment">--</a>
  <a id="mkSTerm"></a><a id="1697" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="1705" class="Symbol">:</a> <a id="1707" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1712" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="1719" class="Symbol">→</a> <a id="1721" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="1730" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="Data.String.Base.html#2863" class="Function">String.parens</a> <a id="1754" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1756" href="Data.String.Base.html#2805" class="Function">String.unwords</a>


<a id="1773" class="Comment">-- * Variable parsers</a>

<a id="1796" class="Comment">-- |Environment of variable parsers.</a>
<a id="VarParsers"></a><a id="1833" href="SMT.Script.html#1833" class="Function">VarParsers</a> <a id="1844" class="Symbol">:</a> <a id="1846" href="SMT.Script.Base.html#905" class="Function">Ctxt</a> <a id="1851" class="Symbol">→</a> <a id="1853" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1857" href="SMT.Script.html#1833" class="Function">VarParsers</a> <a id="1868" class="Symbol">=</a> <a id="1870" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="1874" class="Symbol">(λ</a> <a id="1877" href="SMT.Script.html#1877" class="Bound">σ</a> <a id="1879" href="SMT.Script.html#1879" class="Bound">Γ</a> <a id="1881" class="Symbol">→</a> <a id="1883" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1886" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="1893" class="Symbol">((</a><a id="1895" href="SMT.Script.html#1877" class="Bound">σ</a> <a id="1897" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1899" href="SMT.Script.html#1879" class="Bound">Γ</a><a id="1900" class="Symbol">)</a> <a id="1902" href="SMT.Script.Base.html#1090" class="Function Operator">∋</a> <a id="1904" href="SMT.Script.html#1877" class="Bound">σ</a><a id="1905" class="Symbol">)</a> <a id="1907" href="Relation.Unary.html#3359" class="Function">]</a><a id="1908" class="Symbol">)</a>

<a id="1911" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
<a id="mkVarParser"></a><a id="1991" href="SMT.Script.html#1991" class="Function">mkVarParser</a> <a id="2003" class="Symbol">:</a> <a id="2005" href="SMT.Script.html#1833" class="Function">VarParsers</a> <a id="2016" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="2018" class="Symbol">→</a> <a id="2020" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2023" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2030" class="Symbol">(</a><a id="2031" href="Data.Product.html#1788" class="Function">∃[</a> <a id="2034" href="SMT.Script.html#2034" class="Bound">σ</a> <a id="2036" href="Data.Product.html#1788" class="Function">]</a> <a id="2038" class="Symbol">(</a><a id="2039" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="2041" href="SMT.Script.Base.html#1090" class="Function Operator">∋</a> <a id="2043" href="SMT.Script.html#2034" class="Bound">σ</a><a id="2044" class="Symbol">))</a> <a id="2047" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2049" href="SMT.Script.html#1991" class="Function">mkVarParser</a> <a id="2061" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="2075" class="Symbol">=</a> <a id="2077" href="Text.Parser.String.html#4217" class="Function">fail</a>
<a id="2082" href="SMT.Script.html#1991" class="Function">mkVarParser</a> <a id="2094" class="Symbol">(</a><a id="2095" href="SMT.Script.html#2095" class="Bound">p</a> <a id="2097" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="2099" href="SMT.Script.html#2099" class="Bound">env</a><a id="2102" class="Symbol">)</a> <a id="2104" class="Symbol">{</a><a id="2105" href="SMT.Script.html#2105" class="Bound">x</a><a id="2106" class="Symbol">}</a> <a id="2108" class="Symbol">=</a> <a id="2110" class="Symbol">(</a><a id="2111" href="Data.Product.html#2196" class="Function Operator">-,_</a> <a id="2115" href="Text.Parser.String.html#4388" class="Function Operator">&lt;$&gt;</a> <a id="2119" href="SMT.Script.html#2095" class="Bound">p</a> <a id="2121" class="Symbol">{</a><a id="2122" href="SMT.Script.html#2105" class="Bound">x</a><a id="2123" class="Symbol">})</a> <a id="2126" href="Text.Parser.String.html#4290" class="Function Operator">&lt;|&gt;</a> <a id="2130" class="Symbol">(</a><a id="2131" href="Data.Product.html#2435" class="Function">Prod.map</a> <a id="2140" href="Function.Base.html#615" class="Function">id</a> <a id="2143" href="SMT.Script.Base.html#2205" class="Function">extendVar</a> <a id="2153" href="Text.Parser.String.html#4388" class="Function Operator">&lt;$&gt;</a> <a id="2157" href="SMT.Script.html#1991" class="Function">mkVarParser</a> <a id="2169" href="SMT.Script.html#2099" class="Bound">env</a> <a id="2173" class="Symbol">{</a><a id="2174" href="SMT.Script.html#2105" class="Bound">x</a><a id="2175" class="Symbol">})</a>


<a id="2180" class="Comment">-- * Output parsers</a>

<a id="2201" class="Comment">-- |Mapping from output types to parser types.</a>
<a id="OutputParser"></a><a id="2248" href="SMT.Script.html#2248" class="Function">OutputParser</a> <a id="2261" class="Symbol">:</a> <a id="2263" href="SMT.Script.Base.html#3210" class="Datatype">OutputType</a> <a id="2274" class="Symbol">→</a> <a id="2276" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2280" href="SMT.Script.html#2248" class="Function">OutputParser</a> <a id="2293" href="SMT.Script.html#2293" class="Bound">ξ</a> <a id="2295" class="Symbol">=</a> <a id="2297" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2300" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2307" class="Symbol">(</a><a id="2308" href="SMT.Script.Base.html#4273" class="Function">Output</a> <a id="2315" href="SMT.Script.html#2293" class="Bound">ξ</a><a id="2316" class="Symbol">)</a> <a id="2318" href="Relation.Unary.html#3359" class="Function">]</a>

<a id="2321" class="Comment">-- |Mapping from output contexts to parser types.</a>
<a id="OutputParsers"></a><a id="2371" href="SMT.Script.html#2371" class="Function">OutputParsers</a> <a id="2385" class="Symbol">:</a> <a id="2387" href="SMT.Script.Base.html#3304" class="Function">OutputCtxt</a> <a id="2398" class="Symbol">→</a> <a id="2400" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2404" href="SMT.Script.html#2371" class="Function">OutputParsers</a> <a id="2418" href="SMT.Script.html#2418" class="Bound">Ξ</a> <a id="2420" class="Symbol">=</a> <a id="2422" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2426" class="Symbol">(λ</a> <a id="2429" href="SMT.Script.html#2429" class="Bound">ξ</a> <a id="2431" href="SMT.Script.html#2431" class="Bound Operator">_Ξ</a> <a id="2434" class="Symbol">→</a> <a id="2436" href="SMT.Script.html#2248" class="Function">OutputParser</a> <a id="2449" href="SMT.Script.html#2429" class="Bound">ξ</a><a id="2450" class="Symbol">)</a> <a id="2452" href="SMT.Script.html#2418" class="Bound">Ξ</a>

<a id="2455" class="Comment">-- |Parse a satisfiability result.</a>
<a id="pSat"></a><a id="2490" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="2495" class="Symbol">:</a> <a id="2497" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2500" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2507" href="SMT.Script.Base.html#3455" class="Datatype">Sat</a> <a id="2511" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2513" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="2518" class="Symbol">=</a> <a id="2520" href="SMT.Script.Base.html#3473" class="InductiveConstructor">sat</a>     <a id="2528" href="Text.Parser.String.html#4484" class="Function Operator">&lt;$</a> <a id="2531" href="Text.Parser.String.html#5512" class="Function">lexeme</a> <a id="2538" class="String">&quot;sat&quot;</a>
   <a id="2547" href="Text.Parser.String.html#4290" class="Function Operator">&lt;|&gt;</a> <a id="2551" href="SMT.Script.Base.html#3489" class="InductiveConstructor">unsat</a>   <a id="2559" href="Text.Parser.String.html#4484" class="Function Operator">&lt;$</a> <a id="2562" href="Text.Parser.String.html#5512" class="Function">lexeme</a> <a id="2569" class="String">&quot;unsat&quot;</a>
   <a id="2580" href="Text.Parser.String.html#4290" class="Function Operator">&lt;|&gt;</a> <a id="2584" href="SMT.Script.Base.html#3505" class="InductiveConstructor">unknown</a> <a id="2592" href="Text.Parser.String.html#4484" class="Function Operator">&lt;$</a> <a id="2595" href="Text.Parser.String.html#5512" class="Function">lexeme</a> <a id="2602" class="String">&quot;unknown&quot;</a>

<a id="2613" href="SMT.Script.html#2613" class="Function">_</a> <a id="2615" class="Symbol">:</a> <a id="2617" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="2622" href="Text.Parser.String.html#7175" class="Function Operator">parses</a> <a id="2629" class="String">&quot;sat&quot;</a>
<a id="2635" class="Symbol">_</a> <a id="2637" class="Symbol">=</a> <a id="2639" href="Text.Parser.String.html#6783" class="InductiveConstructor Operator">!</a> <a id="2641" href="SMT.Script.Base.html#3473" class="InductiveConstructor">sat</a>

<a id="2646" href="SMT.Script.html#2646" class="Function">_</a> <a id="2648" class="Symbol">:</a> <a id="2650" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="2655" href="Text.Parser.String.html#7175" class="Function Operator">parses</a> <a id="2662" class="String">&quot;unsat&quot;</a>
<a id="2670" class="Symbol">_</a> <a id="2672" class="Symbol">=</a> <a id="2674" href="Text.Parser.String.html#6783" class="InductiveConstructor Operator">!</a> <a id="2676" href="SMT.Script.Base.html#3489" class="InductiveConstructor">unsat</a>

<a id="2683" href="SMT.Script.html#2683" class="Function">_</a> <a id="2685" class="Symbol">:</a> <a id="2687" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="2692" href="Text.Parser.String.html#7175" class="Function Operator">parses</a> <a id="2699" class="String">&quot;unknown&quot;</a>
<a id="2709" class="Symbol">_</a> <a id="2711" class="Symbol">=</a> <a id="2713" href="Text.Parser.String.html#6783" class="InductiveConstructor Operator">!</a> <a id="2715" href="SMT.Script.Base.html#3505" class="InductiveConstructor">unknown</a>

<a id="2724" href="SMT.Script.html#2724" class="Function">_</a> <a id="2726" class="Symbol">:</a> <a id="2728" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="2733" href="Text.Parser.String.html#7607" class="Function Operator">rejects</a> <a id="2741" class="String">&quot;dogfood&quot;</a>
<a id="2751" class="Symbol">_</a> <a id="2753" class="Symbol">=</a> <a id="2755" class="Symbol">_</a>


<a id="2759" class="Comment">-- |Construct a definitions parser from a variable parser.</a>
<a id="2818" class="Comment">--</a>
<a id="2821" class="Comment">-- @</a>
<a id="2826" class="Comment">--   (define-fun x0 () Int (- 1))</a>
<a id="2860" class="Comment">-- @</a>
<a id="2865" class="Comment">--</a>
<a id="mkDefnParser"></a><a id="2868" href="SMT.Script.html#2868" class="Function">mkDefnParser</a> <a id="2881" class="Symbol">:</a> <a id="2883" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2886" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2893" class="Symbol">(</a><a id="2894" href="SMT.Script.Base.html#6829" class="Function">Var</a> <a id="2898" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="2899" class="Symbol">)</a> <a id="2901" href="Relation.Unary.html#3359" class="Function">]</a> <a id="2903" class="Symbol">→</a> <a id="2905" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2908" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2915" class="Symbol">(</a><a id="2916" href="SMT.Script.Base.html#6904" class="Function">Defn</a> <a id="2921" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="2922" class="Symbol">)</a> <a id="2924" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2926" href="SMT.Script.html#2868" class="Function">mkDefnParser</a> <a id="2939" class="Symbol">{</a><a id="2940" href="SMT.Script.html#2940" class="Bound">Γ</a><a id="2941" class="Symbol">}</a> <a id="2943" href="SMT.Script.html#2943" class="Bound">pVar</a> <a id="2948" class="Symbol">=</a> <a id="2950" href="Text.Parser.String.html#5425" class="Function">withSpaces</a> <a id="2961" class="Symbol">(</a><a id="2962" href="Text.Parser.String.html#3686" class="Function">guardM</a> <a id="2969" href="SMT.Script.html#3198" class="Function">checkDefn</a> <a id="2979" href="SMT.Script.html#3000" class="Function">pVarVal</a><a id="2986" class="Symbol">)</a>
  <a id="2990" class="Keyword">where</a>
    <a id="3000" href="SMT.Script.html#3000" class="Function">pVarVal</a> <a id="3008" class="Symbol">:</a> <a id="3010" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3013" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3020" class="Symbol">(</a><a id="3021" href="SMT.Script.Base.html#6829" class="Function">Var</a> <a id="3025" href="SMT.Script.html#2940" class="Bound">Γ</a> <a id="3027" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3029" href="SMT.Script.Base.html#6870" class="Function">Val</a><a id="3032" class="Symbol">)</a> <a id="3034" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="3040" href="SMT.Script.html#3000" class="Function">pVarVal</a> <a id="3048" class="Symbol">=</a>
      <a id="3056" href="Text.Parser.String.html#5820" class="Function">parens</a> <a id="3063" class="Symbol">(</a><a id="3064" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="3068" class="Symbol">(</a><a id="3069" href="Text.Parser.String.html#5512" class="Function">lexeme</a> <a id="3076" class="String">&quot;define-fun&quot;</a> <a id="3089" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="3092" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="3096" class="Symbol">(</a><a id="3097" href="SMT.Script.html#2943" class="Bound">pVar</a> <a id="3102" href="Text.Parser.String.html#3898" class="Function Operator">&lt;&amp;&gt;</a>
        <a id="3114" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="3118" class="Symbol">(</a><a id="3119" href="Text.Parser.String.html#5512" class="Function">lexeme</a> <a id="3126" class="String">&quot;()&quot;</a> <a id="3131" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="3134" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="3138" class="Symbol">(</a><a id="3139" href="SMT.Theory.html#1564" class="Function">parseSort</a> <a id="3149" href="Text.Parser.String.html#3776" class="Function Operator">P.&gt;&gt;=</a> <a id="3155" class="Symbol">λ</a> <a id="3157" href="SMT.Script.html#3157" class="Bound">σ</a> <a id="3159" class="Symbol">→</a> <a id="3161" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="3165" class="Symbol">(</a><a id="3166" href="Data.Product.html#2196" class="Function Operator">-,_</a> <a id="3170" href="Text.Parser.String.html#4388" class="Function Operator">&lt;$&gt;</a> <a id="3174" href="SMT.Theory.html#1598" class="Function">parseValue</a> <a id="3185" href="SMT.Script.html#3157" class="Bound">σ</a><a id="3186" class="Symbol">))))))</a>

    <a id="3198" href="SMT.Script.html#3198" class="Function">checkDefn</a> <a id="3208" class="Symbol">:</a> <a id="3210" href="SMT.Script.Base.html#6829" class="Function">Var</a> <a id="3214" href="SMT.Script.html#2940" class="Bound">Γ</a> <a id="3216" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3218" href="SMT.Script.Base.html#6870" class="Function">Val</a> <a id="3222" class="Symbol">→</a> <a id="3224" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3230" class="Symbol">(</a><a id="3231" href="SMT.Script.Base.html#6904" class="Function">Defn</a> <a id="3236" href="SMT.Script.html#2940" class="Bound">Γ</a><a id="3237" class="Symbol">)</a>
    <a id="3243" href="SMT.Script.html#3198" class="Function">checkDefn</a> <a id="3253" class="Symbol">((</a><a id="3255" href="SMT.Script.html#3255" class="Bound">σ</a> <a id="3257" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3259" href="SMT.Script.html#3259" class="Bound">i</a><a id="3260" class="Symbol">)</a> <a id="3262" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3264" class="Symbol">(</a><a id="3265" href="SMT.Script.html#3265" class="Bound">σ′</a> <a id="3268" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3270" href="SMT.Script.html#3270" class="Bound">v</a><a id="3271" class="Symbol">))</a> <a id="3274" class="Keyword">with</a> <a id="3279" href="SMT.Script.html#3255" class="Bound">σ</a> <a id="3281" href="SMT.Theory.html#931" class="Function Operator">≟-Sort</a> <a id="3288" href="SMT.Script.html#3265" class="Bound">σ′</a>
    <a id="3295" class="Symbol">...</a> <a id="3299" class="Symbol">|</a> <a id="3301" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3305" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3310" class="Symbol">=</a> <a id="3312" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3317" class="Symbol">(</a><a id="3318" class="Bound">σ</a> <a id="3320" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3322" class="Bound">i</a> <a id="3324" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3326" class="Bound">v</a><a id="3327" class="Symbol">)</a>
    <a id="3333" class="Symbol">...</a> <a id="3337" class="Symbol">|</a> <a id="3339" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="3343" class="Symbol">_</a>    <a id="3348" class="Symbol">=</a> <a id="3350" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


<a id="3360" class="Comment">-- |Construct a definition-list parser from a variable parser.</a>
<a id="mkDefnsParser"></a><a id="3423" href="SMT.Script.html#3423" class="Function">mkDefnsParser</a> <a id="3437" class="Symbol">:</a> <a id="3439" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3442" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3449" class="Symbol">(</a><a id="3450" href="SMT.Script.Base.html#6829" class="Function">Var</a> <a id="3454" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="3455" class="Symbol">)</a> <a id="3457" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3459" class="Symbol">→</a> <a id="3461" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3464" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3471" class="Symbol">(</a><a id="3472" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="3478" class="Symbol">(</a><a id="3479" href="SMT.Script.Base.html#6904" class="Function">Defn</a> <a id="3484" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="3485" class="Symbol">))</a> <a id="3488" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3490" href="SMT.Script.html#3423" class="Function">mkDefnsParser</a> <a id="3504" class="Symbol">{</a><a id="3505" href="SMT.Script.html#3505" class="Bound">Γ</a><a id="3506" class="Symbol">}</a> <a id="3508" href="SMT.Script.html#3508" class="Bound">pVar</a> <a id="3513" class="Symbol">=</a>
  <a id="3517" href="Text.Parser.String.html#5425" class="Function">withSpaces</a> <a id="3528" class="Symbol">(</a><a id="3529" href="Text.Parser.String.html#5820" class="Function">parens</a> <a id="3536" class="Symbol">(</a><a id="3537" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="3541" class="Symbol">(</a><a id="3542" href="Text.Parser.String.html#5512" class="Function">lexeme</a> <a id="3549" class="String">&quot;model&quot;</a> <a id="3557" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="3560" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="3564" class="Symbol">(</a><a id="3565" href="Text.Parser.String.html#4823" class="Function">list⁺</a> <a id="3571" class="Symbol">(</a><a id="3572" href="SMT.Script.html#2868" class="Function">mkDefnParser</a> <a id="3585" class="Symbol">{</a><a id="3586" href="SMT.Script.html#3505" class="Bound">Γ</a><a id="3587" class="Symbol">}</a> <a id="3589" href="SMT.Script.html#3508" class="Bound">pVar</a><a id="3593" class="Symbol">)))))</a>


<a id="3601" class="Keyword">private</a>
  <a id="MaybeModel"></a><a id="3611" href="SMT.Script.html#3611" class="Function">MaybeModel</a> <a id="3622" class="Symbol">:</a> <a id="3624" href="SMT.Script.Base.html#905" class="Function">Ctxt</a> <a id="3629" class="Symbol">→</a> <a id="3631" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="3637" href="SMT.Script.html#3611" class="Function">MaybeModel</a> <a id="3648" href="SMT.Script.html#3648" class="Bound">Γ</a> <a id="3650" class="Symbol">=</a> <a id="3652" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="3656" class="Symbol">(λ</a> <a id="3659" href="SMT.Script.html#3659" class="Bound">σ</a> <a id="3661" href="SMT.Script.html#3661" class="Bound Operator">_Γ</a> <a id="3664" class="Symbol">→</a> <a id="3666" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3671" class="Symbol">(</a><a id="3672" href="SMT.Theory.html#1003" class="Function">Value</a> <a id="3678" href="SMT.Script.html#3659" class="Bound">σ</a><a id="3679" class="Symbol">))</a> <a id="3682" href="SMT.Script.html#3648" class="Bound">Γ</a>

  <a id="insertMM"></a><a id="3687" href="SMT.Script.html#3687" class="Function">insertMM</a> <a id="3696" class="Symbol">:</a> <a id="3698" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3701" href="SMT.Script.html#3701" class="Bound">σ</a> <a id="3703" href="Data.Product.html#1788" class="Function">]</a> <a id="3705" class="Symbol">(</a><a id="3706" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="3708" href="SMT.Script.Base.html#1090" class="Function Operator">∋</a> <a id="3710" href="SMT.Script.html#3701" class="Bound">σ</a> <a id="3712" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3714" href="SMT.Theory.html#1003" class="Function">Value</a> <a id="3720" href="SMT.Script.html#3701" class="Bound">σ</a><a id="3721" class="Symbol">)</a> <a id="3723" class="Symbol">→</a> <a id="3725" href="SMT.Script.html#3611" class="Function">MaybeModel</a> <a id="3736" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="3738" class="Symbol">→</a> <a id="3740" href="SMT.Script.html#3611" class="Function">MaybeModel</a> <a id="3751" href="SMT.Script.html#1426" class="Generalizable">Γ</a>
  <a id="3755" href="SMT.Script.html#3687" class="Function">insertMM</a> <a id="3764" class="Symbol">{</a><a id="3765" class="DottedPattern Symbol">.</a><a id="3766" class="DottedPattern">σ</a> <a id="3768" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3770" href="SMT.Script.html#3770" class="Bound">Γ</a><a id="3771" class="Symbol">}</a> <a id="3773" class="Symbol">(</a><a id="3774" href="SMT.Script.html#3774" class="Bound">σ</a> <a id="3776" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3778" class="Symbol">(</a><a id="3779" href="Data.Fin.Base.html#1088" class="InductiveConstructor">Fin.zero</a>  <a id="3789" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3791" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="3795" class="Symbol">)</a> <a id="3797" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3799" href="SMT.Script.html#3799" class="Bound">v</a><a id="3800" class="Symbol">)</a> <a id="3802" class="Symbol">(</a><a id="3803" href="SMT.Script.html#3803" class="Bound">vs</a> <a id="3806" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3808" href="SMT.Script.html#3808" class="Bound">env</a><a id="3811" class="Symbol">)</a> <a id="3813" class="Symbol">=</a> <a id="3815" class="Symbol">(</a><a id="3816" href="SMT.Script.html#3799" class="Bound">v</a> <a id="3818" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3820" href="SMT.Script.html#3803" class="Bound">vs</a><a id="3822" class="Symbol">)</a> <a id="3824" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3826" href="SMT.Script.html#3808" class="Bound">env</a>
  <a id="3832" href="SMT.Script.html#3687" class="Function">insertMM</a> <a id="3841" class="Symbol">{</a><a id="3842" href="SMT.Script.html#3842" class="Bound">σ′</a> <a id="3845" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3847" href="SMT.Script.html#3847" class="Bound">Γ</a><a id="3848" class="Symbol">}</a> <a id="3850" class="Symbol">(</a><a id="3851" href="SMT.Script.html#3851" class="Bound">σ</a> <a id="3853" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3855" class="Symbol">(</a><a id="3856" href="Data.Fin.Base.html#1119" class="InductiveConstructor">Fin.suc</a> <a id="3864" href="SMT.Script.html#3864" class="Bound">i</a> <a id="3866" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3868" href="SMT.Script.html#3868" class="Bound">p</a><a id="3869" class="Symbol">)</a>    <a id="3874" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3876" href="SMT.Script.html#3876" class="Bound">v</a><a id="3877" class="Symbol">)</a> <a id="3879" class="Symbol">(</a><a id="3880" href="SMT.Script.html#3880" class="Bound">vs</a> <a id="3883" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3885" href="SMT.Script.html#3885" class="Bound">env</a><a id="3888" class="Symbol">)</a> <a id="3890" class="Symbol">=</a> <a id="3892" href="SMT.Script.html#3880" class="Bound">vs</a> <a id="3895" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3897" href="SMT.Script.html#3687" class="Function">insertMM</a> <a id="3906" class="Symbol">(</a><a id="3907" href="SMT.Script.html#3851" class="Bound">σ</a> <a id="3909" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3911" class="Symbol">(</a><a id="3912" href="SMT.Script.html#3864" class="Bound">i</a> <a id="3914" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3916" href="SMT.Script.html#3868" class="Bound">p</a><a id="3917" class="Symbol">)</a> <a id="3919" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3921" href="SMT.Script.html#3876" class="Bound">v</a><a id="3922" class="Symbol">)</a> <a id="3924" href="SMT.Script.html#3885" class="Bound">env</a>

  <a id="mkMM"></a><a id="3931" href="SMT.Script.html#3931" class="Function">mkMM</a> <a id="3936" class="Symbol">:</a> <a id="3938" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3943" class="Symbol">(</a><a id="3944" href="SMT.Script.Base.html#6904" class="Function">Defn</a> <a id="3949" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="3950" class="Symbol">)</a> <a id="3952" class="Symbol">→</a> <a id="3954" href="SMT.Script.html#3611" class="Function">MaybeModel</a> <a id="3965" href="SMT.Script.html#1426" class="Generalizable">Γ</a>
  <a id="3969" href="SMT.Script.html#3931" class="Function">mkMM</a> <a id="3974" class="Symbol">{</a><a id="3975" href="SMT.Script.html#3975" class="Bound">Γ</a><a id="3976" class="Symbol">}</a> <a id="3978" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="3987" class="Symbol">=</a> <a id="3989" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="4000" class="Symbol">(λ</a> <a id="4003" href="SMT.Script.html#4003" class="Bound Operator">_σ</a> <a id="4006" href="SMT.Script.html#4006" class="Bound Operator">_Γ</a> <a id="4009" class="Symbol">→</a> <a id="4011" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4013" class="Symbol">)</a> <a id="4015" href="SMT.Script.html#3975" class="Bound">Γ</a>
  <a id="4019" href="SMT.Script.html#3931" class="Function">mkMM</a> <a id="4024" class="Symbol">{</a><a id="4025" href="SMT.Script.html#4025" class="Bound">Γ</a><a id="4026" class="Symbol">}</a> <a id="4028" class="Symbol">(</a><a id="4029" href="SMT.Script.html#4029" class="Bound">v</a> <a id="4031" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4033" href="SMT.Script.html#4033" class="Bound">vs</a><a id="4035" class="Symbol">)</a> <a id="4037" class="Symbol">=</a> <a id="4039" href="SMT.Script.html#3687" class="Function">insertMM</a> <a id="4048" href="SMT.Script.html#4029" class="Bound">v</a> <a id="4050" class="Symbol">(</a><a id="4051" href="SMT.Script.html#3931" class="Function">mkMM</a> <a id="4056" href="SMT.Script.html#4033" class="Bound">vs</a><a id="4058" class="Symbol">)</a>

  <a id="fromSingleton"></a><a id="4063" href="SMT.Script.html#4063" class="Function">fromSingleton</a> <a id="4077" class="Symbol">:</a> <a id="4079" class="Symbol">{</a><a id="4080" href="SMT.Script.html#4080" class="Bound">A</a> <a id="4082" class="Symbol">:</a> <a id="4084" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4087" class="Symbol">}</a> <a id="4089" class="Symbol">→</a> <a id="4091" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4096" href="SMT.Script.html#4080" class="Bound">A</a> <a id="4098" class="Symbol">→</a> <a id="4100" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4106" href="SMT.Script.html#4080" class="Bound">A</a>
  <a id="4110" href="SMT.Script.html#4063" class="Function">fromSingleton</a> <a id="4124" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4127" class="Symbol">=</a> <a id="4129" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
  <a id="4139" href="SMT.Script.html#4063" class="Function">fromSingleton</a> <a id="4153" class="Symbol">(</a><a id="4154" href="SMT.Script.html#4154" class="Bound">v</a> <a id="4156" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4158" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4160" class="Symbol">)</a> <a id="4162" class="Symbol">=</a> <a id="4164" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4169" href="SMT.Script.html#4154" class="Bound">v</a>
  <a id="4173" href="SMT.Script.html#4063" class="Function">fromSingleton</a> <a id="4187" class="Symbol">(_</a> <a id="4190" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4192" class="Symbol">_</a> <a id="4194" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4196" class="Symbol">_)</a> <a id="4199" class="Symbol">=</a> <a id="4201" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

  <a id="checkMM"></a><a id="4212" href="SMT.Script.html#4212" class="Function">checkMM</a> <a id="4220" class="Symbol">:</a> <a id="4222" href="SMT.Script.html#3611" class="Function">MaybeModel</a> <a id="4233" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="4235" class="Symbol">→</a> <a id="4237" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4243" class="Symbol">(</a><a id="4244" href="SMT.Script.Base.html#4154" class="Datatype">Model</a> <a id="4250" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="4251" class="Symbol">)</a>
  <a id="4255" href="SMT.Script.html#4212" class="Function">checkMM</a> <a id="4263" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="4266" class="Symbol">=</a> <a id="4268" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4273" href="SMT.Script.Base.html#4187" class="InductiveConstructor">[]</a>
  <a id="4278" href="SMT.Script.html#4212" class="Function">checkMM</a> <a id="4286" class="Symbol">(</a><a id="4287" href="SMT.Script.html#4287" class="Bound">vs</a> <a id="4290" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4292" href="SMT.Script.html#4292" class="Bound">env</a><a id="4295" class="Symbol">)</a> <a id="4297" class="Symbol">=</a> <a id="4299" href="Data.Maybe.Base.html#2766" class="Function">Maybe.zipWith</a> <a id="4313" href="SMT.Script.Base.html#4204" class="InductiveConstructor Operator">_∷_</a> <a id="4317" class="Symbol">(</a><a id="4318" href="SMT.Script.html#4063" class="Function">fromSingleton</a> <a id="4332" href="SMT.Script.html#4287" class="Bound">vs</a><a id="4334" class="Symbol">)</a> <a id="4336" class="Symbol">(</a><a id="4337" href="SMT.Script.html#4212" class="Function">checkMM</a> <a id="4345" href="SMT.Script.html#4292" class="Bound">env</a><a id="4348" class="Symbol">)</a>


<a id="4352" class="Comment">-- |Construct a model parser from a variable parser.</a>
<a id="mkModelParser"></a><a id="4405" href="SMT.Script.html#4405" class="Function">mkModelParser</a> <a id="4419" class="Symbol">:</a> <a id="4421" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4424" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4431" class="Symbol">(</a><a id="4432" href="SMT.Script.Base.html#6829" class="Function">Var</a> <a id="4436" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="4437" class="Symbol">)</a> <a id="4439" href="Relation.Unary.html#3359" class="Function">]</a> <a id="4441" class="Symbol">→</a> <a id="4443" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4446" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4453" class="Symbol">(</a><a id="4454" href="SMT.Script.Base.html#4154" class="Datatype">Model</a> <a id="4460" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="4461" class="Symbol">)</a> <a id="4463" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="4465" href="SMT.Script.html#4405" class="Function">mkModelParser</a> <a id="4479" class="Symbol">{</a><a id="4480" href="SMT.Script.html#4480" class="Bound">Γ</a><a id="4481" class="Symbol">}</a> <a id="4483" href="SMT.Script.html#4483" class="Bound">pVar</a> <a id="4488" class="Symbol">=</a> <a id="4490" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="4495" href="Text.Parser.String.html#3776" class="Function Operator">P.&gt;&gt;=</a> <a id="4501" class="Symbol">λ</a> <a id="4503" class="Symbol">{</a> <a id="4505" href="SMT.Script.Base.html#3473" class="InductiveConstructor">sat</a> <a id="4509" class="Symbol">→</a> <a id="4511" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="4515" href="SMT.Script.html#4624" class="Function">pModel</a> <a id="4522" class="Symbol">;</a> <a id="4524" class="CatchallClause Symbol">_</a> <a id="4526" class="Symbol">→</a> <a id="4528" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="4532" href="Text.Parser.String.html#4217" class="Function">fail</a> <a id="4537" class="Symbol">}</a>
  <a id="4541" class="Keyword">where</a>
    <a id="4551" class="Comment">-- Insert each definition into a model, and check if it is complete.</a>
    <a id="4624" href="SMT.Script.html#4624" class="Function">pModel</a> <a id="4631" class="Symbol">:</a> <a id="4633" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4636" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4643" class="Symbol">(</a><a id="4644" href="SMT.Script.Base.html#4154" class="Datatype">Model</a> <a id="4650" href="SMT.Script.html#4480" class="Bound">Γ</a><a id="4651" class="Symbol">)</a> <a id="4653" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="4659" href="SMT.Script.html#4624" class="Function">pModel</a> <a id="4666" class="Symbol">=</a> <a id="4668" href="Text.Parser.String.html#3686" class="Function">guardM</a> <a id="4675" href="SMT.Script.html#4212" class="Function">checkMM</a> <a id="4683" class="Symbol">(</a><a id="4684" href="SMT.Script.html#3931" class="Function">mkMM</a> <a id="4689" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4691" href="Data.List.NonEmpty.html#1760" class="Function">List⁺.toList</a> <a id="4704" href="Text.Parser.String.html#4388" class="Function Operator">&lt;$&gt;</a> <a id="4708" href="SMT.Script.html#3423" class="Function">mkDefnsParser</a> <a id="4722" class="Symbol">{</a><a id="4723" href="SMT.Script.html#4480" class="Bound">Γ</a><a id="4724" class="Symbol">}</a> <a id="4726" href="SMT.Script.html#4483" class="Bound">pVar</a><a id="4730" class="Symbol">)</a>

<a id="mkOutputParsers⁺"></a><a id="4733" href="SMT.Script.html#4733" class="Function">mkOutputParsers⁺</a> <a id="4750" class="Symbol">:</a> <a id="4752" href="SMT.Script.html#2371" class="Function">OutputParsers</a> <a id="4766" class="Symbol">(</a><a id="4767" href="SMT.Script.html#1517" class="Generalizable">ξ</a> <a id="4769" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4771" href="SMT.Script.html#1542" class="Generalizable">Ξ</a><a id="4772" class="Symbol">)</a> <a id="4774" class="Symbol">→</a> <a id="4776" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4779" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4786" class="Symbol">(</a><a id="4787" href="SMT.Script.Base.html#4662" class="Datatype">Outputs</a> <a id="4795" class="Symbol">(</a><a id="4796" href="SMT.Script.html#1517" class="Generalizable">ξ</a> <a id="4798" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4800" href="SMT.Script.html#1542" class="Generalizable">Ξ</a><a id="4801" class="Symbol">))</a> <a id="4804" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="4806" href="SMT.Script.html#4733" class="Function">mkOutputParsers⁺</a> <a id="4823" class="Symbol">(</a><a id="4824" href="SMT.Script.html#4824" class="Bound">op</a> <a id="4827" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4829" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="4831" class="Symbol">)</a>          <a id="4842" class="Symbol">=</a> <a id="4844" class="Symbol">(</a><a id="4845" href="SMT.Script.Base.html#4722" class="InductiveConstructor Operator">_∷</a> <a id="4848" href="SMT.Script.Base.html#4703" class="InductiveConstructor">[]</a><a id="4850" class="Symbol">)</a> <a id="4852" href="Text.Parser.String.html#4388" class="Function Operator">&lt;$&gt;</a> <a id="4856" href="SMT.Script.html#4824" class="Bound">op</a>
<a id="4859" href="SMT.Script.html#4733" class="Function">mkOutputParsers⁺</a> <a id="4876" class="Symbol">(</a><a id="4877" href="SMT.Script.html#4877" class="Bound">op</a> <a id="4880" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4882" href="SMT.Script.html#4882" class="Bound">ops</a><a id="4885" class="Symbol">@(_</a> <a id="4889" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4891" class="Symbol">_))</a> <a id="4895" class="Symbol">=</a> <a id="4897" href="SMT.Script.Base.html#4722" class="InductiveConstructor Operator">_∷_</a> <a id="4901" href="Text.Parser.String.html#4388" class="Function Operator">&lt;$&gt;</a> <a id="4905" href="SMT.Script.html#4877" class="Bound">op</a> <a id="4908" href="Text.Parser.String.html#4572" class="Function Operator">&lt;*&gt;</a> <a id="4912" href="Text.Parser.String.html#4150" class="Function">box</a> <a id="4916" class="Symbol">(</a><a id="4917" href="SMT.Script.html#4733" class="Function">mkOutputParsers⁺</a> <a id="4934" href="SMT.Script.html#4882" class="Bound">ops</a><a id="4937" class="Symbol">)</a>


<a id="4941" class="Comment">-- * Name state monad</a>

<a id="NameState"></a><a id="4964" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="4974" class="Symbol">:</a> <a id="4976" class="Symbol">(</a><a id="4977" href="SMT.Script.html#4977" class="Bound">Γ</a> <a id="4979" href="SMT.Script.html#4979" class="Bound">Γ′</a> <a id="4982" class="Symbol">:</a> <a id="4984" href="SMT.Script.Base.html#905" class="Function">Ctxt</a><a id="4988" class="Symbol">)</a> <a id="4990" class="Symbol">→</a> <a id="4992" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4996" class="Symbol">→</a> <a id="4998" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="5002" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="5012" href="SMT.Script.html#5012" class="Bound">Γ</a> <a id="5014" href="SMT.Script.html#5014" class="Bound">Γ′</a> <a id="5017" href="SMT.Script.html#5017" class="Bound">A</a> <a id="5019" class="Symbol">=</a> <a id="5021" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="5029" class="Symbol">(λ</a> <a id="5032" href="SMT.Script.html#5032" class="Bound">Γ</a> <a id="5034" class="Symbol">→</a> <a id="5036" href="SMT.Script.Names.html#2015" class="Record">Names</a> <a id="5042" href="SMT.Script.html#5032" class="Bound">Γ</a> <a id="5044" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5046" href="SMT.Script.html#1833" class="Function">VarParsers</a> <a id="5057" href="SMT.Script.html#5032" class="Bound">Γ</a><a id="5058" class="Symbol">)</a> <a id="5060" href="Function.Base.html#615" class="Function">id</a> <a id="5063" href="SMT.Script.html#5012" class="Bound">Γ</a> <a id="5065" href="SMT.Script.html#5014" class="Bound">Γ′</a> <a id="5068" href="SMT.Script.html#5017" class="Bound">A</a>

<a id="5071" class="Comment">-- When showing terms, we need to pass around a name state,</a>
<a id="5131" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
<a id="5196" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
<a id="5258" class="Keyword">private</a>
  <a id="monadStateNameState"></a><a id="5268" href="SMT.Script.html#5268" class="Function">monadStateNameState</a> <a id="5288" class="Symbol">=</a>
    <a id="5294" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="5321" class="Symbol">(λ</a> <a id="5324" href="SMT.Script.html#5324" class="Bound">Γ</a> <a id="5326" class="Symbol">→</a> <a id="5328" href="SMT.Script.Names.html#2015" class="Record">Names</a> <a id="5334" href="SMT.Script.html#5324" class="Bound">Γ</a> <a id="5336" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5338" href="SMT.Script.html#1833" class="Function">VarParsers</a> <a id="5349" href="SMT.Script.html#5324" class="Bound">Γ</a><a id="5350" class="Symbol">)</a> <a id="5352" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

<a id="5368" class="Keyword">open</a> <a id="5373" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="5388" href="SMT.Script.html#5268" class="Function">monadStateNameState</a>
  <a id="5410" class="Keyword">using</a> <a id="5416" class="Symbol">(</a><a id="5417" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="5423" class="Symbol">;</a> <a id="5425" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="5430" class="Symbol">;</a> <a id="5432" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="5436" class="Symbol">;</a> <a id="5438" href="Category.Monad.State.html#2831" class="Field">put</a><a id="5441" class="Symbol">;</a> <a id="5443" href="Category.Monad.State.html#2799" class="Field">get</a><a id="5446" class="Symbol">;</a> <a id="5448" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="5454" class="Symbol">)</a>

<a id="freshNameS"></a><a id="5457" href="SMT.Script.html#5457" class="Function">freshNameS</a> <a id="5468" class="Symbol">:</a> <a id="5470" class="Symbol">(</a><a id="5471" href="SMT.Script.html#5471" class="Bound">σ</a> <a id="5473" class="Symbol">:</a> <a id="5475" href="SMT.Theory.html#908" class="Function">Sort</a><a id="5479" class="Symbol">)</a> <a id="5481" class="Symbol">→</a> <a id="5483" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="5493" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="5495" class="Symbol">(</a><a id="5496" href="SMT.Script.html#5471" class="Bound">σ</a> <a id="5498" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5500" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="5501" class="Symbol">)</a> <a id="5503" href="SMT.Script.Names.html#1427" class="Function">Name</a>
<a id="5508" href="SMT.Script.html#5457" class="Function">freshNameS</a> <a id="5519" href="SMT.Script.html#5519" class="Bound">σ</a> <a id="5521" class="Symbol">=</a> <a id="5523" class="Keyword">do</a>
  <a id="5528" class="Symbol">(</a><a id="5529" href="SMT.Script.html#5529" class="Bound">ns</a> <a id="5532" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5534" href="SMT.Script.html#5534" class="Bound">vps</a><a id="5537" class="Symbol">)</a> <a id="5539" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5541" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5547" class="Keyword">let</a> <a id="5551" class="Symbol">(</a><a id="5552" href="SMT.Script.html#5552" class="Bound">n</a> <a id="5554" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5556" href="SMT.Script.html#5556" class="Bound">ns</a><a id="5558" class="Symbol">)</a> <a id="5560" class="Symbol">=</a> <a id="5562" href="SMT.Script.Names.html#2225" class="Function">freshName</a> <a id="5572" href="SMT.Script.html#5519" class="Bound">σ</a> <a id="5574" href="SMT.Script.html#5529" class="Bound">ns</a>
  <a id="5579" class="Keyword">let</a> <a id="5583" href="SMT.Script.html#5583" class="Bound">vps</a> <a id="5587" class="Symbol">=</a> <a id="5589" class="Symbol">((</a><a id="5591" href="Data.Fin.Base.html#1088" class="InductiveConstructor">Fin.zero</a> <a id="5600" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5602" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5606" class="Symbol">)</a> <a id="5608" href="Text.Parser.String.html#4484" class="Function Operator">&lt;$</a> <a id="5611" href="Text.Parser.String.html#5425" class="Function">withSpaces</a> <a id="5622" class="Symbol">(</a><a id="5623" href="Text.Parser.String.html#5725" class="Function">exacts</a> <a id="5630" href="SMT.Script.html#5552" class="Bound">n</a><a id="5631" class="Symbol">))</a> <a id="5634" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5636" href="SMT.Script.html#5534" class="Bound">vps</a>
  <a id="5642" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="5646" class="Symbol">(</a><a id="5647" href="SMT.Script.html#5556" class="Bound">ns</a> <a id="5650" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5652" href="SMT.Script.html#5583" class="Bound">vps</a><a id="5655" class="Symbol">)</a>
  <a id="5659" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5666" href="SMT.Script.html#5552" class="Bound">n</a>

<a id="dropNameS"></a><a id="5669" href="SMT.Script.html#5669" class="Function">dropNameS</a> <a id="5679" class="Symbol">:</a> <a id="5681" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="5691" class="Symbol">(</a><a id="5692" href="SMT.Script.html#1407" class="Generalizable">σ</a> <a id="5694" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5696" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="5697" class="Symbol">)</a> <a id="5699" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="5701" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="5703" href="SMT.Script.html#5669" class="Function">dropNameS</a> <a id="5713" class="Symbol">=</a> <a id="5715" class="Keyword">do</a>
  <a id="5720" class="Symbol">(</a><a id="5721" href="SMT.Script.html#5721" class="Bound">ns</a> <a id="5724" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5726" class="Symbol">_</a> <a id="5728" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5730" href="SMT.Script.html#5730" class="Bound">vps</a><a id="5733" class="Symbol">)</a> <a id="5735" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5737" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5743" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="5747" class="Symbol">(</a><a id="5748" href="SMT.Script.Names.html#2513" class="Function">dropName</a> <a id="5757" href="SMT.Script.html#5721" class="Bound">ns</a> <a id="5760" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5762" href="SMT.Script.html#5730" class="Bound">vps</a><a id="5765" class="Symbol">)</a>
  <a id="5769" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5776" class="Symbol">_</a>

<a id="lookupNameS"></a><a id="5779" href="SMT.Script.html#5779" class="Function">lookupNameS</a> <a id="5791" class="Symbol">:</a> <a id="5793" class="Symbol">(</a><a id="5794" href="SMT.Script.html#5794" class="Bound">i</a> <a id="5796" class="Symbol">:</a> <a id="5798" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="5800" href="SMT.Script.Base.html#1090" class="Function Operator">∋</a> <a id="5802" href="SMT.Script.html#1407" class="Generalizable">σ</a><a id="5803" class="Symbol">)</a> <a id="5805" class="Symbol">→</a> <a id="5807" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="5817" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="5819" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="5821" href="SMT.Script.Names.html#1427" class="Function">Name</a>
<a id="5826" href="SMT.Script.html#5779" class="Function">lookupNameS</a> <a id="5838" class="Symbol">(</a><a id="5839" href="SMT.Script.html#5839" class="Bound">i</a> <a id="5841" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5843" href="SMT.Script.html#5843" class="Bound Operator">_p</a><a id="5845" class="Symbol">)</a> <a id="5847" class="Symbol">=</a> <a id="5849" class="Keyword">do</a>
  <a id="5854" class="Symbol">(</a><a id="5855" href="SMT.Script.html#5855" class="Bound">ns</a> <a id="5858" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5860" href="SMT.Script.html#5860" class="Bound Operator">_vps</a><a id="5864" class="Symbol">)</a> <a id="5866" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5868" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5874" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5881" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="5883" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="5894" class="Symbol">(</a><a id="5895" href="SMT.Script.Names.html#2056" class="Field">Names.nameEnv</a> <a id="5909" href="SMT.Script.html#5855" class="Bound">ns</a><a id="5911" class="Symbol">)</a> <a id="5913" href="SMT.Script.html#5839" class="Bound">i</a>


<a id="5917" class="Comment">-- * Printing functions</a>

<a id="5942" class="Keyword">mutual</a>

  <a id="5952" class="Comment">-- |Show a term as an S-expression.</a>
  <a id="showTermS"></a><a id="5990" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6000" class="Symbol">:</a> <a id="6002" href="SMT.Script.Base.html#1313" class="Datatype">Term</a> <a id="6007" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6009" href="SMT.Script.html#1407" class="Generalizable">σ</a> <a id="6011" class="Symbol">→</a> <a id="6013" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="6023" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6025" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6027" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="6036" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6046" class="Symbol">(</a><a id="6047" href="SMT.Script.Base.html#1358" class="InductiveConstructor">var</a> <a id="6051" href="SMT.Script.html#6051" class="Bound">i</a><a id="6052" class="Symbol">)</a> <a id="6054" class="Symbol">=</a> <a id="6056" class="Keyword">do</a>
    <a id="6063" href="SMT.Script.html#6063" class="Bound">n</a> <a id="6065" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6067" href="SMT.Script.html#5779" class="Function">lookupNameS</a> <a id="6079" href="SMT.Script.html#6051" class="Bound">i</a>
    <a id="6085" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6092" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="6094" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6103" href="SMT.Script.html#6063" class="Bound">n</a>
  <a id="6107" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6117" class="Symbol">(</a><a id="6118" href="SMT.Script.Base.html#1400" class="InductiveConstructor">lit</a> <a id="6122" href="SMT.Script.html#6122" class="Bound">l</a><a id="6123" class="Symbol">)</a> <a id="6125" class="Symbol">=</a> <a id="6127" class="Keyword">do</a>
    <a id="6134" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6141" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="6143" href="SMT.Theory.html#1344" class="Function">showLiteral</a> <a id="6155" href="SMT.Script.html#6122" class="Bound">l</a>
  <a id="6159" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6169" class="Symbol">(</a><a id="6170" href="SMT.Script.Base.html#1446" class="InductiveConstructor">app</a> <a id="6174" href="SMT.Script.html#6174" class="Bound">x</a> <a id="6176" href="SMT.Script.html#6176" class="Bound">xs</a><a id="6178" class="Symbol">)</a> <a id="6180" class="Symbol">=</a> <a id="6182" class="Keyword">do</a>
    <a id="6189" class="Keyword">let</a> <a id="6193" href="SMT.Script.html#6193" class="Bound">x</a> <a id="6195" class="Symbol">=</a> <a id="6197" href="SMT.Theory.html#1397" class="Function">showIdentifier</a> <a id="6212" href="SMT.Script.html#6174" class="Bound">x</a>
    <a id="6218" href="SMT.Script.html#6218" class="Bound">xs</a> <a id="6221" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6223" href="SMT.Script.html#6633" class="Function">showArgsS</a> <a id="6233" href="SMT.Script.html#6176" class="Bound">xs</a>
    <a id="6240" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6247" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="6249" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="6257" class="Symbol">(</a><a id="6258" href="SMT.Script.html#6193" class="Bound">x</a> <a id="6260" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6262" href="SMT.Script.html#6218" class="Bound">xs</a><a id="6264" class="Symbol">)</a>
  <a id="6268" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6278" class="Symbol">(</a><a id="6279" href="SMT.Script.Base.html#1540" class="InductiveConstructor">forAll</a> <a id="6286" href="SMT.Script.html#6286" class="Bound">σ</a> <a id="6288" href="SMT.Script.html#6288" class="Bound">x</a><a id="6289" class="Symbol">)</a> <a id="6291" class="Symbol">=</a> <a id="6293" class="Keyword">do</a>
    <a id="6300" href="SMT.Script.html#6300" class="Bound">n</a> <a id="6302" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6304" href="SMT.Script.html#5457" class="Function">freshNameS</a> <a id="6315" href="SMT.Script.html#6286" class="Bound">σ</a>
    <a id="6321" href="SMT.Script.html#6321" class="Bound">x</a> <a id="6323" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6325" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6335" href="SMT.Script.html#6288" class="Bound">x</a>
    <a id="6341" href="SMT.Script.html#5669" class="Function">dropNameS</a>
    <a id="6355" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6362" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="6364" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="6372" class="Symbol">(</a><a id="6373" class="String">&quot;forall&quot;</a> <a id="6382" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6384" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="6392" class="Symbol">(</a><a id="6393" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="6401" class="Symbol">(</a><a id="6402" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6411" href="SMT.Script.html#6300" class="Bound">n</a> <a id="6413" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6415" href="SMT.Theory.html#1309" class="Function">showSort</a> <a id="6424" href="SMT.Script.html#6286" class="Bound">σ</a> <a id="6426" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6428" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6430" class="Symbol">)</a> <a id="6432" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6434" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6436" class="Symbol">)</a> <a id="6438" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6440" href="SMT.Script.html#6321" class="Bound">x</a> <a id="6442" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6444" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6446" class="Symbol">)</a>
  <a id="6450" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6460" class="Symbol">(</a><a id="6461" href="SMT.Script.Base.html#1604" class="InductiveConstructor">exists</a> <a id="6468" href="SMT.Script.html#6468" class="Bound">σ</a> <a id="6470" href="SMT.Script.html#6470" class="Bound">x</a><a id="6471" class="Symbol">)</a> <a id="6473" class="Symbol">=</a> <a id="6475" class="Keyword">do</a>
    <a id="6482" href="SMT.Script.html#6482" class="Bound">n</a> <a id="6484" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6486" href="SMT.Script.html#5457" class="Function">freshNameS</a> <a id="6497" href="SMT.Script.html#6468" class="Bound">σ</a>
    <a id="6503" href="SMT.Script.html#6503" class="Bound">x</a> <a id="6505" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6507" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6517" href="SMT.Script.html#6470" class="Bound">x</a>
    <a id="6523" href="SMT.Script.html#5669" class="Function">dropNameS</a>
    <a id="6537" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6544" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="6546" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="6554" class="Symbol">(</a><a id="6555" class="String">&quot;exists&quot;</a> <a id="6564" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6566" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="6574" class="Symbol">(</a><a id="6575" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="6583" class="Symbol">(</a><a id="6584" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6593" href="SMT.Script.html#6482" class="Bound">n</a> <a id="6595" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6597" href="SMT.Theory.html#1309" class="Function">showSort</a> <a id="6606" href="SMT.Script.html#6468" class="Bound">σ</a> <a id="6608" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6610" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6612" class="Symbol">)</a> <a id="6614" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6616" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6618" class="Symbol">)</a> <a id="6620" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6622" href="SMT.Script.html#6503" class="Bound">x</a> <a id="6624" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6626" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6628" class="Symbol">)</a>

  <a id="showArgsS"></a><a id="6633" href="SMT.Script.html#6633" class="Function">showArgsS</a> <a id="6643" class="Symbol">:</a> <a id="6645" href="SMT.Script.Base.html#1667" class="Function">Args</a> <a id="6650" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6652" href="SMT.Script.html#1445" class="Generalizable">Δ</a> <a id="6654" class="Symbol">→</a> <a id="6656" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="6666" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6668" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6670" class="Symbol">(</a><a id="6671" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6676" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="6682" class="Symbol">)</a>
  <a id="6686" href="SMT.Script.html#6633" class="Function">showArgsS</a> <a id="6696" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>       <a id="6705" class="Symbol">=</a> <a id="6707" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6714" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="6719" href="SMT.Script.html#6633" class="Function">showArgsS</a> <a id="6729" class="Symbol">(</a><a id="6730" href="SMT.Script.html#6730" class="Bound">x</a> <a id="6732" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6734" href="SMT.Script.html#6734" class="Bound">xs</a><a id="6736" class="Symbol">)</a> <a id="6738" class="Symbol">=</a> <a id="6740" class="Keyword">do</a> <a id="6743" href="SMT.Script.html#6743" class="Bound">x</a> <a id="6745" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6747" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="6757" href="SMT.Script.html#6730" class="Bound">x</a><a id="6758" class="Symbol">;</a> <a id="6760" href="SMT.Script.html#6760" class="Bound">xs</a> <a id="6763" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6765" href="SMT.Script.html#6633" class="Function">showArgsS</a> <a id="6775" href="SMT.Script.html#6734" class="Bound">xs</a><a id="6777" class="Symbol">;</a> <a id="6779" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6786" class="Symbol">(</a><a id="6787" href="SMT.Script.html#6743" class="Bound">x</a> <a id="6789" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6791" href="SMT.Script.html#6760" class="Bound">xs</a><a id="6793" class="Symbol">)</a>


<a id="6797" class="Comment">-- |Show a command as an S-expression, and build up an environment of output parsers.</a>
<a id="showCommandS"></a><a id="6883" href="SMT.Script.html#6883" class="Function">showCommandS</a> <a id="6896" class="Symbol">:</a> <a id="6898" href="SMT.Script.Base.html#6213" class="Datatype">Command</a> <a id="6906" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6908" href="SMT.Script.html#1431" class="Generalizable">δΓ</a> <a id="6911" href="SMT.Script.html#1547" class="Generalizable">δΞ</a> <a id="6914" class="Symbol">→</a> <a id="6916" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="6926" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="6928" class="Symbol">(</a><a id="6929" href="SMT.Script.html#1431" class="Generalizable">δΓ</a> <a id="6932" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="6935" href="SMT.Script.html#1426" class="Generalizable">Γ</a><a id="6936" class="Symbol">)</a> <a id="6938" class="Symbol">(</a><a id="6939" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="6946" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6948" href="SMT.Script.html#2371" class="Function">OutputParsers</a> <a id="6962" href="SMT.Script.html#1547" class="Generalizable">δΞ</a><a id="6964" class="Symbol">)</a>
<a id="6966" href="SMT.Script.html#6883" class="Function">showCommandS</a> <a id="6979" class="Symbol">(</a><a id="6980" href="SMT.Script.Base.html#6278" class="InductiveConstructor">set-logic</a> <a id="6990" href="SMT.Script.html#6990" class="Bound">l</a><a id="6991" class="Symbol">)</a> <a id="6993" class="Symbol">=</a> <a id="6995" class="Keyword">do</a>
  <a id="7000" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7007" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7009" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="7017" class="Symbol">(</a><a id="7018" class="String">&quot;set-logic&quot;</a> <a id="7030" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7032" href="SMT.Logics.html#6232" class="Function">showLogic</a> <a id="7042" href="SMT.Script.html#6990" class="Bound">l</a> <a id="7044" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7046" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7048" class="Symbol">)</a> <a id="7050" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7052" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7055" href="SMT.Script.html#6883" class="Function">showCommandS</a> <a id="7068" class="Symbol">(</a><a id="7069" href="SMT.Script.Base.html#6326" class="InductiveConstructor">declare-const</a> <a id="7083" href="SMT.Script.html#7083" class="Bound">σ</a><a id="7084" class="Symbol">)</a> <a id="7086" class="Symbol">=</a> <a id="7088" class="Keyword">do</a>
  <a id="7093" href="SMT.Script.html#7093" class="Bound">n</a> <a id="7095" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7097" href="SMT.Script.html#5457" class="Function">freshNameS</a> <a id="7108" href="SMT.Script.html#7083" class="Bound">σ</a>
  <a id="7112" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7119" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7121" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="7129" class="Symbol">(</a><a id="7130" class="String">&quot;declare-const&quot;</a> <a id="7146" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7148" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="7157" href="SMT.Script.html#7093" class="Bound">n</a> <a id="7159" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7161" href="SMT.Theory.html#1309" class="Function">showSort</a> <a id="7170" href="SMT.Script.html#7083" class="Bound">σ</a> <a id="7172" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7174" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7176" class="Symbol">)</a> <a id="7178" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7180" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7183" href="SMT.Script.html#6883" class="Function">showCommandS</a> <a id="7196" class="Symbol">(</a><a id="7197" href="SMT.Script.Base.html#6379" class="InductiveConstructor">assert</a> <a id="7204" href="SMT.Script.html#7204" class="Bound">x</a><a id="7205" class="Symbol">)</a> <a id="7207" class="Symbol">=</a> <a id="7209" class="Keyword">do</a>
  <a id="7214" href="SMT.Script.html#7214" class="Bound">x</a> <a id="7216" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7218" href="SMT.Script.html#5990" class="Function">showTermS</a> <a id="7228" href="SMT.Script.html#7204" class="Bound">x</a>
  <a id="7232" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7239" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7241" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="7249" class="Symbol">(</a><a id="7250" class="String">&quot;assert&quot;</a> <a id="7259" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7261" href="SMT.Script.html#7214" class="Bound">x</a> <a id="7263" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7265" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7267" class="Symbol">)</a> <a id="7269" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7271" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7274" href="SMT.Script.html#6883" class="Function">showCommandS</a> <a id="7287" href="SMT.Script.Base.html#6427" class="InductiveConstructor">check-sat</a> <a id="7297" class="Symbol">=</a> <a id="7299" class="Keyword">do</a>
  <a id="7304" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7311" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7313" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="7321" class="Symbol">(</a><a id="7322" class="String">&quot;check-sat&quot;</a> <a id="7334" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7336" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7338" class="Symbol">)</a> <a id="7340" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7342" href="SMT.Script.html#2490" class="Function">pSat</a> <a id="7347" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7349" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7352" href="SMT.Script.html#6883" class="Function">showCommandS</a> <a id="7365" href="SMT.Script.Base.html#6469" class="InductiveConstructor">get-model</a> <a id="7375" class="Symbol">=</a> <a id="7377" class="Keyword">do</a>
  <a id="7382" class="Symbol">(</a><a id="7383" href="SMT.Script.html#7383" class="Bound Operator">_ns</a> <a id="7387" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7389" href="SMT.Script.html#7389" class="Bound">vps</a><a id="7392" class="Symbol">)</a> <a id="7394" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7396" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="7402" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7409" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7411" href="Data.String.Base.html#2550" class="Function">String.unlines</a> <a id="7426" class="Symbol">(</a> <a id="7428" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="7436" class="Symbol">(</a><a id="7437" class="String">&quot;check-sat&quot;</a> <a id="7449" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7451" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7453" class="Symbol">)</a>
                          <a id="7481" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7483" href="SMT.Script.html#1697" class="Function">mkSTerm</a> <a id="7491" class="Symbol">(</a><a id="7492" class="String">&quot;get-model&quot;</a> <a id="7504" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7506" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7508" class="Symbol">)</a> <a id="7510" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7512" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7515" class="Symbol">)</a>
         <a id="7526" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7528" href="SMT.Script.html#4405" class="Function">mkModelParser</a> <a id="7542" class="Symbol">(</a><a id="7543" href="SMT.Script.html#1991" class="Function">mkVarParser</a> <a id="7555" href="SMT.Script.html#7389" class="Bound">vps</a><a id="7558" class="Symbol">)</a> <a id="7560" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7562" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>

<a id="7566" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
<a id="showScriptS"></a><a id="7651" href="SMT.Script.html#7651" class="Function">showScriptS</a> <a id="7663" class="Symbol">:</a> <a id="7665" href="SMT.Script.Base.html#6608" class="Datatype">Script</a> <a id="7672" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="7674" href="SMT.Script.html#1428" class="Generalizable">Γ′</a> <a id="7677" href="SMT.Script.html#1542" class="Generalizable">Ξ</a> <a id="7679" class="Symbol">→</a> <a id="7681" href="SMT.Script.html#4964" class="Function">NameState</a> <a id="7691" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="7693" href="SMT.Script.html#1428" class="Generalizable">Γ′</a> <a id="7696" class="Symbol">(</a><a id="7697" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7702" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="7709" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7711" href="SMT.Script.html#2371" class="Function">OutputParsers</a> <a id="7725" href="SMT.Script.html#1542" class="Generalizable">Ξ</a><a id="7726" class="Symbol">)</a>
<a id="7728" href="SMT.Script.html#7651" class="Function">showScriptS</a> <a id="7740" href="SMT.Script.Base.html#6671" class="InductiveConstructor">[]</a> <a id="7743" class="Symbol">=</a> <a id="7745" class="Keyword">do</a>
  <a id="7750" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7757" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7759" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7762" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7764" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7767" href="SMT.Script.html#7651" class="Function">showScriptS</a> <a id="7779" class="Symbol">(</a><a id="7780" href="SMT.Script.html#7780" class="Bound">cmd</a> <a id="7784" href="SMT.Script.Base.html#6693" class="InductiveConstructor Operator">∷</a> <a id="7786" href="SMT.Script.html#7786" class="Bound">scr</a><a id="7789" class="Symbol">)</a> <a id="7791" class="Symbol">=</a> <a id="7793" class="Keyword">do</a>
  <a id="7798" class="Symbol">(</a><a id="7799" href="SMT.Script.html#7799" class="Bound">cmd</a> <a id="7803" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7805" href="SMT.Script.html#7805" class="Bound">ops₁</a><a id="7809" class="Symbol">)</a> <a id="7811" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7813" href="SMT.Script.html#6883" class="Function">showCommandS</a> <a id="7826" href="SMT.Script.html#7780" class="Bound">cmd</a>
  <a id="7832" class="Symbol">(</a><a id="7833" href="SMT.Script.html#7833" class="Bound">scr</a> <a id="7837" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7839" href="SMT.Script.html#7839" class="Bound">ops₂</a><a id="7843" class="Symbol">)</a> <a id="7845" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7847" href="SMT.Script.html#7651" class="Function">showScriptS</a> <a id="7859" href="SMT.Script.html#7786" class="Bound">scr</a>
  <a id="7865" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7872" href="Function.Base.html#1577" class="Function Operator">$</a> <a id="7874" href="SMT.Script.html#7799" class="Bound">cmd</a> <a id="7878" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7880" href="SMT.Script.html#7833" class="Bound">scr</a> <a id="7884" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7886" href="Data.Environment.html#1225" class="Function">Env.append</a> <a id="7897" href="Function.Base.html#615" class="Function">id</a> <a id="7900" href="SMT.Script.html#7839" class="Bound">ops₂</a> <a id="7905" href="SMT.Script.html#7805" class="Bound">ops₁</a>

<a id="7911" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
<a id="showScript"></a><a id="7994" href="SMT.Script.html#7994" class="Function">showScript</a> <a id="8005" class="Symbol">:</a> <a id="8007" href="SMT.Script.Base.html#6608" class="Datatype">Script</a> <a id="8014" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8017" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="8019" class="Symbol">(</a><a id="8020" href="SMT.Script.html#1517" class="Generalizable">ξ</a> <a id="8022" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8024" href="SMT.Script.html#1542" class="Generalizable">Ξ</a><a id="8025" class="Symbol">)</a> <a id="8027" class="Symbol">→</a> <a id="8029" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="8036" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8038" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="8041" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="8048" class="Symbol">(</a><a id="8049" href="SMT.Script.Base.html#4662" class="Datatype">Outputs</a> <a id="8057" class="Symbol">(</a><a id="8058" href="SMT.Script.html#1517" class="Generalizable">ξ</a> <a id="8060" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8062" href="SMT.Script.html#1542" class="Generalizable">Ξ</a><a id="8063" class="Symbol">))</a> <a id="8066" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="8068" href="SMT.Script.html#7994" class="Function">showScript</a> <a id="8079" href="SMT.Script.html#8079" class="Bound">scr</a> <a id="8083" class="Symbol">=</a> <a id="8085" href="Data.Product.html#2435" class="Function">Prod.map</a> <a id="8094" href="Data.String.Base.html#2550" class="Function">String.unlines</a> <a id="8109" href="SMT.Script.html#4733" class="Function">mkOutputParsers⁺</a> <a id="8126" class="Symbol">(</a><a id="8127" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8133" class="Symbol">(</a><a id="8134" href="SMT.Script.html#7651" class="Function">showScriptS</a> <a id="8146" href="SMT.Script.html#8079" class="Bound">scr</a> <a id="8150" class="Symbol">(</a><a id="8151" href="SMT.Script.Names.html#2732" class="Function">x′es</a> <a id="8156" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8158" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="8160" class="Symbol">)))</a>

<a id="8165" class="Comment">-- |Get the variable parser for a script (for debugging purposes).</a>
<a id="getVarParser"></a><a id="8232" href="SMT.Script.html#8232" class="Function">getVarParser</a> <a id="8245" class="Symbol">:</a> <a id="8247" href="SMT.Script.Base.html#6608" class="Datatype">Script</a> <a id="8254" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8257" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="8259" href="SMT.Script.html#1542" class="Generalizable">Ξ</a> <a id="8261" class="Symbol">→</a> <a id="8263" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="8266" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="8273" class="Symbol">(</a><a id="8274" href="Data.Product.html#1788" class="Function">∃[</a> <a id="8277" href="SMT.Script.html#8277" class="Bound">σ</a> <a id="8279" href="Data.Product.html#1788" class="Function">]</a> <a id="8281" class="Symbol">(</a><a id="8282" href="SMT.Script.html#1426" class="Generalizable">Γ</a> <a id="8284" href="SMT.Script.Base.html#1090" class="Function Operator">∋</a> <a id="8286" href="SMT.Script.html#8277" class="Bound">σ</a><a id="8287" class="Symbol">))</a> <a id="8290" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="8292" href="SMT.Script.html#8232" class="Function">getVarParser</a> <a id="8305" href="SMT.Script.html#8305" class="Bound">scr</a> <a id="8309" class="Symbol">=</a> <a id="8311" href="SMT.Script.html#1991" class="Function">mkVarParser</a> <a id="8323" class="Symbol">(</a><a id="8324" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8330" class="Symbol">(</a><a id="8331" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8337" class="Symbol">(</a><a id="8338" href="SMT.Script.html#7651" class="Function">showScriptS</a> <a id="8350" href="SMT.Script.html#8305" class="Bound">scr</a> <a id="8354" class="Symbol">(</a><a id="8355" href="SMT.Script.Names.html#2732" class="Function">x′es</a> <a id="8360" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8362" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="8364" class="Symbol">))))</a>

<a id="8370" class="Comment">-- -}</a>
<a id="8376" class="Comment">-- -}</a>
<a id="8382" class="Comment">-- -}</a>
</pre></body></html>