<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="SMT.Theory.html" class="Module">SMT.Theory</a>

<a id="25" class="Keyword">module</a> <a id="32" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="43" class="Symbol">(</a><a id="44" href="SMT.Script.html#44" class="Bound">theory</a> <a id="51" class="Symbol">:</a> <a id="53" href="SMT.Theory.html#1606" class="Record">Theory</a><a id="59" class="Symbol">)</a> <a id="61" class="Keyword">where</a>

<a id="68" class="Keyword">open</a> <a id="73" class="Keyword">import</a> <a id="80" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="89" class="Symbol">as</a> <a id="92" class="Module">Fin</a> <a id="96" class="Keyword">using</a> <a id="102" class="Symbol">(</a><a id="103" href="Data.Fin.Base.html#1138" class="Datatype">Fin</a><a id="106" class="Symbol">;</a> <a id="108" href="Data.Fin.Base.html#1191" class="InductiveConstructor">suc</a><a id="111" class="Symbol">;</a> <a id="113" href="Data.Fin.Base.html#1160" class="InductiveConstructor">zero</a><a id="117" class="Symbol">)</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.List.html" class="Module">Data.List</a> <a id="141" class="Symbol">as</a> <a id="144" class="Module">List</a> <a id="149" class="Keyword">using</a> <a id="155" class="Symbol">(</a><a id="156" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="160" class="Symbol">;</a> <a id="162" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="165" class="Symbol">;</a> <a id="167" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="169" class="Symbol">;</a> <a id="171" href="Data.List.Base.html#1763" class="Function Operator">_++_</a><a id="175" class="Symbol">)</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="208" class="Symbol">as</a> <a id="211" class="Module">List⁺</a> <a id="217" class="Keyword">using</a> <a id="223" class="Symbol">(</a><a id="224" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a><a id="229" class="Symbol">;</a> <a id="231" href="Data.List.NonEmpty.html#1364" class="InductiveConstructor Operator">_∷_</a><a id="234" class="Symbol">)</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="Data.Product.html" class="Module">Data.Product</a> <a id="261" class="Symbol">as</a> <a id="264" class="Module">Prod</a> <a id="269" class="Keyword">using</a> <a id="275" class="Symbol">(</a><a id="276" href="Data.Product.html#1369" class="Function">∃</a><a id="277" class="Symbol">;</a> <a id="279" href="Data.Product.html#1788" class="Function">∃-syntax</a><a id="287" class="Symbol">;</a> <a id="289" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="292" class="Symbol">)</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="323" class="Keyword">using</a> <a id="329" class="Symbol">(</a><a id="330" href="Relation.Nullary.html#1508" class="Record">Dec</a><a id="333" class="Symbol">;</a> <a id="335" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a><a id="338" class="Symbol">;</a> <a id="340" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a><a id="342" class="Symbol">)</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="383" class="Keyword">using</a> <a id="389" class="Symbol">(</a><a id="390" href="Relation.Nullary.Decidable.Core.html#1365" class="Function">True</a><a id="394" class="Symbol">)</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="446" class="Keyword">using</a> <a id="452" class="Symbol">(</a><a id="453" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="456" class="Symbol">;</a> <a id="458" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="462" class="Symbol">)</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="SMT.Logics.html" class="Module">SMT.Logics</a>
<a id="487" class="Keyword">open</a> <a id="492" class="Keyword">import</a> <a id="499" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="516" class="Symbol">as</a> <a id="519" class="Module">Env</a> <a id="523" class="Keyword">using</a> <a id="529" class="Symbol">(</a><a id="530" href="Data.Environment.html#360" class="Datatype">Env</a><a id="533" class="Symbol">;</a> <a id="535" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="538" class="Symbol">;</a> <a id="540" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="542" class="Symbol">)</a>

<a id="545" class="Keyword">open</a> <a id="550" class="Keyword">import</a> <a id="557" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="605" class="Symbol">as</a> <a id="608" class="Module">StateCat</a> <a id="617" class="Keyword">using</a> <a id="623" class="Symbol">(</a><a id="624" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="638" class="Symbol">;</a> <a id="640" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="647" class="Symbol">)</a>
<a id="649" class="Keyword">open</a> <a id="654" class="Keyword">import</a> <a id="661" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="683" class="Symbol">as</a> <a id="686" class="Module">Stream</a> <a id="693" class="Keyword">using</a> <a id="699" class="Symbol">(</a><a id="700" href="Codata.Musical.Stream.html#674" class="Datatype">Stream</a><a id="706" class="Symbol">)</a>
<a id="708" class="Keyword">open</a> <a id="713" class="Keyword">import</a> <a id="720" href="Data.Char.html" class="Module">Data.Char</a> <a id="730" class="Symbol">as</a> <a id="733" class="Module">Char</a> <a id="738" class="Keyword">using</a> <a id="744" class="Symbol">(</a><a id="745" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="749" class="Symbol">)</a>
<a id="751" class="Keyword">open</a> <a id="756" class="Keyword">import</a> <a id="763" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="774" class="Symbol">as</a> <a id="777" class="Module">Maybe</a> <a id="783" class="Keyword">using</a> <a id="789" class="Symbol">(</a><a id="790" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="795" class="Symbol">;</a> <a id="797" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="801" class="Symbol">;</a> <a id="803" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="810" class="Symbol">)</a>
<a id="812" class="Keyword">open</a> <a id="817" class="Keyword">import</a> <a id="824" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="833" class="Symbol">as</a> <a id="836" class="Module">Nat</a> <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="848" class="Symbol">)</a>
<a id="850" class="Keyword">open</a> <a id="855" class="Keyword">import</a> <a id="862" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="876" class="Keyword">renaming</a> <a id="885" class="Symbol">(</a><a id="886" href="Data.Nat.Show.html#1076" class="Function">show</a> <a id="891" class="Symbol">to</a> <a id="Show.show"></a><a id="894" href="SMT.Script.html#894" class="Function">showℕ</a><a id="899" class="Symbol">)</a>
<a id="901" class="Keyword">open</a> <a id="906" class="Keyword">import</a> <a id="913" href="Data.Product.html" class="Module">Data.Product</a> <a id="926" class="Symbol">as</a> <a id="929" class="Module">Product</a> <a id="937" class="Keyword">using</a> <a id="943" class="Symbol">(</a><a id="944" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="947" class="Symbol">;</a> <a id="949" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="952" class="Symbol">;</a> <a id="954" href="Data.Product.html#2211" class="Function Operator">-,_</a><a id="957" class="Symbol">;</a> <a id="959" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="964" class="Symbol">;</a> <a id="966" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="971" class="Symbol">)</a>
<a id="973" class="Keyword">open</a> <a id="978" class="Keyword">import</a> <a id="985" href="Data.String.html" class="Module">Data.String</a> <a id="997" class="Symbol">as</a> <a id="1000" class="Module">String</a> <a id="1007" class="Keyword">using</a> <a id="1013" class="Symbol">(</a><a id="1014" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1020" class="Symbol">)</a>
<a id="1022" class="Keyword">open</a> <a id="1027" class="Keyword">import</a> <a id="1034" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1044" class="Symbol">as</a> <a id="1047" class="Module">Unit</a> <a id="1052" class="Keyword">using</a> <a id="1058" class="Symbol">(</a><a id="1059" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1060" class="Symbol">)</a>
<a id="1062" class="Keyword">open</a> <a id="1067" class="Keyword">import</a> <a id="1074" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1083" class="Symbol">as</a> <a id="1086" class="Module">Vec</a> <a id="1090" class="Keyword">using</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="1100" class="Symbol">)</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Function.html" class="Module">Function</a> <a id="1123" class="Keyword">using</a> <a id="1129" class="Symbol">(</a><a id="1130" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1133" class="Symbol">;</a> <a id="1135" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1138" class="Symbol">;</a> <a id="1140" href="Function.Base.html#636" class="Function">const</a><a id="1145" class="Symbol">;</a> <a id="1147" href="Function.Base.html#1554" class="Function">flip</a><a id="1151" class="Symbol">;</a> <a id="1153" href="Function.Base.html#615" class="Function">id</a><a id="1155" class="Symbol">)</a>
<a id="1157" class="Keyword">import</a> <a id="1164" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1194" class="Symbol">as</a> <a id="1197" class="Module">Identity</a>
<a id="1206" class="Keyword">open</a> <a id="1211" class="Keyword">import</a> <a id="1218" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="1237" class="Symbol">as</a> <a id="1240" class="Module">P</a> <a id="1242" class="Keyword">hiding</a> <a id="1249" class="Symbol">(</a><a id="1250" href="Text.Parser.String.html#3776" class="Function Operator">_&gt;&gt;=_</a><a id="1255" class="Symbol">)</a>
<a id="1257" class="Keyword">import</a> <a id="1264" href="Reflection.html" class="Module">Reflection</a> <a id="1275" class="Symbol">as</a> <a id="1278" class="Module">Rfl</a>

<a id="1283" class="Keyword">open</a> <a id="1288" href="SMT.Theory.html#1606" class="Module">Theory</a> <a id="1295" href="SMT.Script.html#44" class="Bound">theory</a>

<a id="1303" class="Keyword">open</a> <a id="1308" class="Keyword">import</a> <a id="1315" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1331" href="SMT.Theory.html#1638" class="Field">baseTheory</a> <a id="1342" class="Keyword">public</a>
<a id="1349" class="Keyword">open</a> <a id="1354" class="Keyword">import</a> <a id="1361" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1378" href="SMT.Theory.html#1638" class="Field">baseTheory</a>

<a id="1390" class="Keyword">private</a>
  <a id="1400" class="Keyword">variable</a>
    <a id="1413" href="SMT.Script.html#1413" class="Generalizable">σ</a> <a id="1415" href="SMT.Script.html#1415" class="Generalizable">σ′</a>    <a id="1421" class="Symbol">:</a> <a id="1423" href="SMT.Theory.html#885" class="Function">Sort</a>
    <a id="1432" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="1434" href="SMT.Script.html#1434" class="Generalizable">Γ′</a> <a id="1437" href="SMT.Script.html#1437" class="Generalizable">δΓ</a> <a id="1440" class="Symbol">:</a> <a id="1442" href="SMT.Script.Base.html#1014" class="Function">Ctxt</a>
    <a id="1451" href="SMT.Script.html#1451" class="Generalizable">Δ</a> <a id="1453" href="SMT.Script.html#1453" class="Generalizable">Δ′</a>    <a id="1459" class="Symbol">:</a> <a id="1461" href="SMT.Script.Base.html#1014" class="Function">Ctxt</a>
    <a id="1470" href="SMT.Script.html#1470" class="Generalizable">Σ</a>       <a id="1478" class="Symbol">:</a> <a id="1480" href="SMT.Theory.html#329" class="Record">Signature</a> <a id="1490" href="SMT.Script.html#1413" class="Generalizable">σ</a>
    <a id="1496" href="SMT.Script.html#1496" class="Generalizable">Σ′</a>      <a id="1504" class="Symbol">:</a> <a id="1506" href="SMT.Theory.html#329" class="Record">Signature</a> <a id="1516" href="SMT.Script.html#1415" class="Generalizable">σ′</a>
    <a id="1523" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="1525" href="SMT.Script.html#1525" class="Generalizable">ξ′</a>    <a id="1531" class="Symbol">:</a> <a id="1533" href="SMT.Script.Base.html#3367" class="Datatype">OutputType</a>
    <a id="1548" href="SMT.Script.html#1548" class="Generalizable">Ξ</a> <a id="1550" href="SMT.Script.html#1550" class="Generalizable">Ξ′</a> <a id="1553" href="SMT.Script.html#1553" class="Generalizable">δΞ</a> <a id="1556" class="Symbol">:</a> <a id="1558" href="SMT.Script.Base.html#3461" class="Function">OutputCtxt</a>


<a id="1571" class="Keyword">private</a>
  <a id="1581" class="Comment">-- |Create an S-expression from a list of strings.</a>
  <a id="1634" class="Comment">--</a>
  <a id="1639" class="Comment">-- @</a>
  <a id="1646" class="Comment">--   mkSTerm (&quot;*&quot; ∷ &quot;4&quot; ∷ &quot;5&quot;) ≡ &quot;(* 4 5)&quot;</a>
  <a id="1691" class="Comment">-- @</a>
  <a id="1698" class="Comment">--</a>
  <a id="mkSTerm"></a><a id="1703" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="1711" class="Symbol">:</a> <a id="1713" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1718" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="1725" class="Symbol">→</a> <a id="1727" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="1736" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="1744" class="Symbol">=</a> <a id="1746" href="Data.String.Base.html#2863" class="Function">String.parens</a> <a id="1760" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1762" href="Data.String.Base.html#2805" class="Function">String.unwords</a>


<a id="1779" class="Comment">-- * Variable parsers</a>

<a id="1802" class="Comment">-- |Environment of variable parsers.</a>
<a id="VarParsers"></a><a id="1839" href="SMT.Script.html#1839" class="Function">VarParsers</a> <a id="1850" class="Symbol">:</a> <a id="1852" href="SMT.Script.Base.html#1014" class="Function">Ctxt</a> <a id="1857" class="Symbol">→</a> <a id="1859" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1863" href="SMT.Script.html#1839" class="Function">VarParsers</a> <a id="1874" class="Symbol">=</a> <a id="1876" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="1880" class="Symbol">(λ</a> <a id="1883" href="SMT.Script.html#1883" class="Bound">σ</a> <a id="1885" href="SMT.Script.html#1885" class="Bound">Γ</a> <a id="1887" class="Symbol">→</a> <a id="1889" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1892" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="1899" class="Symbol">((</a><a id="1901" href="SMT.Script.html#1883" class="Bound">σ</a> <a id="1903" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1905" href="SMT.Script.html#1885" class="Bound">Γ</a><a id="1906" class="Symbol">)</a> <a id="1908" href="SMT.Script.Base.html#1199" class="Function Operator">∋</a> <a id="1910" href="SMT.Script.html#1883" class="Bound">σ</a><a id="1911" class="Symbol">)</a> <a id="1913" href="Relation.Unary.html#3359" class="Function">]</a><a id="1914" class="Symbol">)</a>

<a id="1917" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
<a id="mkVarParser"></a><a id="1997" href="SMT.Script.html#1997" class="Function">mkVarParser</a> <a id="2009" class="Symbol">:</a> <a id="2011" href="SMT.Script.html#1839" class="Function">VarParsers</a> <a id="2022" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="2024" class="Symbol">→</a> <a id="2026" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2029" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2036" class="Symbol">(</a><a id="2037" href="Data.Product.html#1788" class="Function">∃[</a> <a id="2040" href="SMT.Script.html#2040" class="Bound">σ</a> <a id="2042" href="Data.Product.html#1788" class="Function">]</a> <a id="2044" class="Symbol">(</a><a id="2045" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="2047" href="SMT.Script.Base.html#1199" class="Function Operator">∋</a> <a id="2049" href="SMT.Script.html#2040" class="Bound">σ</a><a id="2050" class="Symbol">))</a> <a id="2053" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2055" href="SMT.Script.html#1997" class="Function">mkVarParser</a> <a id="2067" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="2081" class="Symbol">=</a> <a id="2083" href="Text.Parser.String.html#4819" class="Function">fail</a>
<a id="2088" href="SMT.Script.html#1997" class="Function">mkVarParser</a> <a id="2100" class="Symbol">(</a><a id="2101" href="SMT.Script.html#2101" class="Bound">p</a> <a id="2103" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="2105" href="SMT.Script.html#2105" class="Bound">env</a><a id="2108" class="Symbol">)</a> <a id="2110" class="Symbol">{</a><a id="2111" href="SMT.Script.html#2111" class="Bound">x</a><a id="2112" class="Symbol">}</a> <a id="2114" class="Symbol">=</a> <a id="2116" class="Symbol">(</a><a id="2117" href="Data.Product.html#2211" class="Function Operator">-,_</a> <a id="2121" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="2125" href="SMT.Script.html#2101" class="Bound">p</a> <a id="2127" class="Symbol">{</a><a id="2128" href="SMT.Script.html#2111" class="Bound">x</a><a id="2129" class="Symbol">})</a> <a id="2132" href="Text.Parser.String.html#4892" class="Function Operator">&lt;|&gt;</a> <a id="2136" class="Symbol">(</a><a id="2137" href="Data.Product.html#2450" class="Function">Prod.map</a> <a id="2146" href="Function.Base.html#615" class="Function">id</a> <a id="2149" href="SMT.Script.Base.html#2314" class="Function">extendVar</a> <a id="2159" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="2163" href="SMT.Script.html#1997" class="Function">mkVarParser</a> <a id="2175" href="SMT.Script.html#2105" class="Bound">env</a> <a id="2179" class="Symbol">{</a><a id="2180" href="SMT.Script.html#2111" class="Bound">x</a><a id="2181" class="Symbol">})</a>


<a id="2186" class="Comment">-- * Output parsers</a>

<a id="2207" class="Comment">-- |Mapping from output types to parser types.</a>
<a id="OutputParser"></a><a id="2254" href="SMT.Script.html#2254" class="Function">OutputParser</a> <a id="2267" class="Symbol">:</a> <a id="2269" href="SMT.Script.Base.html#3367" class="Datatype">OutputType</a> <a id="2280" class="Symbol">→</a> <a id="2282" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2286" href="SMT.Script.html#2254" class="Function">OutputParser</a> <a id="2299" href="SMT.Script.html#2299" class="Bound">ξ</a> <a id="2301" class="Symbol">=</a> <a id="2303" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2306" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2313" class="Symbol">(</a><a id="2314" href="SMT.Script.Base.html#4430" class="Function">Output</a> <a id="2321" href="SMT.Script.html#2299" class="Bound">ξ</a><a id="2322" class="Symbol">)</a> <a id="2324" href="Relation.Unary.html#3359" class="Function">]</a>

<a id="2327" class="Comment">-- |Mapping from output contexts to parser types.</a>
<a id="OutputParsers"></a><a id="2377" href="SMT.Script.html#2377" class="Function">OutputParsers</a> <a id="2391" class="Symbol">:</a> <a id="2393" href="SMT.Script.Base.html#3461" class="Function">OutputCtxt</a> <a id="2404" class="Symbol">→</a> <a id="2406" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2410" href="SMT.Script.html#2377" class="Function">OutputParsers</a> <a id="2424" href="SMT.Script.html#2424" class="Bound">Ξ</a> <a id="2426" class="Symbol">=</a> <a id="2428" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2432" class="Symbol">(λ</a> <a id="2435" href="SMT.Script.html#2435" class="Bound">ξ</a> <a id="2437" href="SMT.Script.html#2437" class="Bound Operator">_Ξ</a> <a id="2440" class="Symbol">→</a> <a id="2442" href="SMT.Script.html#2254" class="Function">OutputParser</a> <a id="2455" href="SMT.Script.html#2435" class="Bound">ξ</a><a id="2456" class="Symbol">)</a> <a id="2458" href="SMT.Script.html#2424" class="Bound">Ξ</a>

<a id="2461" class="Comment">-- |Parse a satisfiability result.</a>
<a id="pSat"></a><a id="2496" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="2501" class="Symbol">:</a> <a id="2503" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2506" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2513" href="SMT.Script.Base.html#3612" class="Datatype">Sat</a> <a id="2517" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2519" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="2524" class="Symbol">=</a> <a id="2526" href="SMT.Script.Base.html#3630" class="InductiveConstructor">sat</a>     <a id="2534" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="2537" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2544" class="String">&quot;sat&quot;</a>
   <a id="2553" href="Text.Parser.String.html#4892" class="Function Operator">&lt;|&gt;</a> <a id="2557" href="SMT.Script.Base.html#3646" class="InductiveConstructor">unsat</a>   <a id="2565" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="2568" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2575" class="String">&quot;unsat&quot;</a>
   <a id="2586" href="Text.Parser.String.html#4892" class="Function Operator">&lt;|&gt;</a> <a id="2590" href="SMT.Script.Base.html#3662" class="InductiveConstructor">unknown</a> <a id="2598" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="2601" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="2608" class="String">&quot;unknown&quot;</a>

<a id="2619" href="SMT.Script.html#2619" class="Function">_</a> <a id="2621" class="Symbol">:</a> <a id="2623" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="2628" href="Text.Parser.String.html#7777" class="Function Operator">parses</a> <a id="2635" class="String">&quot;sat&quot;</a>
<a id="2641" class="Symbol">_</a> <a id="2643" class="Symbol">=</a> <a id="2645" href="Text.Parser.String.html#7385" class="InductiveConstructor Operator">!</a> <a id="2647" href="SMT.Script.Base.html#3630" class="InductiveConstructor">sat</a>

<a id="2652" href="SMT.Script.html#2652" class="Function">_</a> <a id="2654" class="Symbol">:</a> <a id="2656" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="2661" href="Text.Parser.String.html#7777" class="Function Operator">parses</a> <a id="2668" class="String">&quot;unsat&quot;</a>
<a id="2676" class="Symbol">_</a> <a id="2678" class="Symbol">=</a> <a id="2680" href="Text.Parser.String.html#7385" class="InductiveConstructor Operator">!</a> <a id="2682" href="SMT.Script.Base.html#3646" class="InductiveConstructor">unsat</a>

<a id="2689" href="SMT.Script.html#2689" class="Function">_</a> <a id="2691" class="Symbol">:</a> <a id="2693" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="2698" href="Text.Parser.String.html#7777" class="Function Operator">parses</a> <a id="2705" class="String">&quot;unknown&quot;</a>
<a id="2715" class="Symbol">_</a> <a id="2717" class="Symbol">=</a> <a id="2719" href="Text.Parser.String.html#7385" class="InductiveConstructor Operator">!</a> <a id="2721" href="SMT.Script.Base.html#3662" class="InductiveConstructor">unknown</a>

<a id="2730" href="SMT.Script.html#2730" class="Function">_</a> <a id="2732" class="Symbol">:</a> <a id="2734" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="2739" href="Text.Parser.String.html#8209" class="Function Operator">rejects</a> <a id="2747" class="String">&quot;dogfood&quot;</a>
<a id="2757" class="Symbol">_</a> <a id="2759" class="Symbol">=</a> <a id="2761" class="Symbol">_</a>


<a id="2765" class="Comment">-- |Construct a definitions parser from a variable parser.</a>
<a id="2824" class="Comment">--</a>
<a id="2827" class="Comment">-- @</a>
<a id="2832" class="Comment">--   (define-fun x0 () Int (- 1))</a>
<a id="2866" class="Comment">-- @</a>
<a id="2871" class="Comment">--</a>
<a id="mkDefnParser"></a><a id="2874" href="SMT.Script.html#2874" class="Function">mkDefnParser</a> <a id="2887" class="Symbol">:</a> <a id="2889" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2892" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2899" class="Symbol">(</a><a id="2900" href="SMT.Script.Base.html#6986" class="Function">Var</a> <a id="2904" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="2905" class="Symbol">)</a> <a id="2907" href="Relation.Unary.html#3359" class="Function">]</a> <a id="2909" class="Symbol">→</a> <a id="2911" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2914" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="2921" class="Symbol">(</a><a id="2922" href="SMT.Script.Base.html#7061" class="Function">Defn</a> <a id="2927" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="2928" class="Symbol">)</a> <a id="2930" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="2932" href="SMT.Script.html#2874" class="Function">mkDefnParser</a> <a id="2945" class="Symbol">{</a><a id="2946" href="SMT.Script.html#2946" class="Bound">Γ</a><a id="2947" class="Symbol">}</a> <a id="2949" href="SMT.Script.html#2949" class="Bound">pVar</a> <a id="2954" class="Symbol">=</a> <a id="2956" href="Text.Parser.String.html#6027" class="Function">withSpaces</a> <a id="2967" class="Symbol">(</a><a id="2968" href="Text.Parser.String.html#3686" class="Function">guardM</a> <a id="2975" href="SMT.Script.html#3204" class="Function">checkDefn</a> <a id="2985" href="SMT.Script.html#3006" class="Function">pVarVal</a><a id="2992" class="Symbol">)</a>
  <a id="2996" class="Keyword">where</a>
    <a id="3006" href="SMT.Script.html#3006" class="Function">pVarVal</a> <a id="3014" class="Symbol">:</a> <a id="3016" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3019" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3026" class="Symbol">(</a><a id="3027" href="SMT.Script.Base.html#6986" class="Function">Var</a> <a id="3031" href="SMT.Script.html#2946" class="Bound">Γ</a> <a id="3033" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3035" href="SMT.Script.Base.html#7027" class="Function">Val</a><a id="3038" class="Symbol">)</a> <a id="3040" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="3046" href="SMT.Script.html#3006" class="Function">pVarVal</a> <a id="3054" class="Symbol">=</a>
      <a id="3062" href="Text.Parser.String.html#6422" class="Function">parens</a> <a id="3069" class="Symbol">(</a><a id="3070" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3074" class="Symbol">(</a><a id="3075" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="3082" class="String">&quot;define-fun&quot;</a> <a id="3095" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="3098" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3102" class="Symbol">(</a><a id="3103" href="SMT.Script.html#2949" class="Bound">pVar</a> <a id="3108" href="Text.Parser.String.html#3898" class="Function Operator">&lt;&amp;&gt;</a>
        <a id="3120" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3124" class="Symbol">(</a><a id="3125" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="3132" class="String">&quot;()&quot;</a> <a id="3137" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="3140" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3144" class="Symbol">(</a><a id="3145" href="SMT.Theory.html#1516" class="Function">parseSort</a> <a id="3155" href="Text.Parser.String.html#3776" class="Function Operator">P.&gt;&gt;=</a> <a id="3161" class="Symbol">λ</a> <a id="3163" href="SMT.Script.html#3163" class="Bound">σ</a> <a id="3165" class="Symbol">→</a> <a id="3167" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3171" class="Symbol">(</a><a id="3172" href="Data.Product.html#2211" class="Function Operator">-,_</a> <a id="3176" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="3180" href="SMT.Theory.html#1550" class="Function">parseValue</a> <a id="3191" href="SMT.Script.html#3163" class="Bound">σ</a><a id="3192" class="Symbol">))))))</a>

    <a id="3204" href="SMT.Script.html#3204" class="Function">checkDefn</a> <a id="3214" class="Symbol">:</a> <a id="3216" href="SMT.Script.Base.html#6986" class="Function">Var</a> <a id="3220" href="SMT.Script.html#2946" class="Bound">Γ</a> <a id="3222" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3224" href="SMT.Script.Base.html#7027" class="Function">Val</a> <a id="3228" class="Symbol">→</a> <a id="3230" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3236" class="Symbol">(</a><a id="3237" href="SMT.Script.Base.html#7061" class="Function">Defn</a> <a id="3242" href="SMT.Script.html#2946" class="Bound">Γ</a><a id="3243" class="Symbol">)</a>
    <a id="3249" href="SMT.Script.html#3204" class="Function">checkDefn</a> <a id="3259" class="Symbol">((</a><a id="3261" href="SMT.Script.html#3261" class="Bound">σ</a> <a id="3263" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3265" href="SMT.Script.html#3265" class="Bound">i</a><a id="3266" class="Symbol">)</a> <a id="3268" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3270" class="Symbol">(</a><a id="3271" href="SMT.Script.html#3271" class="Bound">σ′</a> <a id="3274" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3276" href="SMT.Script.html#3276" class="Bound">v</a><a id="3277" class="Symbol">))</a> <a id="3280" class="Keyword">with</a> <a id="3285" href="SMT.Script.html#3261" class="Bound">σ</a> <a id="3287" href="SMT.Theory.html#908" class="Function Operator">≟-Sort</a> <a id="3294" href="SMT.Script.html#3271" class="Bound">σ′</a>
    <a id="3301" class="Symbol">...</a> <a id="3305" class="Symbol">|</a> <a id="3307" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3311" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3316" class="Symbol">=</a> <a id="3318" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3323" class="Symbol">(</a><a id="3324" class="Bound">σ</a> <a id="3326" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3328" class="Bound">i</a> <a id="3330" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3332" class="Bound">v</a><a id="3333" class="Symbol">)</a>
    <a id="3339" class="Symbol">...</a> <a id="3343" class="Symbol">|</a> <a id="3345" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="3349" class="Symbol">_</a>    <a id="3354" class="Symbol">=</a> <a id="3356" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


<a id="3366" class="Comment">-- |Construct a definition-list parser from a variable parser.</a>
<a id="mkDefnsParser"></a><a id="3429" href="SMT.Script.html#3429" class="Function">mkDefnsParser</a> <a id="3443" class="Symbol">:</a> <a id="3445" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3448" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3455" class="Symbol">(</a><a id="3456" href="SMT.Script.Base.html#6986" class="Function">Var</a> <a id="3460" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="3461" class="Symbol">)</a> <a id="3463" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3465" class="Symbol">→</a> <a id="3467" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3470" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="3477" class="Symbol">(</a><a id="3478" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="3484" class="Symbol">(</a><a id="3485" href="SMT.Script.Base.html#7061" class="Function">Defn</a> <a id="3490" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="3491" class="Symbol">))</a> <a id="3494" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3496" href="SMT.Script.html#3429" class="Function">mkDefnsParser</a> <a id="3510" class="Symbol">{</a><a id="3511" href="SMT.Script.html#3511" class="Bound">Γ</a><a id="3512" class="Symbol">}</a> <a id="3514" href="SMT.Script.html#3514" class="Bound">pVar</a> <a id="3519" class="Symbol">=</a>
  <a id="3523" href="Text.Parser.String.html#6027" class="Function">withSpaces</a> <a id="3534" class="Symbol">(</a><a id="3535" href="Text.Parser.String.html#6422" class="Function">parens</a> <a id="3542" class="Symbol">(</a><a id="3543" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3547" class="Symbol">(</a><a id="3548" href="Text.Parser.String.html#6114" class="Function">lexeme</a> <a id="3555" class="String">&quot;model&quot;</a> <a id="3563" href="Text.Parser.String.html#4069" class="Function Operator">&amp;&gt;</a> <a id="3566" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="3570" class="Symbol">(</a><a id="3571" href="Text.Parser.String.html#5425" class="Function">list⁺</a> <a id="3577" class="Symbol">(</a><a id="3578" href="SMT.Script.html#2874" class="Function">mkDefnParser</a> <a id="3591" class="Symbol">{</a><a id="3592" href="SMT.Script.html#3511" class="Bound">Γ</a><a id="3593" class="Symbol">}</a> <a id="3595" href="SMT.Script.html#3514" class="Bound">pVar</a><a id="3599" class="Symbol">)))))</a>


<a id="3607" class="Keyword">private</a>
  <a id="MaybeModel"></a><a id="3617" href="SMT.Script.html#3617" class="Function">MaybeModel</a> <a id="3628" class="Symbol">:</a> <a id="3630" href="SMT.Script.Base.html#1014" class="Function">Ctxt</a> <a id="3635" class="Symbol">→</a> <a id="3637" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="3643" href="SMT.Script.html#3617" class="Function">MaybeModel</a> <a id="3654" href="SMT.Script.html#3654" class="Bound">Γ</a> <a id="3656" class="Symbol">=</a> <a id="3658" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="3662" class="Symbol">(λ</a> <a id="3665" href="SMT.Script.html#3665" class="Bound">σ</a> <a id="3667" href="SMT.Script.html#3667" class="Bound Operator">_Γ</a> <a id="3670" class="Symbol">→</a> <a id="3672" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3677" class="Symbol">(</a><a id="3678" href="SMT.Theory.html#980" class="Function">Value</a> <a id="3684" href="SMT.Script.html#3665" class="Bound">σ</a><a id="3685" class="Symbol">))</a> <a id="3688" href="SMT.Script.html#3654" class="Bound">Γ</a>

  <a id="insertMM"></a><a id="3693" href="SMT.Script.html#3693" class="Function">insertMM</a> <a id="3702" class="Symbol">:</a> <a id="3704" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3707" href="SMT.Script.html#3707" class="Bound">σ</a> <a id="3709" href="Data.Product.html#1788" class="Function">]</a> <a id="3711" class="Symbol">(</a><a id="3712" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="3714" href="SMT.Script.Base.html#1199" class="Function Operator">∋</a> <a id="3716" href="SMT.Script.html#3707" class="Bound">σ</a> <a id="3718" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3720" href="SMT.Theory.html#980" class="Function">Value</a> <a id="3726" href="SMT.Script.html#3707" class="Bound">σ</a><a id="3727" class="Symbol">)</a> <a id="3729" class="Symbol">→</a> <a id="3731" href="SMT.Script.html#3617" class="Function">MaybeModel</a> <a id="3742" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="3744" class="Symbol">→</a> <a id="3746" href="SMT.Script.html#3617" class="Function">MaybeModel</a> <a id="3757" href="SMT.Script.html#1432" class="Generalizable">Γ</a>
  <a id="3761" href="SMT.Script.html#3693" class="Function">insertMM</a> <a id="3770" class="Symbol">{</a><a id="3771" class="DottedPattern Symbol">.</a><a id="3772" class="DottedPattern">σ</a> <a id="3774" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3776" href="SMT.Script.html#3776" class="Bound">Γ</a><a id="3777" class="Symbol">}</a> <a id="3779" class="Symbol">(</a><a id="3780" href="SMT.Script.html#3780" class="Bound">σ</a> <a id="3782" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3784" class="Symbol">(</a><a id="3785" href="Data.Fin.Base.html#1160" class="InductiveConstructor">Fin.zero</a>  <a id="3795" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3797" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="3801" class="Symbol">)</a> <a id="3803" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3805" href="SMT.Script.html#3805" class="Bound">v</a><a id="3806" class="Symbol">)</a> <a id="3808" class="Symbol">(</a><a id="3809" href="SMT.Script.html#3809" class="Bound">vs</a> <a id="3812" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3814" href="SMT.Script.html#3814" class="Bound">env</a><a id="3817" class="Symbol">)</a> <a id="3819" class="Symbol">=</a> <a id="3821" class="Symbol">(</a><a id="3822" href="SMT.Script.html#3805" class="Bound">v</a> <a id="3824" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3826" href="SMT.Script.html#3809" class="Bound">vs</a><a id="3828" class="Symbol">)</a> <a id="3830" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3832" href="SMT.Script.html#3814" class="Bound">env</a>
  <a id="3838" href="SMT.Script.html#3693" class="Function">insertMM</a> <a id="3847" class="Symbol">{</a><a id="3848" href="SMT.Script.html#3848" class="Bound">σ′</a> <a id="3851" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3853" href="SMT.Script.html#3853" class="Bound">Γ</a><a id="3854" class="Symbol">}</a> <a id="3856" class="Symbol">(</a><a id="3857" href="SMT.Script.html#3857" class="Bound">σ</a> <a id="3859" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3861" class="Symbol">(</a><a id="3862" href="Data.Fin.Base.html#1191" class="InductiveConstructor">Fin.suc</a> <a id="3870" href="SMT.Script.html#3870" class="Bound">i</a> <a id="3872" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3874" href="SMT.Script.html#3874" class="Bound">p</a><a id="3875" class="Symbol">)</a>    <a id="3880" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3882" href="SMT.Script.html#3882" class="Bound">v</a><a id="3883" class="Symbol">)</a> <a id="3885" class="Symbol">(</a><a id="3886" href="SMT.Script.html#3886" class="Bound">vs</a> <a id="3889" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3891" href="SMT.Script.html#3891" class="Bound">env</a><a id="3894" class="Symbol">)</a> <a id="3896" class="Symbol">=</a> <a id="3898" href="SMT.Script.html#3886" class="Bound">vs</a> <a id="3901" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="3903" href="SMT.Script.html#3693" class="Function">insertMM</a> <a id="3912" class="Symbol">(</a><a id="3913" href="SMT.Script.html#3857" class="Bound">σ</a> <a id="3915" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3917" class="Symbol">(</a><a id="3918" href="SMT.Script.html#3870" class="Bound">i</a> <a id="3920" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3922" href="SMT.Script.html#3874" class="Bound">p</a><a id="3923" class="Symbol">)</a> <a id="3925" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3927" href="SMT.Script.html#3882" class="Bound">v</a><a id="3928" class="Symbol">)</a> <a id="3930" href="SMT.Script.html#3891" class="Bound">env</a>

  <a id="mkMM"></a><a id="3937" href="SMT.Script.html#3937" class="Function">mkMM</a> <a id="3942" class="Symbol">:</a> <a id="3944" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3949" class="Symbol">(</a><a id="3950" href="SMT.Script.Base.html#7061" class="Function">Defn</a> <a id="3955" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="3956" class="Symbol">)</a> <a id="3958" class="Symbol">→</a> <a id="3960" href="SMT.Script.html#3617" class="Function">MaybeModel</a> <a id="3971" href="SMT.Script.html#1432" class="Generalizable">Γ</a>
  <a id="3975" href="SMT.Script.html#3937" class="Function">mkMM</a> <a id="3980" class="Symbol">{</a><a id="3981" href="SMT.Script.html#3981" class="Bound">Γ</a><a id="3982" class="Symbol">}</a> <a id="3984" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="3993" class="Symbol">=</a> <a id="3995" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="4006" class="Symbol">(λ</a> <a id="4009" href="SMT.Script.html#4009" class="Bound Operator">_σ</a> <a id="4012" href="SMT.Script.html#4012" class="Bound Operator">_Γ</a> <a id="4015" class="Symbol">→</a> <a id="4017" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4019" class="Symbol">)</a> <a id="4021" href="SMT.Script.html#3981" class="Bound">Γ</a>
  <a id="4025" href="SMT.Script.html#3937" class="Function">mkMM</a> <a id="4030" class="Symbol">{</a><a id="4031" href="SMT.Script.html#4031" class="Bound">Γ</a><a id="4032" class="Symbol">}</a> <a id="4034" class="Symbol">(</a><a id="4035" href="SMT.Script.html#4035" class="Bound">v</a> <a id="4037" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4039" href="SMT.Script.html#4039" class="Bound">vs</a><a id="4041" class="Symbol">)</a> <a id="4043" class="Symbol">=</a> <a id="4045" href="SMT.Script.html#3693" class="Function">insertMM</a> <a id="4054" href="SMT.Script.html#4035" class="Bound">v</a> <a id="4056" class="Symbol">(</a><a id="4057" href="SMT.Script.html#3937" class="Function">mkMM</a> <a id="4062" href="SMT.Script.html#4039" class="Bound">vs</a><a id="4064" class="Symbol">)</a>

  <a id="fromSingleton"></a><a id="4069" href="SMT.Script.html#4069" class="Function">fromSingleton</a> <a id="4083" class="Symbol">:</a> <a id="4085" class="Symbol">{</a><a id="4086" href="SMT.Script.html#4086" class="Bound">A</a> <a id="4088" class="Symbol">:</a> <a id="4090" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4093" class="Symbol">}</a> <a id="4095" class="Symbol">→</a> <a id="4097" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4102" href="SMT.Script.html#4086" class="Bound">A</a> <a id="4104" class="Symbol">→</a> <a id="4106" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4112" href="SMT.Script.html#4086" class="Bound">A</a>
  <a id="4116" href="SMT.Script.html#4069" class="Function">fromSingleton</a> <a id="4130" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4133" class="Symbol">=</a> <a id="4135" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
  <a id="4145" href="SMT.Script.html#4069" class="Function">fromSingleton</a> <a id="4159" class="Symbol">(</a><a id="4160" href="SMT.Script.html#4160" class="Bound">v</a> <a id="4162" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4164" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4166" class="Symbol">)</a> <a id="4168" class="Symbol">=</a> <a id="4170" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4175" href="SMT.Script.html#4160" class="Bound">v</a>
  <a id="4179" href="SMT.Script.html#4069" class="Function">fromSingleton</a> <a id="4193" class="Symbol">(_</a> <a id="4196" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4198" class="Symbol">_</a> <a id="4200" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4202" class="Symbol">_)</a> <a id="4205" class="Symbol">=</a> <a id="4207" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

  <a id="checkMM"></a><a id="4218" href="SMT.Script.html#4218" class="Function">checkMM</a> <a id="4226" class="Symbol">:</a> <a id="4228" href="SMT.Script.html#3617" class="Function">MaybeModel</a> <a id="4239" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="4241" class="Symbol">→</a> <a id="4243" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4249" class="Symbol">(</a><a id="4250" href="SMT.Script.Base.html#4311" class="Datatype">Model</a> <a id="4256" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="4257" class="Symbol">)</a>
  <a id="4261" href="SMT.Script.html#4218" class="Function">checkMM</a> <a id="4269" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="4272" class="Symbol">=</a> <a id="4274" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4279" href="SMT.Script.Base.html#4344" class="InductiveConstructor">[]</a>
  <a id="4284" href="SMT.Script.html#4218" class="Function">checkMM</a> <a id="4292" class="Symbol">(</a><a id="4293" href="SMT.Script.html#4293" class="Bound">vs</a> <a id="4296" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4298" href="SMT.Script.html#4298" class="Bound">env</a><a id="4301" class="Symbol">)</a> <a id="4303" class="Symbol">=</a> <a id="4305" href="Data.Maybe.Base.html#2766" class="Function">Maybe.zipWith</a> <a id="4319" href="SMT.Script.Base.html#4361" class="InductiveConstructor Operator">_∷_</a> <a id="4323" class="Symbol">(</a><a id="4324" href="SMT.Script.html#4069" class="Function">fromSingleton</a> <a id="4338" href="SMT.Script.html#4293" class="Bound">vs</a><a id="4340" class="Symbol">)</a> <a id="4342" class="Symbol">(</a><a id="4343" href="SMT.Script.html#4218" class="Function">checkMM</a> <a id="4351" href="SMT.Script.html#4298" class="Bound">env</a><a id="4354" class="Symbol">)</a>


<a id="4358" class="Comment">-- |Construct a model parser from a variable parser.</a>
<a id="mkModelParser"></a><a id="4411" href="SMT.Script.html#4411" class="Function">mkModelParser</a> <a id="4425" class="Symbol">:</a> <a id="4427" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4430" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4437" class="Symbol">(</a><a id="4438" href="SMT.Script.Base.html#6986" class="Function">Var</a> <a id="4442" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="4443" class="Symbol">)</a> <a id="4445" href="Relation.Unary.html#3359" class="Function">]</a> <a id="4447" class="Symbol">→</a> <a id="4449" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4452" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4459" class="Symbol">(</a><a id="4460" href="SMT.Script.Base.html#4311" class="Datatype">Model</a> <a id="4466" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="4467" class="Symbol">)</a> <a id="4469" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="4471" href="SMT.Script.html#4411" class="Function">mkModelParser</a> <a id="4485" class="Symbol">{</a><a id="4486" href="SMT.Script.html#4486" class="Bound">Γ</a><a id="4487" class="Symbol">}</a> <a id="4489" href="SMT.Script.html#4489" class="Bound">pVar</a> <a id="4494" class="Symbol">=</a> <a id="4496" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="4501" href="Text.Parser.String.html#3776" class="Function Operator">P.&gt;&gt;=</a> <a id="4507" class="Symbol">λ</a> <a id="4509" class="Symbol">{</a> <a id="4511" href="SMT.Script.Base.html#3630" class="InductiveConstructor">sat</a> <a id="4515" class="Symbol">→</a> <a id="4517" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="4521" href="SMT.Script.html#4630" class="Function">pModel</a> <a id="4528" class="Symbol">;</a> <a id="4530" class="CatchallClause Symbol">_</a> <a id="4532" class="Symbol">→</a> <a id="4534" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="4538" href="Text.Parser.String.html#4819" class="Function">fail</a> <a id="4543" class="Symbol">}</a>
  <a id="4547" class="Keyword">where</a>
    <a id="4557" class="Comment">-- Insert each definition into a model, and check if it is complete.</a>
    <a id="4630" href="SMT.Script.html#4630" class="Function">pModel</a> <a id="4637" class="Symbol">:</a> <a id="4639" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4642" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4649" class="Symbol">(</a><a id="4650" href="SMT.Script.Base.html#4311" class="Datatype">Model</a> <a id="4656" href="SMT.Script.html#4486" class="Bound">Γ</a><a id="4657" class="Symbol">)</a> <a id="4659" href="Relation.Unary.html#3359" class="Function">]</a>
    <a id="4665" href="SMT.Script.html#4630" class="Function">pModel</a> <a id="4672" class="Symbol">=</a> <a id="4674" href="Text.Parser.String.html#3686" class="Function">guardM</a> <a id="4681" href="SMT.Script.html#4218" class="Function">checkMM</a> <a id="4689" class="Symbol">(</a><a id="4690" href="SMT.Script.html#3937" class="Function">mkMM</a> <a id="4695" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="4697" href="Data.List.NonEmpty.html#1760" class="Function">List⁺.toList</a> <a id="4710" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="4714" href="SMT.Script.html#3429" class="Function">mkDefnsParser</a> <a id="4728" class="Symbol">{</a><a id="4729" href="SMT.Script.html#4486" class="Bound">Γ</a><a id="4730" class="Symbol">}</a> <a id="4732" href="SMT.Script.html#4489" class="Bound">pVar</a><a id="4736" class="Symbol">)</a>

<a id="mkOutputParsers⁺"></a><a id="4739" href="SMT.Script.html#4739" class="Function">mkOutputParsers⁺</a> <a id="4756" class="Symbol">:</a> <a id="4758" href="SMT.Script.html#2377" class="Function">OutputParsers</a> <a id="4772" class="Symbol">(</a><a id="4773" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="4775" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4777" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="4778" class="Symbol">)</a> <a id="4780" class="Symbol">→</a> <a id="4782" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4785" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="4792" class="Symbol">(</a><a id="4793" href="SMT.Script.Base.html#4819" class="Datatype">Outputs</a> <a id="4801" class="Symbol">(</a><a id="4802" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="4804" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4806" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="4807" class="Symbol">))</a> <a id="4810" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="4812" href="SMT.Script.html#4739" class="Function">mkOutputParsers⁺</a> <a id="4829" class="Symbol">(</a><a id="4830" href="SMT.Script.html#4830" class="Bound">op</a> <a id="4833" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4835" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="4837" class="Symbol">)</a>          <a id="4848" class="Symbol">=</a> <a id="4850" class="Symbol">(</a><a id="4851" href="SMT.Script.Base.html#4879" class="InductiveConstructor Operator">_∷</a> <a id="4854" href="SMT.Script.Base.html#4860" class="InductiveConstructor">[]</a><a id="4856" class="Symbol">)</a> <a id="4858" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="4862" href="SMT.Script.html#4830" class="Bound">op</a>
<a id="4865" href="SMT.Script.html#4739" class="Function">mkOutputParsers⁺</a> <a id="4882" class="Symbol">(</a><a id="4883" href="SMT.Script.html#4883" class="Bound">op</a> <a id="4886" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4888" href="SMT.Script.html#4888" class="Bound">ops</a><a id="4891" class="Symbol">@(_</a> <a id="4895" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4897" class="Symbol">_))</a> <a id="4901" class="Symbol">=</a> <a id="4903" href="Function.Base.html#1554" class="Function">flip</a> <a id="4908" href="SMT.Script.Base.html#4879" class="InductiveConstructor Operator">_∷_</a> <a id="4912" href="Text.Parser.String.html#4990" class="Function Operator">&lt;$&gt;</a> <a id="4916" href="SMT.Script.html#4739" class="Function">mkOutputParsers⁺</a> <a id="4933" href="SMT.Script.html#4888" class="Bound">ops</a> <a id="4937" href="Text.Parser.String.html#5174" class="Function Operator">&lt;*&gt;</a> <a id="4941" href="Text.Parser.String.html#4752" class="Function">box</a> <a id="4945" href="SMT.Script.html#4883" class="Bound">op</a>


<a id="4950" class="Comment">-- * Name state monad</a>

<a id="NameState"></a><a id="4973" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="4983" class="Symbol">:</a> <a id="4985" class="Symbol">(</a><a id="4986" href="SMT.Script.html#4986" class="Bound">Γ</a> <a id="4988" href="SMT.Script.html#4988" class="Bound">Γ′</a> <a id="4991" class="Symbol">:</a> <a id="4993" href="SMT.Script.Base.html#1014" class="Function">Ctxt</a><a id="4997" class="Symbol">)</a> <a id="4999" class="Symbol">→</a> <a id="5001" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5005" class="Symbol">→</a> <a id="5007" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="5011" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="5021" href="SMT.Script.html#5021" class="Bound">Γ</a> <a id="5023" href="SMT.Script.html#5023" class="Bound">Γ′</a> <a id="5026" href="SMT.Script.html#5026" class="Bound">A</a> <a id="5028" class="Symbol">=</a> <a id="5030" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="5038" class="Symbol">(λ</a> <a id="5041" href="SMT.Script.html#5041" class="Bound">Γ</a> <a id="5043" class="Symbol">→</a> <a id="5045" href="SMT.Script.Names.html#2015" class="Record">Names</a> <a id="5051" href="SMT.Script.html#5041" class="Bound">Γ</a> <a id="5053" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5055" href="SMT.Script.html#1839" class="Function">VarParsers</a> <a id="5066" href="SMT.Script.html#5041" class="Bound">Γ</a><a id="5067" class="Symbol">)</a> <a id="5069" href="Function.Base.html#615" class="Function">id</a> <a id="5072" href="SMT.Script.html#5021" class="Bound">Γ</a> <a id="5074" href="SMT.Script.html#5023" class="Bound">Γ′</a> <a id="5077" href="SMT.Script.html#5026" class="Bound">A</a>

<a id="5080" class="Comment">-- When showing terms, we need to pass around a name state,</a>
<a id="5140" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
<a id="5205" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
<a id="5267" class="Keyword">private</a>
  <a id="monadStateNameState"></a><a id="5277" href="SMT.Script.html#5277" class="Function">monadStateNameState</a> <a id="5297" class="Symbol">=</a>
    <a id="5303" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="5330" class="Symbol">(λ</a> <a id="5333" href="SMT.Script.html#5333" class="Bound">Γ</a> <a id="5335" class="Symbol">→</a> <a id="5337" href="SMT.Script.Names.html#2015" class="Record">Names</a> <a id="5343" href="SMT.Script.html#5333" class="Bound">Γ</a> <a id="5345" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5347" href="SMT.Script.html#1839" class="Function">VarParsers</a> <a id="5358" href="SMT.Script.html#5333" class="Bound">Γ</a><a id="5359" class="Symbol">)</a> <a id="5361" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

<a id="5377" class="Keyword">open</a> <a id="5382" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="5397" href="SMT.Script.html#5277" class="Function">monadStateNameState</a>
  <a id="5419" class="Keyword">using</a> <a id="5425" class="Symbol">(</a><a id="5426" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="5432" class="Symbol">;</a> <a id="5434" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="5439" class="Symbol">;</a> <a id="5441" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="5445" class="Symbol">;</a> <a id="5447" href="Category.Monad.State.html#2831" class="Field">put</a><a id="5450" class="Symbol">;</a> <a id="5452" href="Category.Monad.State.html#2799" class="Field">get</a><a id="5455" class="Symbol">;</a> <a id="5457" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="5463" class="Symbol">)</a>

<a id="freshNameS"></a><a id="5466" href="SMT.Script.html#5466" class="Function">freshNameS</a> <a id="5477" class="Symbol">:</a> <a id="5479" class="Symbol">(</a><a id="5480" href="SMT.Script.html#5480" class="Bound">σ</a> <a id="5482" class="Symbol">:</a> <a id="5484" href="SMT.Theory.html#885" class="Function">Sort</a><a id="5488" class="Symbol">)</a> <a id="5490" class="Symbol">→</a> <a id="5492" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="5502" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5504" class="Symbol">(</a><a id="5505" href="SMT.Script.html#5480" class="Bound">σ</a> <a id="5507" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5509" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="5510" class="Symbol">)</a> <a id="5512" href="SMT.Script.Names.html#1427" class="Function">Name</a>
<a id="5517" href="SMT.Script.html#5466" class="Function">freshNameS</a> <a id="5528" href="SMT.Script.html#5528" class="Bound">σ</a> <a id="5530" class="Symbol">=</a> <a id="5532" class="Keyword">do</a>
  <a id="5537" class="Symbol">(</a><a id="5538" href="SMT.Script.html#5538" class="Bound">ns</a> <a id="5541" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5543" href="SMT.Script.html#5543" class="Bound">vps</a><a id="5546" class="Symbol">)</a> <a id="5548" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5550" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5556" class="Keyword">let</a> <a id="5560" class="Symbol">(</a><a id="5561" href="SMT.Script.html#5561" class="Bound">n</a> <a id="5563" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5565" href="SMT.Script.html#5565" class="Bound">ns</a><a id="5567" class="Symbol">)</a> <a id="5569" class="Symbol">=</a> <a id="5571" href="SMT.Script.Names.html#2225" class="Function">freshName</a> <a id="5581" href="SMT.Script.html#5528" class="Bound">σ</a> <a id="5583" href="SMT.Script.html#5538" class="Bound">ns</a>
  <a id="5588" class="Keyword">let</a> <a id="5592" href="SMT.Script.html#5592" class="Bound">vps</a> <a id="5596" class="Symbol">=</a> <a id="5598" class="Symbol">((</a><a id="5600" href="Data.Fin.Base.html#1160" class="InductiveConstructor">Fin.zero</a> <a id="5609" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5611" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5615" class="Symbol">)</a> <a id="5617" href="Text.Parser.String.html#5086" class="Function Operator">&lt;$</a> <a id="5620" href="Text.Parser.String.html#6027" class="Function">withSpaces</a> <a id="5631" class="Symbol">(</a><a id="5632" href="Text.Parser.String.html#6327" class="Function">exacts</a> <a id="5639" href="SMT.Script.html#5561" class="Bound">n</a><a id="5640" class="Symbol">))</a> <a id="5643" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5645" href="SMT.Script.html#5543" class="Bound">vps</a>
  <a id="5651" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="5655" class="Symbol">(</a><a id="5656" href="SMT.Script.html#5565" class="Bound">ns</a> <a id="5659" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5661" href="SMT.Script.html#5592" class="Bound">vps</a><a id="5664" class="Symbol">)</a>
  <a id="5668" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5675" href="SMT.Script.html#5561" class="Bound">n</a>

<a id="dropNameS"></a><a id="5678" href="SMT.Script.html#5678" class="Function">dropNameS</a> <a id="5688" class="Symbol">:</a> <a id="5690" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="5700" class="Symbol">(</a><a id="5701" href="SMT.Script.html#1413" class="Generalizable">σ</a> <a id="5703" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5705" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="5706" class="Symbol">)</a> <a id="5708" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5710" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="5712" href="SMT.Script.html#5678" class="Function">dropNameS</a> <a id="5722" class="Symbol">=</a> <a id="5724" class="Keyword">do</a>
  <a id="5729" class="Symbol">(</a><a id="5730" href="SMT.Script.html#5730" class="Bound">ns</a> <a id="5733" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5735" class="Symbol">_</a> <a id="5737" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5739" href="SMT.Script.html#5739" class="Bound">vps</a><a id="5742" class="Symbol">)</a> <a id="5744" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5746" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5752" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="5756" class="Symbol">(</a><a id="5757" href="SMT.Script.Names.html#2513" class="Function">dropName</a> <a id="5766" href="SMT.Script.html#5730" class="Bound">ns</a> <a id="5769" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5771" href="SMT.Script.html#5739" class="Bound">vps</a><a id="5774" class="Symbol">)</a>
  <a id="5778" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5785" class="Symbol">_</a>

<a id="lookupNameS"></a><a id="5788" href="SMT.Script.html#5788" class="Function">lookupNameS</a> <a id="5800" class="Symbol">:</a> <a id="5802" class="Symbol">(</a><a id="5803" href="SMT.Script.html#5803" class="Bound">i</a> <a id="5805" class="Symbol">:</a> <a id="5807" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5809" href="SMT.Script.Base.html#1199" class="Function Operator">∋</a> <a id="5811" href="SMT.Script.html#1413" class="Generalizable">σ</a><a id="5812" class="Symbol">)</a> <a id="5814" class="Symbol">→</a> <a id="5816" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="5826" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5828" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="5830" href="SMT.Script.Names.html#1427" class="Function">Name</a>
<a id="5835" href="SMT.Script.html#5788" class="Function">lookupNameS</a> <a id="5847" class="Symbol">(</a><a id="5848" href="SMT.Script.html#5848" class="Bound">i</a> <a id="5850" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5852" href="SMT.Script.html#5852" class="Bound Operator">_p</a><a id="5854" class="Symbol">)</a> <a id="5856" class="Symbol">=</a> <a id="5858" class="Keyword">do</a>
  <a id="5863" class="Symbol">(</a><a id="5864" href="SMT.Script.html#5864" class="Bound">ns</a> <a id="5867" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5869" href="SMT.Script.html#5869" class="Bound Operator">_vps</a><a id="5873" class="Symbol">)</a> <a id="5875" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="5877" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="5883" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="5890" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5892" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="5903" class="Symbol">(</a><a id="5904" href="SMT.Script.Names.html#2056" class="Field">Names.nameEnv</a> <a id="5918" href="SMT.Script.html#5864" class="Bound">ns</a><a id="5920" class="Symbol">)</a> <a id="5922" href="SMT.Script.html#5848" class="Bound">i</a>


<a id="5926" class="Comment">-- * Printing functions</a>

<a id="5951" class="Keyword">mutual</a>

  <a id="5961" class="Comment">-- |Show a term as an S-expression.</a>
  <a id="showTermS"></a><a id="5999" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6009" class="Symbol">:</a> <a id="6011" href="SMT.Script.Base.html#1422" class="Datatype">Term</a> <a id="6016" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6018" href="SMT.Script.html#1413" class="Generalizable">σ</a> <a id="6020" class="Symbol">→</a> <a id="6022" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="6032" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6034" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6036" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="6045" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6055" class="Symbol">(</a><a id="6056" href="SMT.Script.Base.html#1467" class="InductiveConstructor">var</a> <a id="6060" href="SMT.Script.html#6060" class="Bound">i</a><a id="6061" class="Symbol">)</a> <a id="6063" class="Symbol">=</a> <a id="6065" class="Keyword">do</a>
    <a id="6072" href="SMT.Script.html#6072" class="Bound">n</a> <a id="6074" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6076" href="SMT.Script.html#5788" class="Function">lookupNameS</a> <a id="6088" href="SMT.Script.html#6060" class="Bound">i</a>
    <a id="6094" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6101" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6103" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6112" href="SMT.Script.html#6072" class="Bound">n</a>
  <a id="6116" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6126" class="Symbol">(</a><a id="6127" href="SMT.Script.Base.html#1509" class="InductiveConstructor">lit</a> <a id="6131" href="SMT.Script.html#6131" class="Bound">l</a><a id="6132" class="Symbol">)</a> <a id="6134" class="Symbol">=</a> <a id="6136" class="Keyword">do</a>
    <a id="6143" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6150" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6152" href="SMT.Theory.html#1296" class="Function">showLiteral</a> <a id="6164" href="SMT.Script.html#6131" class="Bound">l</a>
  <a id="6168" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6178" class="Symbol">(</a><a id="6179" href="SMT.Script.Base.html#1555" class="InductiveConstructor">app</a> <a id="6183" href="SMT.Script.html#6183" class="Bound">x</a> <a id="6185" href="SMT.Script.html#6185" class="Bound">xs</a><a id="6187" class="Symbol">)</a> <a id="6189" class="Symbol">=</a> <a id="6191" class="Keyword">do</a>
    <a id="6198" class="Keyword">let</a> <a id="6202" href="SMT.Script.html#6202" class="Bound">x</a> <a id="6204" class="Symbol">=</a> <a id="6206" href="SMT.Theory.html#1349" class="Function">showIdentifier</a> <a id="6221" href="SMT.Script.html#6183" class="Bound">x</a>
    <a id="6227" href="SMT.Script.html#6227" class="Bound">xs</a> <a id="6230" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6232" href="SMT.Script.html#6642" class="Function">showArgsS</a> <a id="6242" href="SMT.Script.html#6185" class="Bound">xs</a>
    <a id="6249" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6256" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6258" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="6266" class="Symbol">(</a><a id="6267" href="SMT.Script.html#6202" class="Bound">x</a> <a id="6269" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6271" href="SMT.Script.html#6227" class="Bound">xs</a><a id="6273" class="Symbol">)</a>
  <a id="6277" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6287" class="Symbol">(</a><a id="6288" href="SMT.Script.Base.html#1649" class="InductiveConstructor">forAll</a> <a id="6295" href="SMT.Script.html#6295" class="Bound">σ</a> <a id="6297" href="SMT.Script.html#6297" class="Bound">x</a><a id="6298" class="Symbol">)</a> <a id="6300" class="Symbol">=</a> <a id="6302" class="Keyword">do</a>
    <a id="6309" href="SMT.Script.html#6309" class="Bound">n</a> <a id="6311" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6313" href="SMT.Script.html#5466" class="Function">freshNameS</a> <a id="6324" href="SMT.Script.html#6295" class="Bound">σ</a>
    <a id="6330" href="SMT.Script.html#6330" class="Bound">x</a> <a id="6332" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6334" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6344" href="SMT.Script.html#6297" class="Bound">x</a>
    <a id="6350" href="SMT.Script.html#5678" class="Function">dropNameS</a>
    <a id="6364" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6371" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6373" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="6381" class="Symbol">(</a><a id="6382" class="String">&quot;forall&quot;</a> <a id="6391" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6393" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="6401" class="Symbol">(</a><a id="6402" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="6410" class="Symbol">(</a><a id="6411" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6420" href="SMT.Script.html#6309" class="Bound">n</a> <a id="6422" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6424" href="SMT.Theory.html#1261" class="Function">showSort</a> <a id="6433" href="SMT.Script.html#6295" class="Bound">σ</a> <a id="6435" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6437" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6439" class="Symbol">)</a> <a id="6441" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6443" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6445" class="Symbol">)</a> <a id="6447" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6449" href="SMT.Script.html#6330" class="Bound">x</a> <a id="6451" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6453" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6455" class="Symbol">)</a>
  <a id="6459" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6469" class="Symbol">(</a><a id="6470" href="SMT.Script.Base.html#1713" class="InductiveConstructor">exists</a> <a id="6477" href="SMT.Script.html#6477" class="Bound">σ</a> <a id="6479" href="SMT.Script.html#6479" class="Bound">x</a><a id="6480" class="Symbol">)</a> <a id="6482" class="Symbol">=</a> <a id="6484" class="Keyword">do</a>
    <a id="6491" href="SMT.Script.html#6491" class="Bound">n</a> <a id="6493" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6495" href="SMT.Script.html#5466" class="Function">freshNameS</a> <a id="6506" href="SMT.Script.html#6477" class="Bound">σ</a>
    <a id="6512" href="SMT.Script.html#6512" class="Bound">x</a> <a id="6514" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6516" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6526" href="SMT.Script.html#6479" class="Bound">x</a>
    <a id="6532" href="SMT.Script.html#5678" class="Function">dropNameS</a>
    <a id="6546" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6553" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6555" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="6563" class="Symbol">(</a><a id="6564" class="String">&quot;exists&quot;</a> <a id="6573" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6575" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="6583" class="Symbol">(</a><a id="6584" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="6592" class="Symbol">(</a><a id="6593" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="6602" href="SMT.Script.html#6491" class="Bound">n</a> <a id="6604" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6606" href="SMT.Theory.html#1261" class="Function">showSort</a> <a id="6615" href="SMT.Script.html#6477" class="Bound">σ</a> <a id="6617" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6619" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6621" class="Symbol">)</a> <a id="6623" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6625" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6627" class="Symbol">)</a> <a id="6629" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6631" href="SMT.Script.html#6512" class="Bound">x</a> <a id="6633" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6635" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="6637" class="Symbol">)</a>

  <a id="showArgsS"></a><a id="6642" href="SMT.Script.html#6642" class="Function">showArgsS</a> <a id="6652" class="Symbol">:</a> <a id="6654" href="SMT.Script.Base.html#1776" class="Function">Args</a> <a id="6659" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6661" href="SMT.Script.html#1451" class="Generalizable">Δ</a> <a id="6663" class="Symbol">→</a> <a id="6665" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="6675" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6677" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6679" class="Symbol">(</a><a id="6680" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6685" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="6691" class="Symbol">)</a>
  <a id="6695" href="SMT.Script.html#6642" class="Function">showArgsS</a> <a id="6705" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>       <a id="6714" class="Symbol">=</a> <a id="6716" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6723" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="6728" href="SMT.Script.html#6642" class="Function">showArgsS</a> <a id="6738" class="Symbol">(</a><a id="6739" href="SMT.Script.html#6739" class="Bound">x</a> <a id="6741" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6743" href="SMT.Script.html#6743" class="Bound">xs</a><a id="6745" class="Symbol">)</a> <a id="6747" class="Symbol">=</a> <a id="6749" class="Keyword">do</a> <a id="6752" href="SMT.Script.html#6752" class="Bound">x</a> <a id="6754" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6756" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="6766" href="SMT.Script.html#6739" class="Bound">x</a><a id="6767" class="Symbol">;</a> <a id="6769" href="SMT.Script.html#6769" class="Bound">xs</a> <a id="6772" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6774" href="SMT.Script.html#6642" class="Function">showArgsS</a> <a id="6784" href="SMT.Script.html#6743" class="Bound">xs</a><a id="6786" class="Symbol">;</a> <a id="6788" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="6795" class="Symbol">(</a><a id="6796" href="SMT.Script.html#6752" class="Bound">x</a> <a id="6798" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6800" href="SMT.Script.html#6769" class="Bound">xs</a><a id="6802" class="Symbol">)</a>


<a id="6806" class="Comment">-- |Show a command as an S-expression, and build up an environment of output parsers.</a>
<a id="showCommandS"></a><a id="6892" href="SMT.Script.html#6892" class="Function">showCommandS</a> <a id="6905" class="Symbol">:</a> <a id="6907" href="SMT.Script.Base.html#6370" class="Datatype">Command</a> <a id="6915" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6917" href="SMT.Script.html#1437" class="Generalizable">δΓ</a> <a id="6920" href="SMT.Script.html#1553" class="Generalizable">δΞ</a> <a id="6923" class="Symbol">→</a> <a id="6925" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="6935" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="6937" class="Symbol">(</a><a id="6938" href="SMT.Script.html#1437" class="Generalizable">δΓ</a> <a id="6941" href="Data.List.Base.html#1763" class="Function Operator">++</a> <a id="6944" href="SMT.Script.html#1432" class="Generalizable">Γ</a><a id="6945" class="Symbol">)</a> <a id="6947" class="Symbol">(</a><a id="6948" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="6955" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6957" href="SMT.Script.html#2377" class="Function">OutputParsers</a> <a id="6971" href="SMT.Script.html#1553" class="Generalizable">δΞ</a><a id="6973" class="Symbol">)</a>
<a id="6975" href="SMT.Script.html#6892" class="Function">showCommandS</a> <a id="6988" class="Symbol">(</a><a id="6989" href="SMT.Script.Base.html#6435" class="InductiveConstructor">set-logic</a> <a id="6999" href="SMT.Script.html#6999" class="Bound">l</a><a id="7000" class="Symbol">)</a> <a id="7002" class="Symbol">=</a> <a id="7004" class="Keyword">do</a>
  <a id="7009" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7016" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7018" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="7026" class="Symbol">(</a><a id="7027" class="String">&quot;set-logic&quot;</a> <a id="7039" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7041" href="SMT.Logics.html#6232" class="Function">showLogic</a> <a id="7051" href="SMT.Script.html#6999" class="Bound">l</a> <a id="7053" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7055" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7057" class="Symbol">)</a> <a id="7059" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7061" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7064" href="SMT.Script.html#6892" class="Function">showCommandS</a> <a id="7077" class="Symbol">(</a><a id="7078" href="SMT.Script.Base.html#6483" class="InductiveConstructor">declare-const</a> <a id="7092" href="SMT.Script.html#7092" class="Bound">σ</a><a id="7093" class="Symbol">)</a> <a id="7095" class="Symbol">=</a> <a id="7097" class="Keyword">do</a>
  <a id="7102" href="SMT.Script.html#7102" class="Bound">n</a> <a id="7104" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7106" href="SMT.Script.html#5466" class="Function">freshNameS</a> <a id="7117" href="SMT.Script.html#7092" class="Bound">σ</a>
  <a id="7121" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7128" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7130" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="7138" class="Symbol">(</a><a id="7139" class="String">&quot;declare-const&quot;</a> <a id="7155" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7157" href="SMT.Script.Names.html#1473" class="Function">showName</a> <a id="7166" href="SMT.Script.html#7102" class="Bound">n</a> <a id="7168" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7170" href="SMT.Theory.html#1261" class="Function">showSort</a> <a id="7179" href="SMT.Script.html#7092" class="Bound">σ</a> <a id="7181" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7183" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7185" class="Symbol">)</a> <a id="7187" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7189" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7192" href="SMT.Script.html#6892" class="Function">showCommandS</a> <a id="7205" class="Symbol">(</a><a id="7206" href="SMT.Script.Base.html#6536" class="InductiveConstructor">assert</a> <a id="7213" href="SMT.Script.html#7213" class="Bound">x</a><a id="7214" class="Symbol">)</a> <a id="7216" class="Symbol">=</a> <a id="7218" class="Keyword">do</a>
  <a id="7223" href="SMT.Script.html#7223" class="Bound">x</a> <a id="7225" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7227" href="SMT.Script.html#5999" class="Function">showTermS</a> <a id="7237" href="SMT.Script.html#7213" class="Bound">x</a>
  <a id="7241" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7248" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7250" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="7258" class="Symbol">(</a><a id="7259" class="String">&quot;assert&quot;</a> <a id="7268" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7270" href="SMT.Script.html#7223" class="Bound">x</a> <a id="7272" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7274" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7276" class="Symbol">)</a> <a id="7278" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7280" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7283" href="SMT.Script.html#6892" class="Function">showCommandS</a> <a id="7296" href="SMT.Script.Base.html#6584" class="InductiveConstructor">check-sat</a> <a id="7306" class="Symbol">=</a> <a id="7308" class="Keyword">do</a>
  <a id="7313" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7320" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7322" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="7330" class="Symbol">(</a><a id="7331" class="String">&quot;check-sat&quot;</a> <a id="7343" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7345" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7347" class="Symbol">)</a> <a id="7349" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7351" href="SMT.Script.html#2496" class="Function">pSat</a> <a id="7356" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7358" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7361" href="SMT.Script.html#6892" class="Function">showCommandS</a> <a id="7374" href="SMT.Script.Base.html#6626" class="InductiveConstructor">get-model</a> <a id="7384" class="Symbol">=</a> <a id="7386" class="Keyword">do</a>
  <a id="7391" class="Symbol">(</a><a id="7392" href="SMT.Script.html#7392" class="Bound Operator">_ns</a> <a id="7396" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7398" href="SMT.Script.html#7398" class="Bound">vps</a><a id="7401" class="Symbol">)</a> <a id="7403" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7405" href="Category.Monad.State.html#2799" class="Function">get</a>
  <a id="7411" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7418" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7420" href="Data.String.Base.html#2550" class="Function">String.unlines</a> <a id="7435" class="Symbol">(</a> <a id="7437" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="7445" class="Symbol">(</a><a id="7446" class="String">&quot;check-sat&quot;</a> <a id="7458" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7460" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7462" class="Symbol">)</a>
                          <a id="7490" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7492" href="SMT.Script.html#1703" class="Function">mkSTerm</a> <a id="7500" class="Symbol">(</a><a id="7501" class="String">&quot;get-model&quot;</a> <a id="7513" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7515" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7517" class="Symbol">)</a> <a id="7519" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7521" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7524" class="Symbol">)</a>
         <a id="7535" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7537" href="SMT.Script.html#4411" class="Function">mkModelParser</a> <a id="7551" class="Symbol">(</a><a id="7552" href="SMT.Script.html#1997" class="Function">mkVarParser</a> <a id="7564" href="SMT.Script.html#7398" class="Bound">vps</a><a id="7567" class="Symbol">)</a> <a id="7569" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7571" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>

<a id="7575" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
<a id="showScriptS"></a><a id="7660" href="SMT.Script.html#7660" class="Function">showScriptS</a> <a id="7672" class="Symbol">:</a> <a id="7674" href="SMT.Script.Base.html#6765" class="Datatype">Script</a> <a id="7681" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="7683" href="SMT.Script.html#1434" class="Generalizable">Γ′</a> <a id="7686" href="SMT.Script.html#1548" class="Generalizable">Ξ</a> <a id="7688" class="Symbol">→</a> <a id="7690" href="SMT.Script.html#4973" class="Function">NameState</a> <a id="7700" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="7702" href="SMT.Script.html#1434" class="Generalizable">Γ′</a> <a id="7705" class="Symbol">(</a><a id="7706" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7711" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="7718" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7720" href="SMT.Script.html#2377" class="Function">OutputParsers</a> <a id="7734" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="7735" class="Symbol">)</a>
<a id="7737" href="SMT.Script.html#7660" class="Function">showScriptS</a> <a id="7749" href="SMT.Script.Base.html#6828" class="InductiveConstructor">[]</a> <a id="7752" class="Symbol">=</a> <a id="7754" class="Keyword">do</a>
  <a id="7759" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7766" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7768" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7771" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7773" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
<a id="7776" href="SMT.Script.html#7660" class="Function">showScriptS</a> <a id="7788" class="Symbol">(</a><a id="7789" href="SMT.Script.html#7789" class="Bound">cmd</a> <a id="7793" href="SMT.Script.Base.html#6850" class="InductiveConstructor Operator">∷</a> <a id="7795" href="SMT.Script.html#7795" class="Bound">scr</a><a id="7798" class="Symbol">)</a> <a id="7800" class="Symbol">=</a> <a id="7802" class="Keyword">do</a>
  <a id="7807" class="Symbol">(</a><a id="7808" href="SMT.Script.html#7808" class="Bound">cmd</a> <a id="7812" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7814" href="SMT.Script.html#7814" class="Bound">ops₁</a><a id="7818" class="Symbol">)</a> <a id="7820" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7822" href="SMT.Script.html#6892" class="Function">showCommandS</a> <a id="7835" href="SMT.Script.html#7789" class="Bound">cmd</a>
  <a id="7841" class="Symbol">(</a><a id="7842" href="SMT.Script.html#7842" class="Bound">scr</a> <a id="7846" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7848" href="SMT.Script.html#7848" class="Bound">ops₂</a><a id="7852" class="Symbol">)</a> <a id="7854" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7856" href="SMT.Script.html#7660" class="Function">showScriptS</a> <a id="7868" href="SMT.Script.html#7795" class="Bound">scr</a>
  <a id="7874" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7881" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7883" href="SMT.Script.html#7808" class="Bound">cmd</a> <a id="7887" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7889" href="SMT.Script.html#7842" class="Bound">scr</a> <a id="7893" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7895" href="Data.Environment.html#1225" class="Function">Env.append</a> <a id="7906" href="Function.Base.html#615" class="Function">id</a> <a id="7909" href="SMT.Script.html#7814" class="Bound">ops₁</a> <a id="7914" href="SMT.Script.html#7848" class="Bound">ops₂</a>

<a id="7920" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
<a id="showScript"></a><a id="8003" href="SMT.Script.html#8003" class="Function">showScript</a> <a id="8014" class="Symbol">:</a> <a id="8016" href="SMT.Script.Base.html#6765" class="Datatype">Script</a> <a id="8023" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8026" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="8028" class="Symbol">(</a><a id="8029" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="8031" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8033" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="8034" class="Symbol">)</a> <a id="8036" class="Symbol">→</a> <a id="8038" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="8045" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8047" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="8050" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="8057" class="Symbol">(</a><a id="8058" href="SMT.Script.Base.html#4819" class="Datatype">Outputs</a> <a id="8066" class="Symbol">(</a><a id="8067" href="SMT.Script.html#1523" class="Generalizable">ξ</a> <a id="8069" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8071" href="SMT.Script.html#1548" class="Generalizable">Ξ</a><a id="8072" class="Symbol">))</a> <a id="8075" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="8077" href="SMT.Script.html#8003" class="Function">showScript</a> <a id="8088" href="SMT.Script.html#8088" class="Bound">scr</a> <a id="8092" class="Symbol">=</a> <a id="8094" href="Data.Product.html#2450" class="Function">Prod.map</a> <a id="8103" href="Data.String.Base.html#2550" class="Function">String.unlines</a> <a id="8118" href="SMT.Script.html#4739" class="Function">mkOutputParsers⁺</a> <a id="8135" class="Symbol">(</a><a id="8136" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8142" class="Symbol">(</a><a id="8143" href="SMT.Script.html#7660" class="Function">showScriptS</a> <a id="8155" href="SMT.Script.html#8088" class="Bound">scr</a> <a id="8159" class="Symbol">(</a><a id="8160" href="SMT.Script.Names.html#2732" class="Function">x′es</a> <a id="8165" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8167" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="8169" class="Symbol">)))</a>

<a id="8174" class="Comment">-- |Get the variable parser for a script (for debugging purposes).</a>
<a id="getVarParser"></a><a id="8241" href="SMT.Script.html#8241" class="Function">getVarParser</a> <a id="8254" class="Symbol">:</a> <a id="8256" href="SMT.Script.Base.html#6765" class="Datatype">Script</a> <a id="8263" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8266" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="8268" href="SMT.Script.html#1548" class="Generalizable">Ξ</a> <a id="8270" class="Symbol">→</a> <a id="8272" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="8275" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="8282" class="Symbol">(</a><a id="8283" href="Data.Product.html#1788" class="Function">∃[</a> <a id="8286" href="SMT.Script.html#8286" class="Bound">σ</a> <a id="8288" href="Data.Product.html#1788" class="Function">]</a> <a id="8290" class="Symbol">(</a><a id="8291" href="SMT.Script.html#1432" class="Generalizable">Γ</a> <a id="8293" href="SMT.Script.Base.html#1199" class="Function Operator">∋</a> <a id="8295" href="SMT.Script.html#8286" class="Bound">σ</a><a id="8296" class="Symbol">))</a> <a id="8299" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="8301" href="SMT.Script.html#8241" class="Function">getVarParser</a> <a id="8314" href="SMT.Script.html#8314" class="Bound">scr</a> <a id="8318" class="Symbol">=</a> <a id="8320" href="SMT.Script.html#1997" class="Function">mkVarParser</a> <a id="8332" class="Symbol">(</a><a id="8333" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8339" class="Symbol">(</a><a id="8340" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8346" class="Symbol">(</a><a id="8347" href="SMT.Script.html#7660" class="Function">showScriptS</a> <a id="8359" href="SMT.Script.html#8314" class="Bound">scr</a> <a id="8363" class="Symbol">(</a><a id="8364" href="SMT.Script.Names.html#2732" class="Function">x′es</a> <a id="8369" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8371" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="8373" class="Symbol">))))</a>

<a id="8379" class="Comment">-- -}</a>
<a id="8385" class="Comment">-- -}</a>
<a id="8391" class="Comment">-- -}</a>
</pre></body></html>