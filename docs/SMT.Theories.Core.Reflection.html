<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Theories.Core.Reflection</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="SMT.Theories.Core.Reflection.html" class="Module">SMT.Theories.Core.Reflection</a> <a id="37" class="Keyword">where</a>

<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="67" class="Symbol">as</a> <a id="70" class="Module">Empty</a> <a id="76" class="Keyword">using</a> <a id="82" class="Symbol">(</a><a id="83" href="Data.Empty.html#526" class="Datatype">⊥</a><a id="84" class="Symbol">)</a>
<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="113" class="Symbol">as</a> <a id="116" class="Module">Bool</a> <a id="121" class="Keyword">using</a> <a id="127" class="Symbol">(</a><a id="128" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="132" class="Symbol">;</a> <a id="134" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="139" class="Symbol">;</a> <a id="141" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="145" class="Symbol">)</a>
<a id="147" class="Keyword">open</a> <a id="152" class="Keyword">import</a> <a id="159" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="174" class="Symbol">as</a> <a id="177" class="Module">List</a> <a id="182" class="Keyword">using</a> <a id="188" class="Symbol">(</a><a id="189" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="193" class="Symbol">;</a> <a id="195" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="198" class="Symbol">;</a> <a id="200" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="202" class="Symbol">)</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="227" class="Symbol">as</a> <a id="230" class="Module">Maybe</a> <a id="236" class="Keyword">using</a> <a id="242" class="Symbol">(</a><a id="243" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="248" class="Symbol">;</a> <a id="250" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="257" class="Symbol">;</a> <a id="259" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="263" class="Symbol">)</a>
<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Data.Product.html" class="Module">Data.Product</a> <a id="290" class="Symbol">as</a> <a id="293" class="Module">Prod</a> <a id="298" class="Keyword">using</a> <a id="304" class="Symbol">(</a><a id="305" href="Data.Product.html#916" class="Function">Σ-syntax</a><a id="313" class="Symbol">;</a> <a id="315" href="Data.Product.html#2211" class="Function Operator">-,_</a><a id="318" class="Symbol">;</a> <a id="320" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="323" class="Symbol">)</a>
<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="346" class="Symbol">as</a> <a id="349" class="Module">Sum</a> <a id="353" class="Keyword">using</a> <a id="359" class="Symbol">(</a><a id="360" href="Data.Sum.Base.html#728" class="Datatype Operator">_⊎_</a><a id="363" class="Symbol">)</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="387" class="Symbol">as</a> <a id="390" class="Module">Unit</a> <a id="395" class="Keyword">using</a> <a id="401" class="Symbol">(</a><a id="402" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="403" class="Symbol">)</a>
<a id="405" class="Keyword">open</a> <a id="410" class="Keyword">import</a> <a id="417" href="Function.html" class="Module">Function</a> <a id="426" class="Keyword">using</a> <a id="432" class="Symbol">(</a><a id="433" href="Function.Core.html#646" class="Function">Morphism</a><a id="441" class="Symbol">)</a>
<a id="443" class="Keyword">import</a> <a id="450" href="Reflection.html" class="Module">Reflection</a> <a id="461" class="Symbol">as</a> <a id="464" class="Module">Rfl</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="497" class="Keyword">using</a> <a id="503" class="Symbol">(</a><a id="504" href="Relation.Nullary.html#653" class="Function Operator">¬_</a><a id="506" class="Symbol">)</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="SMT.Theory.html" class="Module">SMT.Theory</a>
<a id="531" class="Keyword">open</a> <a id="536" class="Keyword">import</a> <a id="543" href="SMT.Theories.Raw.html" class="Module">SMT.Theories.Raw</a> <a id="560" class="Symbol">as</a> <a id="563" class="Module">Raw</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="SMT.Theories.Core.Base.html" class="Module">SMT.Theories.Core.Base</a> <a id="602" class="Symbol">as</a> <a id="605" class="Module">Core</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="638" href="SMT.Theories.Core.Base.html#2268" class="Function">Core.coreBaseTheory</a>


<a id="660" class="Comment">-----------</a>
<a id="672" class="Comment">-- Sorts --</a>
<a id="684" class="Comment">-----------</a>

<a id="coreSorts"></a><a id="697" href="SMT.Theories.Core.Reflection.html#697" class="Function">coreSorts</a> <a id="707" class="Symbol">:</a> <a id="709" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="714" href="SMT.Theories.Core.Base.html#488" class="Datatype">CoreSort</a>
<a id="723" href="SMT.Theories.Core.Reflection.html#697" class="Function">coreSorts</a> <a id="733" class="Symbol">=</a> <a id="735" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a> <a id="740" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="742" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>


<a id="747" class="Comment">--------------</a>
<a id="762" class="Comment">-- Literals --</a>
<a id="777" class="Comment">--------------</a>

<a id="793" class="Keyword">private</a>
  <a id="803" class="Keyword">pattern</a> <a id="`⊥"></a><a id="811" href="SMT.Theories.Core.Reflection.html#811" class="InductiveConstructor">`⊥</a> <a id="814" class="Symbol">=</a> <a id="816" href="Agda.Builtin.Reflection.html#4404" class="InductiveConstructor">Rfl.con</a> <a id="824" class="Symbol">(</a><a id="825" class="Keyword">quote</a> <a id="831" href="Data.Empty.html#526" class="Datatype">⊥</a><a id="832" class="Symbol">)</a> <a id="834" class="InductiveConstructor">[]</a>
  <a id="839" class="Keyword">pattern</a> <a id="`⊤"></a><a id="847" href="SMT.Theories.Core.Reflection.html#847" class="InductiveConstructor">`⊤</a> <a id="850" class="Symbol">=</a> <a id="852" href="Agda.Builtin.Reflection.html#4404" class="InductiveConstructor">Rfl.con</a> <a id="860" class="Symbol">(</a><a id="861" class="Keyword">quote</a> <a id="867" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="868" class="Symbol">)</a> <a id="870" class="InductiveConstructor">[]</a>

<a id="checkCoreLiteral"></a><a id="874" href="SMT.Theories.Core.Reflection.html#874" class="Function">checkCoreLiteral</a> <a id="891" class="Symbol">:</a> <a id="893" class="Symbol">(</a><a id="894" href="SMT.Theories.Core.Reflection.html#894" class="Bound">φ</a> <a id="896" class="Symbol">:</a> <a id="898" href="SMT.Theories.Core.Base.html#488" class="Datatype">CoreSort</a><a id="906" class="Symbol">)</a> <a id="908" class="Symbol">→</a> <a id="910" href="Agda.Builtin.Reflection.html#4246" class="Datatype">Rfl.Term</a> <a id="919" class="Symbol">→</a> <a id="921" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="927" class="Symbol">(</a><a id="928" href="SMT.Theories.Core.Base.html#1510" class="Datatype">CoreLiteral</a> <a id="940" href="SMT.Theories.Core.Reflection.html#894" class="Bound">φ</a><a id="941" class="Symbol">)</a>
<a id="943" href="SMT.Theories.Core.Reflection.html#874" class="Function">checkCoreLiteral</a> <a id="960" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a> <a id="965" href="SMT.Theories.Core.Reflection.html#811" class="InductiveConstructor">`⊥</a> <a id="968" class="Symbol">=</a> <a id="970" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="975" class="Symbol">(</a><a id="976" href="SMT.Theories.Core.Base.html#1547" class="InductiveConstructor">bool</a> <a id="981" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="986" class="Symbol">)</a>
<a id="988" href="SMT.Theories.Core.Reflection.html#874" class="Function">checkCoreLiteral</a> <a id="1005" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a> <a id="1010" href="SMT.Theories.Core.Reflection.html#847" class="InductiveConstructor">`⊤</a> <a id="1013" class="Symbol">=</a> <a id="1015" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1020" class="Symbol">(</a><a id="1021" href="SMT.Theories.Core.Base.html#1547" class="InductiveConstructor">bool</a> <a id="1026" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="1030" class="Symbol">)</a>
<a id="1032" href="SMT.Theories.Core.Reflection.html#874" class="CatchallClause Function">checkCoreLiteral</a><a id="1048" class="CatchallClause"> </a><a id="1049" class="CatchallClause Symbol">_</a><a id="1050" class="CatchallClause">     </a><a id="1055" class="CatchallClause Symbol">_</a> <a id="1057" class="Symbol">=</a> <a id="1059" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


<a id="1069" class="Comment">-----------------</a>
<a id="1087" class="Comment">-- Identifiers --</a>
<a id="1105" class="Comment">-----------------</a>

<a id="1124" class="Comment">-- NOTE: There is no builtin type corresponding to XOR, so we don&#39;t map anything</a>
<a id="1205" class="Comment">--       to XOR. The bulltin Π-type has no name, so in the Reflection to Raw</a>
<a id="1282" class="Comment">--       code we must take care to map non-dependent Π-types to &quot;Morphism&quot; from</a>
<a id="1362" class="Comment">--       the module Function.Core.</a>
<a id="1397" class="Comment">--</a>
<a id="1400" class="Keyword">private</a>
  <a id="1410" class="Keyword">pattern</a> <a id="`not"></a><a id="1418" href="SMT.Theories.Core.Reflection.html#1418" class="InductiveConstructor">`not</a>     <a id="1427" class="Symbol">=</a> <a id="1429" class="Keyword">quote</a> <a id="1435" href="Relation.Nullary.html#653" class="Function Operator">¬_</a>
  <a id="1440" class="Keyword">pattern</a> <a id="`implies"></a><a id="1448" href="SMT.Theories.Core.Reflection.html#1448" class="InductiveConstructor">`implies</a> <a id="1457" class="Symbol">=</a> <a id="1459" class="Keyword">quote</a> <a id="1465" href="Function.Core.html#646" class="Function">Morphism</a>
  <a id="1476" class="Keyword">pattern</a> <a id="`and"></a><a id="1484" href="SMT.Theories.Core.Reflection.html#1484" class="InductiveConstructor">`and</a>     <a id="1493" class="Symbol">=</a> <a id="1495" class="Keyword">quote</a> <a id="1501" href="Data.Product.html#1167" class="Function Operator">_×_</a>
  <a id="1507" class="Keyword">pattern</a> <a id="`or"></a><a id="1515" href="SMT.Theories.Core.Reflection.html#1515" class="InductiveConstructor">`or</a>      <a id="1524" class="Symbol">=</a> <a id="1526" class="Keyword">quote</a> <a id="1532" href="Data.Sum.Base.html#728" class="Datatype Operator">_⊎_</a>

<a id="checkCoreIdentifier"></a><a id="1537" href="SMT.Theories.Core.Reflection.html#1537" class="Function">checkCoreIdentifier</a> <a id="1557" class="Symbol">:</a> <a id="1559" class="Symbol">(</a><a id="1560" href="SMT.Theories.Core.Reflection.html#1560" class="Bound">φ</a> <a id="1562" class="Symbol">:</a> <a id="1564" href="SMT.Theories.Core.Base.html#488" class="Datatype">CoreSort</a><a id="1572" class="Symbol">)</a> <a id="1574" class="Symbol">→</a> <a id="1576" href="Agda.Builtin.Reflection.html#489" class="Postulate">Rfl.Name</a> <a id="1585" class="Symbol">→</a> <a id="1587" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1593" class="Symbol">(</a><a id="1594" href="Data.Product.html#916" class="Function">Σ[</a> <a id="1597" href="SMT.Theories.Core.Reflection.html#1597" class="Bound">Φ</a> <a id="1599" href="Data.Product.html#916" class="Function">∈</a> <a id="1601" href="SMT.Theory.html#457" class="Record">Signature</a> <a id="1611" href="SMT.Theories.Core.Reflection.html#1560" class="Bound">φ</a> <a id="1613" href="Data.Product.html#916" class="Function">]</a> <a id="1615" href="SMT.Theories.Core.Base.html#1759" class="Datatype">CoreIdentifier</a> <a id="1630" href="SMT.Theories.Core.Reflection.html#1597" class="Bound">Φ</a><a id="1631" class="Symbol">)</a>
<a id="1633" href="SMT.Theories.Core.Reflection.html#1537" class="Function">checkCoreIdentifier</a> <a id="1653" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a> <a id="1658" href="SMT.Theories.Core.Reflection.html#1418" class="InductiveConstructor">`not</a>     <a id="1667" class="Symbol">=</a> <a id="1669" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1674" class="Symbol">(</a><a id="1675" href="Data.Product.html#2211" class="Function Operator">-,</a> <a id="1678" href="SMT.Theories.Core.Base.html#1808" class="InductiveConstructor">not</a><a id="1681" class="Symbol">)</a>
<a id="1683" href="SMT.Theories.Core.Reflection.html#1537" class="Function">checkCoreIdentifier</a> <a id="1703" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a> <a id="1708" href="SMT.Theories.Core.Reflection.html#1448" class="InductiveConstructor">`implies</a> <a id="1717" class="Symbol">=</a> <a id="1719" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1724" class="Symbol">(</a><a id="1725" href="Data.Product.html#2211" class="Function Operator">-,</a> <a id="1728" href="SMT.Theories.Core.Base.html#1846" class="InductiveConstructor">implies</a><a id="1735" class="Symbol">)</a>
<a id="1737" href="SMT.Theories.Core.Reflection.html#1537" class="Function">checkCoreIdentifier</a> <a id="1757" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a> <a id="1762" href="SMT.Theories.Core.Reflection.html#1484" class="InductiveConstructor">`and</a>     <a id="1771" class="Symbol">=</a> <a id="1773" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1778" class="Symbol">(</a><a id="1779" href="Data.Product.html#2211" class="Function Operator">-,</a> <a id="1782" href="SMT.Theories.Core.Base.html#1884" class="InductiveConstructor">and</a><a id="1785" class="Symbol">)</a>
<a id="1787" href="SMT.Theories.Core.Reflection.html#1537" class="Function">checkCoreIdentifier</a> <a id="1807" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a> <a id="1812" href="SMT.Theories.Core.Reflection.html#1515" class="InductiveConstructor">`or</a>      <a id="1821" class="Symbol">=</a> <a id="1823" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1828" class="Symbol">(</a><a id="1829" href="Data.Product.html#2211" class="Function Operator">-,</a> <a id="1832" href="SMT.Theories.Core.Base.html#1922" class="InductiveConstructor">or</a><a id="1834" class="Symbol">)</a>
<a id="1836" href="SMT.Theories.Core.Reflection.html#1537" class="Function">checkCoreIdentifier</a> <a id="1856" href="SMT.Theories.Core.Base.html#511" class="InductiveConstructor">BOOL</a>  <a id="1862" class="Symbol">_</a>       <a id="1870" class="Symbol">=</a> <a id="1872" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


<a id="1882" class="Comment">---------------</a>
<a id="1898" class="Comment">-- Instances --</a>
<a id="1914" class="Comment">---------------</a>

<a id="coreReflectable"></a><a id="1931" href="SMT.Theories.Core.Reflection.html#1931" class="Function">coreReflectable</a> <a id="1947" class="Symbol">:</a> <a id="1949" href="SMT.Theory.html#2005" class="Record">Reflectable</a> <a id="1961" href="SMT.Theories.Core.Base.html#3072" class="Function">coreTheory</a>
<a id="1972" href="SMT.Theory.html#2080" class="Field">Reflectable.sorts</a>           <a id="2000" href="SMT.Theories.Core.Reflection.html#1931" class="Function">coreReflectable</a> <a id="2016" class="Symbol">=</a> <a id="2018" href="SMT.Theories.Core.Reflection.html#697" class="Function">coreSorts</a>
<a id="2028" href="SMT.Theory.html#2112" class="Field">Reflectable.checkLiteral</a>    <a id="2056" href="SMT.Theories.Core.Reflection.html#1931" class="Function">coreReflectable</a> <a id="2072" class="Symbol">=</a> <a id="2074" href="SMT.Theories.Core.Reflection.html#874" class="Function">checkCoreLiteral</a>
<a id="2091" href="SMT.Theory.html#2176" class="Field">Reflectable.checkIdentifier</a> <a id="2119" href="SMT.Theories.Core.Reflection.html#1931" class="Function">coreReflectable</a> <a id="2135" class="Symbol">=</a> <a id="2137" href="SMT.Theories.Core.Reflection.html#1537" class="Function">checkCoreIdentifier</a>
</pre></body></html>