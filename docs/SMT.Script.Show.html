<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script.Show</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Comment">--------------------------------------------------------------------------------</a>
<a id="113" class="Comment">-- Schmitty the Solver</a>
<a id="136" class="Comment">--</a>
<a id="139" class="Comment">-- Defines `showScript`, which prints a script as an SMT query, as well as</a>
<a id="214" class="Comment">-- generating a parser which parses the output generated by the SMT solver for</a>
<a id="293" class="Comment">-- the query.</a>
<a id="307" class="Comment">--------------------------------------------------------------------------------</a>

<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="SMT.Theory.Base.html" class="Module">SMT.Theory.Base</a>

<a id="418" class="Keyword">module</a> <a id="425" href="SMT.Script.Show.html" class="Module">SMT.Script.Show</a> <a id="441" class="Symbol">(</a><a id="442" href="SMT.Script.Show.html#442" class="Bound">theory</a> <a id="449" class="Symbol">:</a> <a id="451" href="SMT.Theory.Base.html#3890" class="Record">Theory</a><a id="457" class="Symbol">)</a> <a id="459" class="Keyword">where</a>

<a id="466" class="Keyword">open</a> <a id="471" href="SMT.Theory.Base.html#3890" class="Module">Theory</a> <a id="478" href="SMT.Script.Show.html#442" class="Bound">theory</a>

<a id="486" class="Keyword">open</a> <a id="491" class="Keyword">import</a> <a id="498" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="547" class="Symbol">as</a> <a id="550" class="Module">Stream</a> <a id="557" class="Keyword">using</a> <a id="563" class="Symbol">(</a><a id="564" href="Codata.Musical.Stream.html#659" class="Datatype">Stream</a><a id="570" class="Symbol">)</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Data.Char.html" class="Module">Data.Char</a> <a id="594" class="Symbol">as</a> <a id="597" class="Module">Char</a> <a id="602" class="Keyword">using</a> <a id="608" class="Symbol">(</a><a id="609" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="613" class="Symbol">)</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="644" class="Symbol">as</a> <a id="647" class="Module">Env</a> <a id="651" class="Keyword">using</a> <a id="657" class="Symbol">(</a><a id="658" href="Data.Environment.html#360" class="Datatype">Env</a><a id="661" class="Symbol">;</a> <a id="663" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="666" class="Symbol">;</a> <a id="668" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="670" class="Symbol">)</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="693" class="Symbol">as</a> <a id="696" class="Module">Fin</a> <a id="700" class="Keyword">using</a> <a id="706" class="Symbol">(</a><a id="707" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a><a id="710" class="Symbol">;</a> <a id="712" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a><a id="715" class="Symbol">;</a> <a id="717" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a><a id="721" class="Symbol">)</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Data.List.html" class="Module">Data.List</a> <a id="745" class="Symbol">as</a> <a id="748" class="Module">List</a> <a id="753" class="Keyword">using</a> <a id="759" class="Symbol">(</a><a id="760" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="764" class="Symbol">;</a> <a id="766" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="769" class="Symbol">;</a> <a id="771" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="773" class="Symbol">;</a> <a id="775" href="Data.List.Base.html#5025" class="Function Operator">[_]</a><a id="778" class="Symbol">;</a> <a id="780" href="Data.List.Base.html#9934" class="Function Operator">_ʳ++_</a><a id="785" class="Symbol">;</a> <a id="787" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="791" class="Symbol">;</a> <a id="793" href="Data.List.Base.html#4864" class="Function">length</a><a id="799" class="Symbol">)</a>
<a id="801" class="Keyword">open</a> <a id="806" class="Keyword">import</a> <a id="813" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="842" class="Symbol">as</a> <a id="845" class="Module">All</a> <a id="849" class="Keyword">using</a> <a id="855" class="Symbol">(</a><a id="856" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a><a id="859" class="Symbol">;</a> <a id="861" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">_∷_</a><a id="864" class="Symbol">;</a> <a id="866" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="868" class="Symbol">)</a>
<a id="870" class="Keyword">open</a> <a id="875" class="Keyword">import</a> <a id="882" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="911" class="Symbol">as</a> <a id="914" class="Module">Any</a> <a id="918" class="Keyword">using</a> <a id="924" class="Symbol">(</a><a id="925" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a><a id="929" class="Symbol">;</a> <a id="931" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a><a id="936" class="Symbol">)</a>
<a id="938" class="Keyword">open</a> <a id="943" class="Keyword">import</a> <a id="950" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="969" class="Symbol">as</a> <a id="972" class="Module">List⁺</a> <a id="978" class="Keyword">using</a> <a id="984" class="Symbol">(</a><a id="985" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a><a id="990" class="Symbol">;</a> <a id="992" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">_∷_</a><a id="995" class="Symbol">)</a>
<a id="997" class="Keyword">open</a> <a id="1002" class="Keyword">import</a> <a id="1009" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1020" class="Symbol">as</a> <a id="1023" class="Module">Maybe</a> <a id="1029" class="Keyword">using</a> <a id="1035" class="Symbol">(</a><a id="1036" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="1041" class="Symbol">;</a> <a id="1043" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="1047" class="Symbol">;</a> <a id="1049" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="1056" class="Symbol">)</a>
<a id="1058" class="Keyword">import</a> <a id="1065" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="1088" class="Symbol">as</a> <a id="1091" class="Module">MaybeCat</a>
<a id="1100" class="Keyword">open</a> <a id="1105" class="Keyword">import</a> <a id="1112" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1121" class="Symbol">as</a> <a id="1124" class="Module">Nat</a> <a id="1128" class="Keyword">using</a> <a id="1134" class="Symbol">(</a><a id="1135" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1136" class="Symbol">;</a> <a id="1138" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1141" class="Symbol">;</a> <a id="1143" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1147" class="Symbol">)</a>
<a id="1149" class="Keyword">open</a> <a id="1154" class="Keyword">import</a> <a id="1161" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="1175" class="Keyword">renaming</a> <a id="1184" class="Symbol">(</a><a id="1185" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1190" class="Symbol">to</a> <a id="1193" class="Function">showℕ</a><a id="1198" class="Symbol">)</a>
<a id="1200" class="Keyword">open</a> <a id="1205" class="Keyword">import</a> <a id="1212" href="Data.Product.html" class="Module">Data.Product</a> <a id="1225" class="Symbol">as</a> <a id="1228" class="Module">Prod</a> <a id="1233" class="Keyword">using</a> <a id="1239" class="Symbol">(</a><a id="1240" href="Data.Product.html#1369" class="Function">∃</a><a id="1241" class="Symbol">;</a> <a id="1243" href="Data.Product.html#1806" class="Function">∃-syntax</a><a id="1251" class="Symbol">;</a> <a id="1253" href="Data.Product.html#2247" class="Function Operator">-,_</a><a id="1256" class="Symbol">;</a> <a id="1258" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="1261" class="Symbol">;</a> <a id="1263" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1266" class="Symbol">;</a> <a id="1268" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1273" class="Symbol">;</a> <a id="1275" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1280" class="Symbol">)</a>
<a id="1282" class="Keyword">open</a> <a id="1287" class="Keyword">import</a> <a id="1294" href="Data.String.html" class="Module">Data.String</a> <a id="1306" class="Symbol">as</a> <a id="1309" class="Module">String</a> <a id="1316" class="Keyword">using</a> <a id="1322" class="Symbol">(</a><a id="1323" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1329" class="Symbol">)</a>
<a id="1331" class="Keyword">open</a> <a id="1336" class="Keyword">import</a> <a id="1343" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1353" class="Symbol">as</a> <a id="1356" class="Module">Unit</a> <a id="1361" class="Keyword">using</a> <a id="1367" class="Symbol">(</a><a id="1368" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1369" class="Symbol">)</a>
<a id="1371" class="Keyword">open</a> <a id="1376" class="Keyword">import</a> <a id="1383" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1392" class="Symbol">as</a> <a id="1395" class="Module">Vec</a> <a id="1399" class="Keyword">using</a> <a id="1405" class="Symbol">(</a><a id="1406" href="Data.Vec.Base.html#998" class="Datatype">Vec</a><a id="1409" class="Symbol">;</a> <a id="1411" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">_∷_</a><a id="1414" class="Symbol">;</a> <a id="1416" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="1418" class="Symbol">)</a>
<a id="1420" class="Keyword">open</a> <a id="1425" class="Keyword">import</a> <a id="1432" href="Function.html" class="Module">Function</a> <a id="1441" class="Keyword">using</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1451" class="Symbol">;</a> <a id="1453" href="Function.Base.html#4121" class="Function Operator">case_of_</a><a id="1461" class="Symbol">;</a> <a id="1463" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1466" class="Symbol">;</a> <a id="1468" href="Function.Base.html#636" class="Function">const</a><a id="1473" class="Symbol">;</a> <a id="1475" href="Function.Base.html#1554" class="Function">flip</a><a id="1479" class="Symbol">;</a> <a id="1481" href="Function.Base.html#615" class="Function">id</a><a id="1483" class="Symbol">)</a>
<a id="1485" class="Keyword">import</a> <a id="1492" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1522" class="Symbol">as</a> <a id="1525" class="Module">Identity</a>
<a id="1534" class="Keyword">import</a> <a id="1541" href="Level.html" class="Module">Level</a>
<a id="1547" class="Keyword">import</a> <a id="1554" href="Reflection.html" class="Module">Reflection</a> <a id="1565" class="Symbol">as</a> <a id="1568" class="Module">Rfl</a>
<a id="1572" class="Keyword">open</a> <a id="1577" class="Keyword">import</a> <a id="1584" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1601" class="Keyword">using</a> <a id="1607" class="Symbol">(</a><a id="1608" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="1611" class="Symbol">;</a> <a id="1613" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="1615" class="Symbol">)</a>
<a id="1617" class="Keyword">open</a> <a id="1622" class="Keyword">import</a> <a id="1629" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1667" class="Keyword">using</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1677" class="Symbol">;</a> <a id="1679" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1683" class="Symbol">)</a>
<a id="1685" class="Keyword">open</a> <a id="1690" class="Keyword">import</a> <a id="1697" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1713" href="SMT.Theory.Base.html#3922" class="Field">baseTheory</a>
<a id="1724" class="Keyword">open</a> <a id="1729" class="Keyword">import</a> <a id="1736" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1753" href="SMT.Theory.Base.html#3922" class="Field">baseTheory</a>

<a id="1765" class="Keyword">private</a>
  <a id="1775" class="Keyword">variable</a>
    <a id="1788" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="1790" href="SMT.Script.Show.html#1790" class="Generalizable">σ′</a>    <a id="1796" class="Symbol">:</a> <a id="1798" href="SMT.Theory.Base.html#2591" class="Function">Sort</a>
    <a id="1807" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="1809" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="1812" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="1815" class="Symbol">:</a> <a id="1817" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a>
    <a id="1826" href="SMT.Script.Show.html#1826" class="Generalizable">Δ</a> <a id="1828" href="SMT.Script.Show.html#1828" class="Generalizable">Δ′</a>    <a id="1834" class="Symbol">:</a> <a id="1836" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a>
    <a id="1845" href="SMT.Script.Show.html#1845" class="Generalizable">Σ</a>       <a id="1853" class="Symbol">:</a> <a id="1855" href="SMT.Theory.Base.html#1984" class="Record">Signature</a> <a id="1865" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a>
    <a id="1871" href="SMT.Script.Show.html#1871" class="Generalizable">Σ′</a>      <a id="1879" class="Symbol">:</a> <a id="1881" href="SMT.Theory.Base.html#1984" class="Record">Signature</a> <a id="1891" href="SMT.Script.Show.html#1790" class="Generalizable">σ′</a>
    <a id="1898" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="1900" href="SMT.Script.Show.html#1900" class="Generalizable">ξ′</a>    <a id="1906" class="Symbol">:</a> <a id="1908" href="SMT.Script.Base.html#5643" class="Datatype">OutputType</a>
    <a id="1923" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="1925" href="SMT.Script.Show.html#1925" class="Generalizable">Ξ′</a> <a id="1928" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a> <a id="1931" class="Symbol">:</a> <a id="1933" href="SMT.Script.Base.html#5737" class="Function">OutputCtxt</a>


<a id="1946" class="Comment">-- * Parsers</a>

<a id="1960" class="Keyword">module</a> <a id="1967" href="SMT.Script.Show.html#1967" class="Module">_</a> <a id="1969" class="Keyword">where</a>

  <a id="1978" class="Keyword">open</a> <a id="1983" class="Keyword">import</a> <a id="1990" href="Text.Parser.String.html" class="Module">Text.Parser.String</a>

  <a id="2012" class="Comment">-- * Variable parsers</a>

  <a id="2037" class="Comment">-- |Environment of variable parsers.</a>
  <a id="2076" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2087" class="Symbol">:</a> <a id="2089" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a> <a id="2094" class="Symbol">→</a> <a id="2096" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2102" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2113" class="Symbol">=</a> <a id="2115" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2119" class="Symbol">(λ</a> <a id="2122" href="SMT.Script.Show.html#2122" class="Bound">σ</a> <a id="2124" href="SMT.Script.Show.html#2124" class="Bound">Γ</a> <a id="2126" class="Symbol">→</a> <a id="2128" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2131" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2138" class="Symbol">((</a><a id="2140" href="SMT.Script.Show.html#2122" class="Bound">σ</a> <a id="2142" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2144" href="SMT.Script.Show.html#2124" class="Bound">Γ</a><a id="2145" class="Symbol">)</a> <a id="2147" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="2149" href="SMT.Script.Show.html#2122" class="Bound">σ</a><a id="2150" class="Symbol">)</a> <a id="2152" href="Relation.Unary.html#3359" class="Function">]</a><a id="2153" class="Symbol">)</a>

  <a id="2158" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
  <a id="2240" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2252" class="Symbol">:</a> <a id="2254" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2265" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="2267" class="Symbol">→</a> <a id="2269" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2272" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2279" class="Symbol">(</a><a id="2280" href="Data.Product.html#1806" class="Function">∃[</a> <a id="2283" href="SMT.Script.Show.html#2283" class="Bound">σ</a> <a id="2285" href="Data.Product.html#1806" class="Function">]</a> <a id="2287" class="Symbol">(</a><a id="2288" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="2290" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="2292" href="SMT.Script.Show.html#2283" class="Bound">σ</a><a id="2293" class="Symbol">))</a> <a id="2296" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2300" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2312" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="2326" class="Symbol">=</a> <a id="2328" href="Text.Parser.String.html#5367" class="Function">fail</a>
  <a id="2335" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2347" class="Symbol">(</a><a id="2348" href="SMT.Script.Show.html#2348" class="Bound">p</a> <a id="2350" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="2352" href="SMT.Script.Show.html#2352" class="Bound">env</a><a id="2355" class="Symbol">)</a> <a id="2357" class="Symbol">{</a><a id="2358" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2359" class="Symbol">}</a> <a id="2361" class="Symbol">=</a> <a id="2363" class="Symbol">(</a><a id="2364" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="2368" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="2372" href="SMT.Script.Show.html#2348" class="Bound">p</a> <a id="2374" class="Symbol">{</a><a id="2375" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2376" class="Symbol">})</a> <a id="2379" href="Text.Parser.String.html#5440" class="Function Operator">&lt;|&gt;</a> <a id="2383" class="Symbol">(</a><a id="2384" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="2393" href="Function.Base.html#615" class="Function">id</a> <a id="2396" href="SMT.Script.Base.html#2780" class="Function">extendVar</a> <a id="2406" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="2410" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2422" href="SMT.Script.Show.html#2352" class="Bound">env</a> <a id="2426" class="Symbol">{</a><a id="2427" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2428" class="Symbol">})</a>


  <a id="2435" class="Comment">-- * Output parsers</a>

  <a id="2458" class="Comment">-- |Mapping from output types to parser types.</a>
  <a id="2507" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2520" class="Symbol">:</a> <a id="2522" href="SMT.Script.Base.html#5643" class="Datatype">OutputType</a> <a id="2533" class="Symbol">→</a> <a id="2535" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2541" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2554" href="SMT.Script.Show.html#2554" class="Bound">ξ</a> <a id="2556" class="Symbol">=</a> <a id="2558" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2561" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2568" class="Symbol">(</a><a id="2569" href="SMT.Script.Base.html#6864" class="Function">Output</a> <a id="2576" href="SMT.Script.Show.html#2554" class="Bound">ξ</a><a id="2577" class="Symbol">)</a> <a id="2579" href="Relation.Unary.html#3359" class="Function">]</a>

  <a id="2584" class="Comment">-- |Mapping from output contexts to parser types.</a>
  <a id="2636" class="Comment">--</a>
  <a id="2641" class="Comment">-- TODO: Replace use of Env with All.</a>
  <a id="2681" class="Comment">--</a>
  <a id="2686" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="2700" class="Symbol">:</a> <a id="2702" href="SMT.Script.Base.html#5737" class="Function">OutputCtxt</a> <a id="2713" class="Symbol">→</a> <a id="2715" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2721" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="2735" href="SMT.Script.Show.html#2735" class="Bound">Ξ</a> <a id="2737" class="Symbol">=</a> <a id="2739" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2743" class="Symbol">(λ</a> <a id="2746" href="SMT.Script.Show.html#2746" class="Bound">ξ</a> <a id="2748" href="SMT.Script.Show.html#2748" class="Bound Operator">_Ξ</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2766" href="SMT.Script.Show.html#2746" class="Bound">ξ</a><a id="2767" class="Symbol">)</a> <a id="2769" href="SMT.Script.Show.html#2735" class="Bound">Ξ</a>

  <a id="2774" class="Comment">-- |Parse a satisfiability result.</a>
  <a id="2811" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2816" class="Symbol">:</a> <a id="2818" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2821" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2828" href="SMT.Script.Base.html#5888" class="Datatype">Sat</a> <a id="2832" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2836" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2841" class="Symbol">=</a> <a id="2843" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>    <a id="2850" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="2853" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="2860" class="String">&quot;sat&quot;</a>
    <a id="2870" href="Text.Parser.String.html#5440" class="Function Operator">&lt;|&gt;</a> <a id="2874" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="2882" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="2885" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="2892" class="String">&quot;unsat&quot;</a>
    <a id="2904" href="Text.Parser.String.html#5440" class="Function Operator">&lt;|&gt;</a> <a id="2908" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="2916" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="2919" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="2926" class="String">&quot;unknown&quot;</a>

  <a id="2939" href="SMT.Script.Show.html#2939" class="Function">_</a> <a id="2941" class="Symbol">:</a> <a id="2943" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2948" href="Text.Parser.String.html#8559" class="Function Operator">parses</a> <a id="2955" class="String">&quot;sat&quot;</a>
  <a id="2963" class="Symbol">_</a> <a id="2965" class="Symbol">=</a> <a id="2967" href="Text.Parser.String.html#8167" class="InductiveConstructor Operator">!</a> <a id="2969" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>

  <a id="2976" href="SMT.Script.Show.html#2976" class="Function">_</a> <a id="2978" class="Symbol">:</a> <a id="2980" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2985" href="Text.Parser.String.html#8559" class="Function Operator">parses</a> <a id="2992" class="String">&quot;unsat&quot;</a>
  <a id="3002" class="Symbol">_</a> <a id="3004" class="Symbol">=</a> <a id="3006" href="Text.Parser.String.html#8167" class="InductiveConstructor Operator">!</a> <a id="3008" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>

  <a id="3017" href="SMT.Script.Show.html#3017" class="Function">_</a> <a id="3019" class="Symbol">:</a> <a id="3021" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="3026" href="Text.Parser.String.html#8559" class="Function Operator">parses</a> <a id="3033" class="String">&quot;unknown&quot;</a>
  <a id="3045" class="Symbol">_</a> <a id="3047" class="Symbol">=</a> <a id="3049" href="Text.Parser.String.html#8167" class="InductiveConstructor Operator">!</a> <a id="3051" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a>

  <a id="3062" href="SMT.Script.Show.html#3062" class="Function">_</a> <a id="3064" class="Symbol">:</a> <a id="3066" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="3071" href="Text.Parser.String.html#8991" class="Function Operator">rejects</a> <a id="3079" class="String">&quot;dogfood&quot;</a>
  <a id="3091" class="Symbol">_</a> <a id="3093" class="Symbol">=</a> <a id="3095" class="Symbol">_</a>


  <a id="3101" class="Comment">-- |Construct a definitions parser from a variable parser.</a>
  <a id="3162" class="Comment">--</a>
  <a id="3167" class="Comment">-- @</a>
  <a id="3174" class="Comment">--   (define-fun x0 () Int (- 1))</a>
  <a id="3210" class="Comment">-- @</a>
  <a id="3217" class="Comment">--</a>
  <a id="3222" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3240" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3247" class="Symbol">(</a><a id="3248" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3252" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3253" class="Symbol">)</a> <a id="3255" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3257" class="Symbol">→</a> <a id="3259" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3262" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3269" class="Symbol">(</a><a id="3270" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="3275" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3276" class="Symbol">)</a> <a id="3278" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="3282" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="3295" class="Symbol">{</a><a id="3296" href="SMT.Script.Show.html#3296" class="Bound">Γ</a><a id="3297" class="Symbol">}</a> <a id="3299" href="SMT.Script.Show.html#3299" class="Bound">pVar</a> <a id="3304" class="Symbol">=</a> <a id="3306" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="3317" class="Symbol">(</a><a id="3318" href="Text.Parser.String.html#4234" class="Function">guardM</a> <a id="3325" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3335" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a><a id="3342" class="Symbol">)</a>
    <a id="3348" class="Keyword">where</a>
      <a id="3360" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a> <a id="3368" class="Symbol">:</a> <a id="3370" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3373" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3380" class="Symbol">(</a><a id="3381" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3385" href="SMT.Script.Show.html#3296" class="Bound">Γ</a> <a id="3387" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3389" href="SMT.Script.Base.html#10576" class="Function">Val</a><a id="3392" class="Symbol">)</a> <a id="3394" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="3402" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a> <a id="3410" class="Symbol">=</a>
        <a id="3420" href="Text.Parser.String.html#7204" class="Function">parens</a> <a id="3427" class="Symbol">(</a><a id="3428" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3432" class="Symbol">(</a><a id="3433" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="3440" class="String">&quot;define-fun&quot;</a> <a id="3453" href="Text.Parser.String.html#4617" class="Function Operator">&amp;&gt;</a> <a id="3456" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3460" class="Symbol">(</a><a id="3461" href="SMT.Script.Show.html#3299" class="Bound">pVar</a> <a id="3466" href="Text.Parser.String.html#4446" class="Function Operator">&lt;&amp;&gt;</a>
          <a id="3480" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3484" class="Symbol">(</a><a id="3485" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="3492" class="String">&quot;()&quot;</a> <a id="3497" href="Text.Parser.String.html#4617" class="Function Operator">&amp;&gt;</a> <a id="3500" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3504" class="Symbol">(</a><a id="3505" href="SMT.Theory.Base.html#3800" class="Function">parseSort</a> <a id="3515" href="Text.Parser.String.html#4324" class="Function Operator">&gt;&gt;=</a> <a id="3519" class="Symbol">λ</a> <a id="3521" href="SMT.Script.Show.html#3521" class="Bound">σ</a> <a id="3523" class="Symbol">→</a> <a id="3525" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3529" class="Symbol">(</a><a id="3530" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="3534" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="3538" href="SMT.Theory.Base.html#3834" class="Function">parseValue</a> <a id="3549" href="SMT.Script.Show.html#3521" class="Bound">σ</a><a id="3550" class="Symbol">))))))</a>

      <a id="3564" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3574" class="Symbol">:</a> <a id="3576" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3580" href="SMT.Script.Show.html#3296" class="Bound">Γ</a> <a id="3582" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3584" href="SMT.Script.Base.html#10576" class="Function">Val</a> <a id="3588" class="Symbol">→</a> <a id="3590" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3596" class="Symbol">(</a><a id="3597" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="3602" href="SMT.Script.Show.html#3296" class="Bound">Γ</a><a id="3603" class="Symbol">)</a>
      <a id="3611" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3621" class="Symbol">((</a><a id="3623" href="SMT.Script.Show.html#3623" class="Bound">σ</a> <a id="3625" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3627" href="SMT.Script.Show.html#3627" class="Bound">i</a><a id="3628" class="Symbol">)</a> <a id="3630" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3632" class="Symbol">(</a><a id="3633" href="SMT.Script.Show.html#3633" class="Bound">σ′</a> <a id="3636" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3638" href="SMT.Script.Show.html#3638" class="Bound">v</a><a id="3639" class="Symbol">))</a> <a id="3642" class="Keyword">with</a> <a id="3647" href="SMT.Script.Show.html#3623" class="Bound">σ</a> <a id="3649" href="SMT.Theory.Base.html#2615" class="Function Operator">≟-Sort</a> <a id="3656" href="SMT.Script.Show.html#3633" class="Bound">σ′</a>
      <a id="3665" class="Symbol">...</a> <a id="3669" class="Symbol">|</a> <a id="3671" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3675" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3680" class="Symbol">=</a> <a id="3682" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3687" class="Symbol">(</a><a id="3688" class="Bound">σ</a> <a id="3690" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3692" class="Bound">i</a> <a id="3694" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3696" class="Bound">v</a><a id="3697" class="Symbol">)</a>
      <a id="3705" class="Symbol">...</a> <a id="3709" class="Symbol">|</a> <a id="3711" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="3715" class="Symbol">_</a>    <a id="3720" class="Symbol">=</a> <a id="3722" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="3734" class="Comment">-- |Construct a definition-list parser from a variable parser.</a>
  <a id="3799" href="SMT.Script.Show.html#3799" class="Function">mkDefnsParser</a> <a id="3813" class="Symbol">:</a> <a id="3815" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3818" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3825" class="Symbol">(</a><a id="3826" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3830" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3831" class="Symbol">)</a> <a id="3833" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3835" class="Symbol">→</a> <a id="3837" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3840" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3847" class="Symbol">(</a><a id="3848" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="3854" class="Symbol">(</a><a id="3855" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="3860" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3861" class="Symbol">))</a> <a id="3864" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="3868" href="SMT.Script.Show.html#3799" class="Function">mkDefnsParser</a> <a id="3882" class="Symbol">{</a><a id="3883" href="SMT.Script.Show.html#3883" class="Bound">Γ</a><a id="3884" class="Symbol">}</a> <a id="3886" href="SMT.Script.Show.html#3886" class="Bound">pVar</a> <a id="3891" class="Symbol">=</a>
    <a id="3897" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="3908" class="Symbol">(</a><a id="3909" href="Text.Parser.String.html#7204" class="Function">parens</a> <a id="3916" class="Symbol">(</a><a id="3917" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3921" class="Symbol">(</a><a id="3922" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="3929" class="String">&quot;model&quot;</a> <a id="3937" href="Text.Parser.String.html#4617" class="Function Operator">&amp;&gt;</a> <a id="3940" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3944" class="Symbol">(</a><a id="3945" href="Text.Parser.String.html#5973" class="Function">list⁺</a> <a id="3951" class="Symbol">(</a><a id="3952" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="3965" class="Symbol">{</a><a id="3966" href="SMT.Script.Show.html#3883" class="Bound">Γ</a><a id="3967" class="Symbol">}</a> <a id="3969" href="SMT.Script.Show.html#3886" class="Bound">pVar</a><a id="3973" class="Symbol">)))))</a>


  <a id="3983" class="Keyword">private</a>
    <a id="3995" href="SMT.Script.Show.html#3995" class="Function">MaybeModel</a> <a id="4006" class="Symbol">:</a> <a id="4008" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a> <a id="4013" class="Symbol">→</a> <a id="4015" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="4023" href="SMT.Script.Show.html#3995" class="Function">MaybeModel</a> <a id="4034" href="SMT.Script.Show.html#4034" class="Bound">Γ</a> <a id="4036" class="Symbol">=</a> <a id="4038" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="4042" class="Symbol">(λ</a> <a id="4045" href="SMT.Script.Show.html#4045" class="Bound">σ</a> <a id="4047" href="SMT.Script.Show.html#4047" class="Bound Operator">_Γ</a> <a id="4050" class="Symbol">→</a> <a id="4052" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4057" class="Symbol">(</a><a id="4058" href="SMT.Theory.Base.html#3335" class="Function">Value</a> <a id="4064" href="SMT.Script.Show.html#4045" class="Bound">σ</a><a id="4065" class="Symbol">))</a> <a id="4068" href="SMT.Script.Show.html#4034" class="Bound">Γ</a>

    <a id="4075" href="SMT.Script.Show.html#4075" class="Function">insertMM</a> <a id="4084" class="Symbol">:</a> <a id="4086" href="Data.Product.html#1806" class="Function">∃[</a> <a id="4089" href="SMT.Script.Show.html#4089" class="Bound">σ</a> <a id="4091" href="Data.Product.html#1806" class="Function">]</a> <a id="4093" class="Symbol">(</a><a id="4094" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4096" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="4098" href="SMT.Script.Show.html#4089" class="Bound">σ</a> <a id="4100" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4102" href="SMT.Theory.Base.html#3335" class="Function">Value</a> <a id="4108" href="SMT.Script.Show.html#4089" class="Bound">σ</a><a id="4109" class="Symbol">)</a> <a id="4111" class="Symbol">→</a> <a id="4113" href="SMT.Script.Show.html#3995" class="Function">MaybeModel</a> <a id="4124" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4126" class="Symbol">→</a> <a id="4128" href="SMT.Script.Show.html#3995" class="Function">MaybeModel</a> <a id="4139" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a>
    <a id="4145" href="SMT.Script.Show.html#4075" class="Function">insertMM</a> <a id="4154" class="Symbol">{</a><a id="4155" class="DottedPattern Symbol">.</a><a id="4156" href="SMT.Script.Show.html#4164" class="DottedPattern Bound">σ</a> <a id="4158" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4160" href="SMT.Script.Show.html#4160" class="Bound">Γ</a><a id="4161" class="Symbol">}</a> <a id="4163" class="Symbol">(</a><a id="4164" href="SMT.Script.Show.html#4164" class="Bound">σ</a> <a id="4166" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4168" class="Symbol">(</a><a id="4169" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="4174" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="4178" class="Symbol">)</a> <a id="4180" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4182" href="SMT.Script.Show.html#4182" class="Bound">v</a><a id="4183" class="Symbol">)</a> <a id="4185" class="Symbol">(</a><a id="4186" href="SMT.Script.Show.html#4186" class="Bound">vs</a> <a id="4189" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4191" href="SMT.Script.Show.html#4191" class="Bound">env</a><a id="4194" class="Symbol">)</a> <a id="4196" class="Symbol">=</a> <a id="4198" class="Symbol">(</a><a id="4199" href="SMT.Script.Show.html#4182" class="Bound">v</a> <a id="4201" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4203" href="SMT.Script.Show.html#4186" class="Bound">vs</a><a id="4205" class="Symbol">)</a> <a id="4207" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4209" href="SMT.Script.Show.html#4191" class="Bound">env</a>
    <a id="4217" href="SMT.Script.Show.html#4075" class="Function">insertMM</a> <a id="4226" class="Symbol">{</a><a id="4227" href="SMT.Script.Show.html#4227" class="Bound">σ′</a> <a id="4230" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4232" href="SMT.Script.Show.html#4232" class="Bound">Γ</a><a id="4233" class="Symbol">}</a> <a id="4235" class="Symbol">(</a><a id="4236" href="SMT.Script.Show.html#4236" class="Bound">σ</a> <a id="4238" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4240" class="Symbol">(</a><a id="4241" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="4247" href="SMT.Script.Show.html#4247" class="Bound">p</a><a id="4248" class="Symbol">)</a>   <a id="4252" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4254" href="SMT.Script.Show.html#4254" class="Bound">v</a><a id="4255" class="Symbol">)</a> <a id="4257" class="Symbol">(</a><a id="4258" href="SMT.Script.Show.html#4258" class="Bound">vs</a> <a id="4261" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4263" href="SMT.Script.Show.html#4263" class="Bound">env</a><a id="4266" class="Symbol">)</a> <a id="4268" class="Symbol">=</a> <a id="4270" href="SMT.Script.Show.html#4258" class="Bound">vs</a> <a id="4273" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4275" href="SMT.Script.Show.html#4075" class="Function">insertMM</a> <a id="4284" class="Symbol">(</a><a id="4285" href="SMT.Script.Show.html#4236" class="Bound">σ</a> <a id="4287" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4289" href="SMT.Script.Show.html#4247" class="Bound">p</a> <a id="4291" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4293" href="SMT.Script.Show.html#4254" class="Bound">v</a><a id="4294" class="Symbol">)</a> <a id="4296" href="SMT.Script.Show.html#4263" class="Bound">env</a>

    <a id="4305" href="SMT.Script.Show.html#4305" class="Function">mkMM</a> <a id="4310" class="Symbol">:</a> <a id="4312" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4317" class="Symbol">(</a><a id="4318" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="4323" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4324" class="Symbol">)</a> <a id="4326" class="Symbol">→</a> <a id="4328" href="SMT.Script.Show.html#3995" class="Function">MaybeModel</a> <a id="4339" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a>
    <a id="4345" href="SMT.Script.Show.html#4305" class="Function">mkMM</a> <a id="4350" class="Symbol">{</a><a id="4351" href="SMT.Script.Show.html#4351" class="Bound">Γ</a><a id="4352" class="Symbol">}</a> <a id="4354" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="4363" class="Symbol">=</a> <a id="4365" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="4376" class="Symbol">(λ</a> <a id="4379" href="SMT.Script.Show.html#4379" class="Bound Operator">_σ</a> <a id="4382" href="SMT.Script.Show.html#4382" class="Bound Operator">_Γ</a> <a id="4385" class="Symbol">→</a> <a id="4387" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4389" class="Symbol">)</a> <a id="4391" href="SMT.Script.Show.html#4351" class="Bound">Γ</a>
    <a id="4397" href="SMT.Script.Show.html#4305" class="Function">mkMM</a> <a id="4402" class="Symbol">{</a><a id="4403" href="SMT.Script.Show.html#4403" class="Bound">Γ</a><a id="4404" class="Symbol">}</a> <a id="4406" class="Symbol">(</a><a id="4407" href="SMT.Script.Show.html#4407" class="Bound">v</a> <a id="4409" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4411" href="SMT.Script.Show.html#4411" class="Bound">vs</a><a id="4413" class="Symbol">)</a> <a id="4415" class="Symbol">=</a> <a id="4417" href="SMT.Script.Show.html#4075" class="Function">insertMM</a> <a id="4426" href="SMT.Script.Show.html#4407" class="Bound">v</a> <a id="4428" class="Symbol">(</a><a id="4429" href="SMT.Script.Show.html#4305" class="Function">mkMM</a> <a id="4434" href="SMT.Script.Show.html#4411" class="Bound">vs</a><a id="4436" class="Symbol">)</a>

    <a id="4443" href="SMT.Script.Show.html#4443" class="Function">fromSingleton</a> <a id="4457" class="Symbol">:</a> <a id="4459" class="Symbol">{</a><a id="4460" href="SMT.Script.Show.html#4460" class="Bound">A</a> <a id="4462" class="Symbol">:</a> <a id="4464" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4467" class="Symbol">}</a> <a id="4469" class="Symbol">→</a> <a id="4471" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4476" href="SMT.Script.Show.html#4460" class="Bound">A</a> <a id="4478" class="Symbol">→</a> <a id="4480" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4486" href="SMT.Script.Show.html#4460" class="Bound">A</a>
    <a id="4492" href="SMT.Script.Show.html#4443" class="Function">fromSingleton</a> <a id="4506" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4509" class="Symbol">=</a> <a id="4511" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="4523" href="SMT.Script.Show.html#4443" class="Function">fromSingleton</a> <a id="4537" class="Symbol">(</a><a id="4538" href="SMT.Script.Show.html#4538" class="Bound">v</a> <a id="4540" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4542" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4544" class="Symbol">)</a> <a id="4546" class="Symbol">=</a> <a id="4548" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4553" href="SMT.Script.Show.html#4538" class="Bound">v</a>
    <a id="4559" href="SMT.Script.Show.html#4443" class="Function">fromSingleton</a> <a id="4573" class="Symbol">(_</a> <a id="4576" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4578" class="Symbol">_</a> <a id="4580" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4582" class="Symbol">_)</a> <a id="4585" class="Symbol">=</a> <a id="4587" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

    <a id="4600" href="SMT.Script.Show.html#4600" class="Function">checkMM</a> <a id="4608" class="Symbol">:</a> <a id="4610" href="SMT.Script.Show.html#3995" class="Function">MaybeModel</a> <a id="4621" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4623" class="Symbol">→</a> <a id="4625" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4631" class="Symbol">(</a><a id="4632" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="4638" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4639" class="Symbol">)</a>
    <a id="4645" href="SMT.Script.Show.html#4600" class="Function">checkMM</a> <a id="4653" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="4656" class="Symbol">=</a> <a id="4658" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4663" href="SMT.Script.Base.html#6612" class="InductiveConstructor">[]</a>
    <a id="4670" href="SMT.Script.Show.html#4600" class="Function">checkMM</a> <a id="4678" class="Symbol">(</a><a id="4679" href="SMT.Script.Show.html#4679" class="Bound">vs</a> <a id="4682" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4684" href="SMT.Script.Show.html#4684" class="Bound">env</a><a id="4687" class="Symbol">)</a> <a id="4689" class="Symbol">=</a> <a id="4691" href="Data.Maybe.Base.html#2868" class="Function">Maybe.zipWith</a> <a id="4705" href="SMT.Script.Base.html#6629" class="InductiveConstructor Operator">_∷_</a> <a id="4709" class="Symbol">(</a><a id="4710" href="SMT.Script.Show.html#4443" class="Function">fromSingleton</a> <a id="4724" href="SMT.Script.Show.html#4679" class="Bound">vs</a><a id="4726" class="Symbol">)</a> <a id="4728" class="Symbol">(</a><a id="4729" href="SMT.Script.Show.html#4600" class="Function">checkMM</a> <a id="4737" href="SMT.Script.Show.html#4684" class="Bound">env</a><a id="4740" class="Symbol">)</a>

  <a id="4745" href="SMT.Script.Show.html#4745" class="Function">pModelError</a> <a id="4757" class="Symbol">:</a> <a id="4759" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4762" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="4769" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="4771" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="4775" href="SMT.Script.Show.html#4745" class="Function">pModelError</a> <a id="4787" class="Symbol">=</a> <a id="4789" class="Symbol">_</a> <a id="4791" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="4794" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="4805" class="Symbol">(</a><a id="4806" href="Text.Parser.String.html#7204" class="Function">parens</a> <a id="4813" class="Symbol">(</a>
    <a id="4819" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="4823" class="Symbol">(</a><a id="4824" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="4831" class="String">&quot;error&quot;</a> <a id="4839" href="Text.Parser.String.html#4617" class="Function Operator">&amp;&gt;</a> <a id="4842" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="4846" class="Symbol">(</a><a id="4847" href="Text.Parser.String.html#6970" class="Function">between</a> <a id="4855" class="Symbol">(</a><a id="4856" href="Text.Parser.String.html#6052" class="Function">char</a> <a id="4861" class="String">&#39;&quot;&#39;</a><a id="4864" class="Symbol">)</a> <a id="4866" class="Symbol">(</a><a id="4867" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="4871" class="Symbol">(</a><a id="4872" href="Text.Parser.String.html#6052" class="Function">char</a> <a id="4877" class="String">&#39;&quot;&#39;</a><a id="4880" class="Symbol">))</a> <a id="4883" class="Symbol">(</a><a id="4884" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="4888" class="Symbol">(</a><a id="4889" href="Text.Parser.String.html#5973" class="Function">list⁺</a> <a id="4895" class="Symbol">(</a><a id="4896" href="Text.Parser.String.html#6120" class="Function">anyCharBut</a> <a id="4907" class="String">&#39;&quot;&#39;</a><a id="4910" class="Symbol">)))))))</a>

  <a id="4921" class="Comment">-- |Construct a model parser from a variable parser.</a>
  <a id="4976" href="SMT.Script.Show.html#4976" class="Function">mkModelParser</a> <a id="4990" class="Symbol">:</a> <a id="4992" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4995" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5002" class="Symbol">(</a><a id="5003" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="5007" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="5008" class="Symbol">)</a> <a id="5010" href="Relation.Unary.html#3359" class="Function">]</a> <a id="5012" class="Symbol">→</a> <a id="5014" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5017" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5024" class="Symbol">(</a><a id="5025" href="SMT.Script.Base.html#6670" class="Function">QualifiedModel</a> <a id="5040" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="5041" class="Symbol">)</a> <a id="5043" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="5047" href="SMT.Script.Show.html#4976" class="Function">mkModelParser</a> <a id="5061" class="Symbol">{</a><a id="5062" href="SMT.Script.Show.html#5062" class="Bound">Γ</a><a id="5063" class="Symbol">}</a> <a id="5065" href="SMT.Script.Show.html#5065" class="Bound">pVar</a> <a id="5070" class="Symbol">=</a> <a id="5072" class="Keyword">do</a>
    <a id="5079" href="SMT.Script.Show.html#5079" class="Bound">s</a> <a id="5081" href="Text.Parser.String.html#4324" class="Function Operator">←</a> <a id="5083" href="SMT.Script.Show.html#2811" class="Function">pSat</a>
    <a id="5092" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="5097" href="SMT.Script.Show.html#5079" class="Bound">s</a> <a id="5099" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="5102" class="Symbol">λ</a> <a id="5104" class="Keyword">where</a>
      <a id="5116" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>     <a id="5124" class="Symbol">→</a> <a id="5126" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5130" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5132" class="Symbol">(</a><a id="5133" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a> <a id="5137" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5139" class="Symbol">)</a>     <a id="5145" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5149" href="SMT.Script.Show.html#5349" class="Function">pModel</a>
      <a id="5162" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="5170" class="Symbol">→</a> <a id="5172" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5176" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5178" class="Symbol">(</a><a id="5179" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a> <a id="5185" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5187" class="Symbol">)</a>   <a id="5191" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5195" href="SMT.Script.Show.html#4745" class="Function">pModelError</a>
      <a id="5213" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5221" class="Symbol">→</a> <a id="5223" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5227" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5229" class="Symbol">(</a><a id="5230" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5238" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5240" class="Symbol">)</a> <a id="5242" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5246" href="SMT.Script.Show.html#4745" class="Function">pModelError</a>
    <a id="5262" class="Keyword">where</a>
      <a id="5274" class="Comment">-- Insert each definition into a model, and check if it is complete.</a>
      <a id="5349" href="SMT.Script.Show.html#5349" class="Function">pModel</a> <a id="5356" class="Symbol">:</a> <a id="5358" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5361" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5368" class="Symbol">(</a><a id="5369" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="5375" href="SMT.Script.Show.html#5062" class="Bound">Γ</a><a id="5376" class="Symbol">)</a> <a id="5378" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="5386" href="SMT.Script.Show.html#5349" class="Function">pModel</a> <a id="5393" class="Symbol">=</a> <a id="5395" href="Text.Parser.String.html#4234" class="Function">guardM</a> <a id="5402" href="SMT.Script.Show.html#4600" class="Function">checkMM</a> <a id="5410" class="Symbol">(</a><a id="5411" href="SMT.Script.Show.html#4305" class="Function">mkMM</a> <a id="5416" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5418" href="Data.List.NonEmpty.Base.html#1521" class="Function">List⁺.toList</a> <a id="5431" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5435" href="SMT.Script.Show.html#3799" class="Function">mkDefnsParser</a> <a id="5449" class="Symbol">{</a><a id="5450" href="SMT.Script.Show.html#5062" class="Bound">Γ</a><a id="5451" class="Symbol">}</a> <a id="5453" href="SMT.Script.Show.html#5065" class="Bound">pVar</a><a id="5457" class="Symbol">)</a>

      <a id="5466" href="SMT.Script.Show.html#5466" class="Function">pMaybeQualifiedModel</a> <a id="5487" class="Symbol">:</a> <a id="5489" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5492" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5499" class="Symbol">(</a><a id="5500" href="SMT.Script.Base.html#5888" class="Datatype">Sat</a> <a id="5504" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5506" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5512" class="Symbol">(</a><a id="5513" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="5519" href="SMT.Script.Show.html#5062" class="Bound">Γ</a><a id="5520" class="Symbol">))</a> <a id="5523" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="5531" href="SMT.Script.Show.html#5466" class="Function">pMaybeQualifiedModel</a> <a id="5552" class="Symbol">=</a> <a id="5554" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="5559" href="Text.Parser.String.html#4727" class="Function Operator">&lt;&amp;?&gt;</a> <a id="5564" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5568" href="SMT.Script.Show.html#5349" class="Function">pModel</a>

      <a id="5582" href="SMT.Script.Show.html#5582" class="Function">mkQualifiedModel</a> <a id="5599" class="Symbol">:</a> <a id="5601" href="SMT.Script.Base.html#5888" class="Datatype">Sat</a> <a id="5605" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5607" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5613" class="Symbol">(</a><a id="5614" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="5620" href="SMT.Script.Show.html#5062" class="Bound">Γ</a><a id="5621" class="Symbol">)</a> <a id="5623" class="Symbol">→</a> <a id="5625" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5631" class="Symbol">(</a><a id="5632" href="SMT.Script.Base.html#6670" class="Function">QualifiedModel</a> <a id="5647" href="SMT.Script.Show.html#5062" class="Bound">Γ</a><a id="5648" class="Symbol">)</a>
      <a id="5656" href="SMT.Script.Show.html#5582" class="Function">mkQualifiedModel</a> <a id="5673" class="Symbol">(</a><a id="5674" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>     <a id="5682" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5684" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5689" href="SMT.Script.Show.html#5689" class="Bound">m</a><a id="5690" class="Symbol">)</a>  <a id="5693" class="Symbol">=</a> <a id="5695" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5700" class="Symbol">(</a><a id="5701" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>     <a id="5709" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5711" href="SMT.Script.Show.html#5689" class="Bound">m</a><a id="5712" class="Symbol">)</a>
      <a id="5720" href="SMT.Script.Show.html#5582" class="Function">mkQualifiedModel</a> <a id="5737" class="Symbol">(</a><a id="5738" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="5746" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5748" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="5755" class="Symbol">)</a> <a id="5757" class="Symbol">=</a> <a id="5759" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5764" class="Symbol">(</a><a id="5765" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="5773" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5775" class="Symbol">_)</a>
      <a id="5784" href="SMT.Script.Show.html#5582" class="Function">mkQualifiedModel</a> <a id="5801" class="Symbol">(</a><a id="5802" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5810" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5812" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="5819" class="Symbol">)</a> <a id="5821" class="Symbol">=</a> <a id="5823" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5828" class="Symbol">(</a><a id="5829" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5837" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5839" class="Symbol">_)</a>
      <a id="5848" href="SMT.Script.Show.html#5582" class="CatchallClause Function">mkQualifiedModel</a><a id="5864" class="CatchallClause"> </a><a id="5865" class="CatchallClause Symbol">(_</a><a id="5867" class="CatchallClause">       </a><a id="5874" href="Agda.Builtin.Sigma.html#236" class="CatchallClause InductiveConstructor Operator">,</a><a id="5875" class="CatchallClause"> </a><a id="5876" class="CatchallClause Symbol">_)</a>       <a id="5885" class="Symbol">=</a> <a id="5887" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="5899" href="SMT.Script.Show.html#5899" class="Function">mkOutputParsers⁺</a> <a id="5916" class="Symbol">:</a> <a id="5918" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="5932" class="Symbol">(</a><a id="5933" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="5935" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5937" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="5938" class="Symbol">)</a> <a id="5940" class="Symbol">→</a> <a id="5942" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5945" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5952" class="Symbol">(</a><a id="5953" href="SMT.Script.Base.html#7262" class="Datatype">Outputs</a> <a id="5961" class="Symbol">(</a><a id="5962" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="5964" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5966" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="5967" class="Symbol">))</a> <a id="5970" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="5974" href="SMT.Script.Show.html#5899" class="Function">mkOutputParsers⁺</a> <a id="5991" class="Symbol">(</a><a id="5992" href="SMT.Script.Show.html#5992" class="Bound">op</a> <a id="5995" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="5997" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="5999" class="Symbol">)</a>          <a id="6010" class="Symbol">=</a> <a id="6012" class="Symbol">(</a><a id="6013" href="SMT.Script.Base.html#7322" class="InductiveConstructor Operator">_∷</a> <a id="6016" href="SMT.Script.Base.html#7303" class="InductiveConstructor">[]</a><a id="6018" class="Symbol">)</a> <a id="6020" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="6024" href="SMT.Script.Show.html#5992" class="Bound">op</a>
  <a id="6029" href="SMT.Script.Show.html#5899" class="Function">mkOutputParsers⁺</a> <a id="6046" class="Symbol">(</a><a id="6047" href="SMT.Script.Show.html#6047" class="Bound">op</a> <a id="6050" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6052" href="SMT.Script.Show.html#6052" class="Bound">ops</a><a id="6055" class="Symbol">@(_</a> <a id="6059" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6061" class="Symbol">_))</a> <a id="6065" class="Symbol">=</a> <a id="6067" href="Function.Base.html#1554" class="Function">flip</a> <a id="6072" href="SMT.Script.Base.html#7322" class="InductiveConstructor Operator">_∷_</a> <a id="6076" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="6080" href="SMT.Script.Show.html#5899" class="Function">mkOutputParsers⁺</a> <a id="6097" href="SMT.Script.Show.html#6052" class="Bound">ops</a> <a id="6101" href="Text.Parser.String.html#5722" class="Function Operator">&lt;*&gt;</a> <a id="6105" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="6109" href="SMT.Script.Show.html#6047" class="Bound">op</a>



<a id="6115" class="Comment">-- * Pretty printer</a>

<a id="6136" class="Keyword">module</a> <a id="6143" href="SMT.Script.Show.html#6143" class="Module">_</a> <a id="6145" class="Keyword">where</a>

  <a id="6154" class="Keyword">open</a> <a id="6159" class="Keyword">import</a> <a id="6166" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="6187" class="Symbol">as</a> <a id="6190" class="Module">StateCat</a> <a id="6199" class="Keyword">using</a> <a id="6205" class="Symbol">(</a><a id="6206" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="6220" class="Symbol">;</a> <a id="6222" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="6229" class="Symbol">)</a>
  <a id="6233" class="Keyword">open</a> <a id="6238" class="Keyword">import</a> <a id="6245" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="6264" class="Keyword">using</a> <a id="6270" class="Symbol">(</a><a id="6271" href="Relation.Unary.html#3359" class="Function">IUniversal</a><a id="6281" class="Symbol">;</a> <a id="6283" href="Text.Parser.String.html#3063" class="Function">Parser</a><a id="6289" class="Symbol">;</a> <a id="6291" href="Text.Parser.String.html#5634" class="Function Operator">_&lt;$_</a><a id="6295" class="Symbol">;</a> <a id="6297" href="Text.Parser.String.html#6575" class="Function">withSpaces</a><a id="6307" class="Symbol">;</a> <a id="6309" href="Text.Parser.String.html#6875" class="Function">exacts</a><a id="6315" class="Symbol">)</a>

  <a id="6320" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="6330" class="Symbol">:</a> <a id="6332" class="Symbol">(</a><a id="6333" href="SMT.Script.Show.html#6333" class="Bound">Γ</a> <a id="6335" href="SMT.Script.Show.html#6335" class="Bound">Γ′</a> <a id="6338" class="Symbol">:</a> <a id="6340" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a><a id="6344" class="Symbol">)</a> <a id="6346" class="Symbol">→</a> <a id="6348" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="6352" class="Symbol">→</a> <a id="6354" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="6360" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="6370" href="SMT.Script.Show.html#6370" class="Bound">Γ</a> <a id="6372" href="SMT.Script.Show.html#6372" class="Bound">Γ′</a> <a id="6375" href="SMT.Script.Show.html#6375" class="Bound">A</a> <a id="6377" class="Symbol">=</a> <a id="6379" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="6387" class="Symbol">(λ</a> <a id="6390" href="SMT.Script.Show.html#6390" class="Bound">Γ</a> <a id="6392" class="Symbol">→</a> <a id="6394" href="SMT.Script.Names.html#2385" class="Record">Names</a> <a id="6400" href="SMT.Script.Show.html#6390" class="Bound">Γ</a> <a id="6402" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6404" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="6415" href="SMT.Script.Show.html#6390" class="Bound">Γ</a><a id="6416" class="Symbol">)</a> <a id="6418" href="Function.Base.html#615" class="Function">id</a> <a id="6421" href="SMT.Script.Show.html#6370" class="Bound">Γ</a> <a id="6423" href="SMT.Script.Show.html#6372" class="Bound">Γ′</a> <a id="6426" href="SMT.Script.Show.html#6375" class="Bound">A</a>

  <a id="6431" class="Comment">-- When showing terms, we need to pass around a name state,</a>
  <a id="6493" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
  <a id="6560" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
  <a id="6624" class="Keyword">private</a>
    <a id="6636" href="SMT.Script.Show.html#6636" class="Function">monadStateNameState</a> <a id="6656" class="Symbol">=</a>
      <a id="6664" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="6691" class="Symbol">(λ</a> <a id="6694" href="SMT.Script.Show.html#6694" class="Bound">Γ</a> <a id="6696" class="Symbol">→</a> <a id="6698" href="SMT.Script.Names.html#2385" class="Record">Names</a> <a id="6704" href="SMT.Script.Show.html#6694" class="Bound">Γ</a> <a id="6706" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6708" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="6719" href="SMT.Script.Show.html#6694" class="Bound">Γ</a><a id="6720" class="Symbol">)</a> <a id="6722" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

  <a id="6740" class="Keyword">open</a> <a id="6745" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="6760" href="SMT.Script.Show.html#6636" class="Function">monadStateNameState</a>
    <a id="6784" class="Keyword">using</a> <a id="6790" class="Symbol">(</a><a id="6791" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="6797" class="Symbol">;</a> <a id="6799" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="6804" class="Symbol">;</a> <a id="6806" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="6810" class="Symbol">;</a> <a id="6812" href="Category.Monad.State.html#2831" class="Field">put</a><a id="6815" class="Symbol">;</a> <a id="6817" href="Category.Monad.State.html#2799" class="Field">get</a><a id="6820" class="Symbol">;</a> <a id="6822" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="6828" class="Symbol">)</a>

  <a id="6833" href="SMT.Script.Show.html#6833" class="Function">freshNameS</a> <a id="6844" class="Symbol">:</a> <a id="6846" class="Symbol">(</a><a id="6847" href="SMT.Script.Show.html#6847" class="Bound">n</a> <a id="6849" class="Symbol">:</a> <a id="6851" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="6857" class="Symbol">)</a> <a id="6859" class="Symbol">(</a><a id="6860" href="SMT.Script.Show.html#6860" class="Bound">σ</a> <a id="6862" class="Symbol">:</a> <a id="6864" href="SMT.Theory.Base.html#2591" class="Function">Sort</a><a id="6868" class="Symbol">)</a> <a id="6870" class="Symbol">→</a> <a id="6872" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="6882" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="6884" class="Symbol">(</a><a id="6885" href="SMT.Script.Show.html#6860" class="Bound">σ</a> <a id="6887" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6889" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="6890" class="Symbol">)</a> <a id="6892" href="SMT.Script.Names.html#1799" class="Function">Name</a>
  <a id="6899" href="SMT.Script.Show.html#6833" class="Function">freshNameS</a> <a id="6910" href="SMT.Script.Show.html#6910" class="Bound">n</a> <a id="6912" href="SMT.Script.Show.html#6912" class="Bound">σ</a> <a id="6914" class="Symbol">=</a> <a id="6916" class="Keyword">do</a>
    <a id="6923" class="Symbol">(</a><a id="6924" href="SMT.Script.Show.html#6924" class="Bound">ns</a> <a id="6927" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6929" href="SMT.Script.Show.html#6929" class="Bound">vps</a><a id="6932" class="Symbol">)</a> <a id="6934" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="6936" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="6944" class="Keyword">let</a> <a id="6948" class="Symbol">(</a><a id="6949" href="SMT.Script.Show.html#6949" class="Bound">n′</a> <a id="6952" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6954" href="SMT.Script.Show.html#6954" class="Bound">ns</a><a id="6956" class="Symbol">)</a> <a id="6958" class="Symbol">=</a> <a id="6960" href="SMT.Script.Names.html#2595" class="Function">freshName</a> <a id="6970" href="SMT.Script.Show.html#6910" class="Bound">n</a> <a id="6972" href="SMT.Script.Show.html#6912" class="Bound">σ</a> <a id="6974" href="SMT.Script.Show.html#6924" class="Bound">ns</a>
    <a id="6981" class="Keyword">let</a> <a id="6985" href="SMT.Script.Show.html#6985" class="Bound">vps</a> <a id="6989" class="Symbol">=</a> <a id="6991" class="Symbol">(</a><a id="6992" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="6997" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7002" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="7005" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="7016" class="Symbol">(</a><a id="7017" href="Text.Parser.String.html#6875" class="Function">exacts</a> <a id="7024" href="SMT.Script.Show.html#6949" class="Bound">n′</a><a id="7026" class="Symbol">))</a> <a id="7029" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7031" href="SMT.Script.Show.html#6929" class="Bound">vps</a>
    <a id="7039" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7043" class="Symbol">(</a><a id="7044" href="SMT.Script.Show.html#6954" class="Bound">ns</a> <a id="7047" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7049" href="SMT.Script.Show.html#6985" class="Bound">vps</a><a id="7052" class="Symbol">)</a>
    <a id="7058" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7065" href="SMT.Script.Show.html#6949" class="Bound">n′</a>

  <a id="7071" href="SMT.Script.Show.html#7071" class="Function">dropNameS</a> <a id="7081" class="Symbol">:</a> <a id="7083" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="7093" class="Symbol">(</a><a id="7094" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="7096" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7098" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="7099" class="Symbol">)</a> <a id="7101" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7103" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="7107" href="SMT.Script.Show.html#7071" class="Function">dropNameS</a> <a id="7117" class="Symbol">=</a> <a id="7119" class="Keyword">do</a>
    <a id="7126" class="Symbol">(</a><a id="7127" href="SMT.Script.Show.html#7127" class="Bound">ns</a> <a id="7130" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7132" class="Symbol">_</a> <a id="7134" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7136" href="SMT.Script.Show.html#7136" class="Bound">vps</a><a id="7139" class="Symbol">)</a> <a id="7141" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7143" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7151" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7155" class="Symbol">(</a><a id="7156" href="SMT.Script.Names.html#2921" class="Function">dropName</a> <a id="7165" href="SMT.Script.Show.html#7127" class="Bound">ns</a> <a id="7168" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7170" href="SMT.Script.Show.html#7136" class="Bound">vps</a><a id="7173" class="Symbol">)</a>
    <a id="7179" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7186" class="Symbol">_</a>

  <a id="7191" href="SMT.Script.Show.html#7191" class="Function">lookupNameS</a> <a id="7203" class="Symbol">:</a> <a id="7205" class="Symbol">(</a><a id="7206" href="SMT.Script.Show.html#7206" class="Bound">i</a> <a id="7208" class="Symbol">:</a> <a id="7210" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7212" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="7214" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a><a id="7215" class="Symbol">)</a> <a id="7217" class="Symbol">→</a> <a id="7219" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="7229" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7231" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7233" href="SMT.Script.Names.html#1799" class="Function">Name</a>
  <a id="7240" href="SMT.Script.Show.html#7191" class="Function">lookupNameS</a> <a id="7252" href="SMT.Script.Show.html#7252" class="Bound">p</a> <a id="7254" class="Symbol">=</a> <a id="7256" class="Keyword">do</a>
    <a id="7263" class="Symbol">(</a><a id="7264" href="SMT.Script.Show.html#7264" class="Bound">ns</a> <a id="7267" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7269" href="SMT.Script.Show.html#7269" class="Bound Operator">_vps</a><a id="7273" class="Symbol">)</a> <a id="7275" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7277" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7285" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7292" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7294" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="7305" class="Symbol">(</a><a id="7306" href="SMT.Script.Names.html#2426" class="Field">Names.nameEnv</a> <a id="7320" href="SMT.Script.Show.html#7264" class="Bound">ns</a><a id="7322" class="Symbol">)</a> <a id="7324" class="Symbol">(</a><a id="7325" href="Data.List.Relation.Unary.Any.html#1817" class="Function">Any.index</a> <a id="7335" href="SMT.Script.Show.html#7252" class="Bound">p</a><a id="7336" class="Symbol">)</a>


  <a id="7342" class="Comment">-- * Printing functions</a>

  <a id="7369" class="Keyword">mutual</a>

    <a id="7381" class="Comment">-- |Show a term as an S-expression.</a>
    <a id="7421" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="7431" class="Symbol">:</a> <a id="7433" href="SMT.Script.Base.html#3261" class="Datatype">Term</a> <a id="7438" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7440" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="7442" class="Symbol">→</a> <a id="7444" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="7454" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7456" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7458" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="7469" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="7479" class="Symbol">(</a><a id="7480" href="SMT.Script.Base.html#3306" class="InductiveConstructor">`var</a> <a id="7485" href="SMT.Script.Show.html#7485" class="Bound">i</a><a id="7486" class="Symbol">)</a> <a id="7488" class="Symbol">=</a> <a id="7490" class="Keyword">do</a>
      <a id="7499" href="SMT.Script.Show.html#7499" class="Bound">n</a> <a id="7501" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7503" href="SMT.Script.Show.html#7191" class="Function">lookupNameS</a> <a id="7515" href="SMT.Script.Show.html#7485" class="Bound">i</a>
      <a id="7523" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7530" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7532" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="7541" href="SMT.Script.Show.html#7499" class="Bound">n</a>
    <a id="7547" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="7557" class="Symbol">(</a><a id="7558" href="SMT.Script.Base.html#3356" class="InductiveConstructor">`lit</a> <a id="7563" href="SMT.Script.Show.html#7563" class="Bound">l</a><a id="7564" class="Symbol">)</a> <a id="7566" class="Symbol">=</a> <a id="7568" class="Keyword">do</a>
      <a id="7577" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7584" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7586" href="SMT.Theory.Base.html#3580" class="Function">showLiteral</a> <a id="7598" href="SMT.Script.Show.html#7563" class="Bound">l</a>
    <a id="7604" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="7614" class="Symbol">(</a><a id="7615" href="SMT.Script.Base.html#3410" class="InductiveConstructor">`app</a> <a id="7620" href="SMT.Script.Show.html#7620" class="Bound">x</a> <a id="7622" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="7624" class="Symbol">)</a> <a id="7626" class="Symbol">=</a> <a id="7628" class="Keyword">do</a>
      <a id="7637" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7644" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7646" href="SMT.Theory.Base.html#3633" class="Function">showIdentifier</a> <a id="7661" href="SMT.Script.Show.html#7620" class="Bound">x</a>
    <a id="7667" href="SMT.Script.Show.html#7421" class="CatchallClause Function">showTermS</a><a id="7676" class="CatchallClause"> </a><a id="7677" class="CatchallClause Symbol">(</a><a id="7678" href="SMT.Script.Base.html#3410" class="CatchallClause InductiveConstructor">`app</a><a id="7682" class="CatchallClause"> </a><a id="7683" href="SMT.Script.Show.html#7683" class="CatchallClause Bound">x</a><a id="7684" class="CatchallClause"> </a><a id="7685" href="SMT.Script.Show.html#7685" class="CatchallClause Bound">xs</a><a id="7687" class="CatchallClause Symbol">)</a> <a id="7689" class="Symbol">=</a> <a id="7691" class="Keyword">do</a>
      <a id="7700" class="Keyword">let</a> <a id="7704" href="SMT.Script.Show.html#7704" class="Bound">x</a> <a id="7706" class="Symbol">=</a> <a id="7708" href="SMT.Theory.Base.html#3633" class="Function">showIdentifier</a> <a id="7723" href="SMT.Script.Show.html#7683" class="Bound">x</a>
      <a id="7731" href="SMT.Script.Show.html#7731" class="Bound">xs</a> <a id="7734" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7736" href="SMT.Script.Show.html#8390" class="Function">showArgsS</a> <a id="7746" href="SMT.Script.Show.html#7685" class="Bound">xs</a>
      <a id="7755" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7762" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7764" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="7772" class="Symbol">(</a><a id="7773" href="SMT.Script.Show.html#7704" class="Bound">x</a> <a id="7775" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7777" href="SMT.Script.Show.html#7731" class="Bound">xs</a><a id="7779" class="Symbol">)</a>
    <a id="7785" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="7795" class="Symbol">(</a><a id="7796" href="SMT.Script.Base.html#3512" class="InductiveConstructor">`forall</a> <a id="7804" href="SMT.Script.Show.html#7804" class="Bound">n</a> <a id="7806" href="SMT.Script.Show.html#7806" class="Bound">σ</a> <a id="7808" href="SMT.Script.Show.html#7808" class="Bound">x</a><a id="7809" class="Symbol">)</a> <a id="7811" class="Symbol">=</a> <a id="7813" class="Keyword">do</a>
      <a id="7822" href="SMT.Script.Show.html#7822" class="Bound">n′</a> <a id="7825" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7827" href="SMT.Script.Show.html#6833" class="Function">freshNameS</a> <a id="7838" href="SMT.Script.Show.html#7804" class="Bound">n</a> <a id="7840" href="SMT.Script.Show.html#7806" class="Bound">σ</a>
      <a id="7848" href="SMT.Script.Show.html#7848" class="Bound">x</a> <a id="7850" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7852" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="7862" href="SMT.Script.Show.html#7808" class="Bound">x</a>
      <a id="7870" href="SMT.Script.Show.html#7071" class="Function">dropNameS</a>
      <a id="7886" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7893" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7895" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="7903" class="Symbol">(</a><a id="7904" class="String">&quot;forall&quot;</a> <a id="7913" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7915" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="7923" class="Symbol">(</a><a id="7924" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="7932" class="Symbol">(</a><a id="7933" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="7942" href="SMT.Script.Show.html#7822" class="Bound">n′</a> <a id="7945" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7947" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="7956" href="SMT.Script.Show.html#7806" class="Bound">σ</a> <a id="7958" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7960" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7962" class="Symbol">)</a> <a id="7964" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7966" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7968" class="Symbol">)</a> <a id="7970" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7972" href="SMT.Script.Show.html#7848" class="Bound">x</a> <a id="7974" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7976" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="7978" class="Symbol">)</a>
    <a id="7984" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="7994" class="Symbol">(</a><a id="7995" href="SMT.Script.Base.html#3597" class="InductiveConstructor">`exists</a> <a id="8003" href="SMT.Script.Show.html#8003" class="Bound">n</a> <a id="8005" href="SMT.Script.Show.html#8005" class="Bound">σ</a> <a id="8007" href="SMT.Script.Show.html#8007" class="Bound">x</a><a id="8008" class="Symbol">)</a> <a id="8010" class="Symbol">=</a> <a id="8012" class="Keyword">do</a>
      <a id="8021" href="SMT.Script.Show.html#8021" class="Bound">n′</a> <a id="8024" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8026" href="SMT.Script.Show.html#6833" class="Function">freshNameS</a> <a id="8037" href="SMT.Script.Show.html#8003" class="Bound">n</a> <a id="8039" href="SMT.Script.Show.html#8005" class="Bound">σ</a>
      <a id="8047" href="SMT.Script.Show.html#8047" class="Bound">x</a> <a id="8049" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8051" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="8061" href="SMT.Script.Show.html#8007" class="Bound">x</a>
      <a id="8069" href="SMT.Script.Show.html#7071" class="Function">dropNameS</a>
      <a id="8085" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8092" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8094" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8102" class="Symbol">(</a><a id="8103" class="String">&quot;exists&quot;</a> <a id="8112" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8114" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8122" class="Symbol">(</a><a id="8123" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8131" class="Symbol">(</a><a id="8132" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8141" href="SMT.Script.Show.html#8021" class="Bound">n′</a> <a id="8144" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8146" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="8155" href="SMT.Script.Show.html#8005" class="Bound">σ</a> <a id="8157" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8159" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8161" class="Symbol">)</a> <a id="8163" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8165" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8167" class="Symbol">)</a> <a id="8169" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8171" href="SMT.Script.Show.html#8047" class="Bound">x</a> <a id="8173" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8175" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8177" class="Symbol">)</a>
    <a id="8183" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="8193" class="Symbol">(</a><a id="8194" href="SMT.Script.Base.html#3682" class="InductiveConstructor">`let</a> <a id="8199" href="SMT.Script.Show.html#8199" class="Bound">n</a> <a id="8201" href="SMT.Script.Show.html#8201" class="Bound">σ</a> <a id="8203" href="SMT.Script.Show.html#8203" class="Bound">x</a> <a id="8205" href="SMT.Script.Show.html#8205" class="Bound">y</a><a id="8206" class="Symbol">)</a> <a id="8208" class="Symbol">=</a> <a id="8210" class="Keyword">do</a>
      <a id="8219" href="SMT.Script.Show.html#8219" class="Bound">x</a> <a id="8221" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8223" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="8233" href="SMT.Script.Show.html#8203" class="Bound">x</a>
      <a id="8241" href="SMT.Script.Show.html#8241" class="Bound">n</a> <a id="8243" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8245" href="SMT.Script.Show.html#6833" class="Function">freshNameS</a> <a id="8256" href="SMT.Script.Show.html#8199" class="Bound">n</a> <a id="8258" href="SMT.Script.Show.html#8201" class="Bound">σ</a>
      <a id="8266" href="SMT.Script.Show.html#8266" class="Bound">y</a> <a id="8268" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8270" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="8280" href="SMT.Script.Show.html#8205" class="Bound">y</a>
      <a id="8288" href="SMT.Script.Show.html#7071" class="Function">dropNameS</a>
      <a id="8304" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8311" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8313" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8321" class="Symbol">((</a><a id="8323" class="String">&quot;let&quot;</a> <a id="8329" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8331" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8339" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="8341" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8349" class="Symbol">(</a><a id="8350" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8359" href="SMT.Script.Show.html#8241" class="Bound">n</a> <a id="8361" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8363" href="SMT.Script.Show.html#8219" class="Bound">x</a> <a id="8365" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8367" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8369" class="Symbol">)</a> <a id="8371" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="8373" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8375" href="SMT.Script.Show.html#8266" class="Bound">y</a> <a id="8377" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8379" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8381" class="Symbol">)</a> <a id="8383" class="Symbol">)</a>

    <a id="8390" href="SMT.Script.Show.html#8390" class="Function">showArgsS</a> <a id="8400" class="Symbol">:</a> <a id="8402" href="SMT.Script.Base.html#3769" class="Function">Args</a> <a id="8407" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8409" href="SMT.Script.Show.html#1826" class="Generalizable">Δ</a> <a id="8411" class="Symbol">→</a> <a id="8413" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="8423" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8425" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8427" class="Symbol">(</a><a id="8428" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8433" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="8439" class="Symbol">)</a>
    <a id="8445" href="SMT.Script.Show.html#8390" class="Function">showArgsS</a> <a id="8455" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>       <a id="8464" class="Symbol">=</a> <a id="8466" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8473" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="8480" href="SMT.Script.Show.html#8390" class="Function">showArgsS</a> <a id="8490" class="Symbol">(</a><a id="8491" href="SMT.Script.Show.html#8491" class="Bound">x</a> <a id="8493" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="8495" href="SMT.Script.Show.html#8495" class="Bound">xs</a><a id="8497" class="Symbol">)</a> <a id="8499" class="Symbol">=</a> <a id="8501" class="Keyword">do</a> <a id="8504" href="SMT.Script.Show.html#8504" class="Bound">x</a> <a id="8506" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8508" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="8518" href="SMT.Script.Show.html#8491" class="Bound">x</a><a id="8519" class="Symbol">;</a> <a id="8521" href="SMT.Script.Show.html#8521" class="Bound">xs</a> <a id="8524" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8526" href="SMT.Script.Show.html#8390" class="Function">showArgsS</a> <a id="8536" href="SMT.Script.Show.html#8495" class="Bound">xs</a><a id="8538" class="Symbol">;</a> <a id="8540" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8547" class="Symbol">(</a><a id="8548" href="SMT.Script.Show.html#8504" class="Bound">x</a> <a id="8550" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8552" href="SMT.Script.Show.html#8521" class="Bound">xs</a><a id="8554" class="Symbol">)</a>

  <a id="8559" class="Comment">-- |Show a command as an S-expression, and build up an environment of output parsers.</a>
  <a id="8647" href="SMT.Script.Show.html#8647" class="Function">showCommandS</a> <a id="8660" class="Symbol">:</a> <a id="8662" href="SMT.Script.Base.html#9694" class="Datatype">Command</a> <a id="8670" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8672" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="8675" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a> <a id="8678" class="Symbol">→</a> <a id="8680" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="8690" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8692" class="Symbol">(</a><a id="8693" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="8696" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="8699" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="8700" class="Symbol">)</a> <a id="8702" class="Symbol">(</a><a id="8703" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="8710" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8712" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="8726" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a><a id="8728" class="Symbol">)</a>
  <a id="8732" href="SMT.Script.Show.html#8647" class="Function">showCommandS</a> <a id="8745" class="Symbol">(</a><a id="8746" href="SMT.Script.Base.html#9759" class="InductiveConstructor">`set-logic</a> <a id="8757" href="SMT.Script.Show.html#8757" class="Bound">l</a><a id="8758" class="Symbol">)</a> <a id="8760" class="Symbol">=</a> <a id="8762" class="Keyword">do</a>
    <a id="8769" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8776" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8778" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8786" class="Symbol">(</a><a id="8787" class="String">&quot;set-logic&quot;</a> <a id="8799" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8801" href="SMT.Script.Show.html#8757" class="Bound">l</a> <a id="8803" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8805" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8807" class="Symbol">)</a> <a id="8809" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8811" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="8816" href="SMT.Script.Show.html#8647" class="Function">showCommandS</a> <a id="8829" class="Symbol">(</a><a id="8830" href="SMT.Script.Base.html#9808" class="InductiveConstructor">`declare-const</a> <a id="8845" href="SMT.Script.Show.html#8845" class="Bound">n</a> <a id="8847" href="SMT.Script.Show.html#8847" class="Bound">σ</a><a id="8848" class="Symbol">)</a> <a id="8850" class="Symbol">=</a> <a id="8852" class="Keyword">do</a>
    <a id="8859" href="SMT.Script.Show.html#8859" class="Bound">n′</a> <a id="8862" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8864" href="SMT.Script.Show.html#6833" class="Function">freshNameS</a> <a id="8875" href="SMT.Script.Show.html#8845" class="Bound">n</a> <a id="8877" href="SMT.Script.Show.html#8847" class="Bound">σ</a>
    <a id="8883" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8890" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8892" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8900" class="Symbol">(</a><a id="8901" class="String">&quot;declare-const&quot;</a> <a id="8917" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8919" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8928" href="SMT.Script.Show.html#8859" class="Bound">n′</a> <a id="8931" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8933" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="8942" href="SMT.Script.Show.html#8847" class="Bound">σ</a> <a id="8944" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8946" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8948" class="Symbol">)</a> <a id="8950" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8952" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="8957" href="SMT.Script.Show.html#8647" class="Function">showCommandS</a> <a id="8970" class="Symbol">(</a><a id="8971" href="SMT.Script.Base.html#9875" class="InductiveConstructor">`assert</a> <a id="8979" href="SMT.Script.Show.html#8979" class="Bound">x</a><a id="8980" class="Symbol">)</a> <a id="8982" class="Symbol">=</a> <a id="8984" class="Keyword">do</a>
    <a id="8991" href="SMT.Script.Show.html#8991" class="Bound">x</a> <a id="8993" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8995" href="SMT.Script.Show.html#7421" class="Function">showTermS</a> <a id="9005" href="SMT.Script.Show.html#8979" class="Bound">x</a>
    <a id="9011" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9018" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9020" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9028" class="Symbol">(</a><a id="9029" class="String">&quot;assert&quot;</a> <a id="9038" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9040" href="SMT.Script.Show.html#8991" class="Bound">x</a> <a id="9042" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9044" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9046" class="Symbol">)</a> <a id="9048" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9050" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9055" href="SMT.Script.Show.html#8647" class="Function">showCommandS</a> <a id="9068" href="SMT.Script.Base.html#9924" class="InductiveConstructor">`check-sat</a> <a id="9079" class="Symbol">=</a> <a id="9081" class="Keyword">do</a>
    <a id="9088" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9095" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9097" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9105" class="Symbol">(</a><a id="9106" class="String">&quot;check-sat&quot;</a> <a id="9118" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9120" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9122" class="Symbol">)</a> <a id="9124" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9126" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="9131" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="9133" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9138" href="SMT.Script.Show.html#8647" class="Function">showCommandS</a> <a id="9151" href="SMT.Script.Base.html#9967" class="InductiveConstructor">`get-model</a> <a id="9162" class="Symbol">=</a> <a id="9164" class="Keyword">do</a>
    <a id="9171" class="Symbol">(</a><a id="9172" href="SMT.Script.Show.html#9172" class="Bound Operator">_ns</a> <a id="9176" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9178" href="SMT.Script.Show.html#9178" class="Bound">vps</a><a id="9181" class="Symbol">)</a> <a id="9183" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9185" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="9193" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9200" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9202" href="Data.String.Base.html#2767" class="Function">String.unlines</a> <a id="9217" class="Symbol">(</a> <a id="9219" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9227" class="Symbol">(</a><a id="9228" class="String">&quot;check-sat&quot;</a> <a id="9240" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9242" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9244" class="Symbol">)</a>
                            <a id="9274" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9276" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9284" class="Symbol">(</a><a id="9285" class="String">&quot;get-model&quot;</a> <a id="9297" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9299" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9301" class="Symbol">)</a> <a id="9303" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9305" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9308" class="Symbol">)</a>
           <a id="9321" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9323" href="SMT.Script.Show.html#4976" class="Function">mkModelParser</a> <a id="9337" class="Symbol">(</a><a id="9338" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="9350" href="SMT.Script.Show.html#9178" class="Bound">vps</a><a id="9353" class="Symbol">)</a> <a id="9355" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="9357" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>

  <a id="9363" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
  <a id="9450" href="SMT.Script.Show.html#9450" class="Function">showScriptS</a> <a id="9462" class="Symbol">:</a> <a id="9464" href="SMT.Script.Base.html#10107" class="Datatype">Script</a> <a id="9471" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9473" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="9476" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="9478" class="Symbol">→</a> <a id="9480" href="SMT.Script.Show.html#6320" class="Function">NameState</a> <a id="9490" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9492" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="9495" class="Symbol">(</a><a id="9496" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9501" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="9508" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9510" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="9524" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="9525" class="Symbol">)</a>
  <a id="9529" href="SMT.Script.Show.html#9450" class="Function">showScriptS</a> <a id="9541" href="SMT.Script.Base.html#10170" class="InductiveConstructor">[]</a> <a id="9544" class="Symbol">=</a> <a id="9546" class="Keyword">do</a>
    <a id="9553" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9560" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9562" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9565" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9567" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9572" href="SMT.Script.Show.html#9450" class="Function">showScriptS</a> <a id="9584" class="Symbol">(</a><a id="9585" href="SMT.Script.Show.html#9585" class="Bound">cmd</a> <a id="9589" href="SMT.Script.Base.html#10192" class="InductiveConstructor Operator">∷</a> <a id="9591" href="SMT.Script.Show.html#9591" class="Bound">scr</a><a id="9594" class="Symbol">)</a> <a id="9596" class="Symbol">=</a> <a id="9598" class="Keyword">do</a>
    <a id="9605" class="Symbol">(</a><a id="9606" href="SMT.Script.Show.html#9606" class="Bound">cmd</a> <a id="9610" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9612" href="SMT.Script.Show.html#9612" class="Bound">ops₁</a><a id="9616" class="Symbol">)</a> <a id="9618" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9620" href="SMT.Script.Show.html#8647" class="Function">showCommandS</a> <a id="9633" href="SMT.Script.Show.html#9585" class="Bound">cmd</a>
    <a id="9641" class="Symbol">(</a><a id="9642" href="SMT.Script.Show.html#9642" class="Bound">scr</a> <a id="9646" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9648" href="SMT.Script.Show.html#9648" class="Bound">ops₂</a><a id="9652" class="Symbol">)</a> <a id="9654" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9656" href="SMT.Script.Show.html#9450" class="Function">showScriptS</a> <a id="9668" href="SMT.Script.Show.html#9591" class="Bound">scr</a>
    <a id="9676" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9683" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9685" href="SMT.Script.Show.html#9606" class="Bound">cmd</a> <a id="9689" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9691" href="SMT.Script.Show.html#9642" class="Bound">scr</a> <a id="9695" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9697" href="Data.Environment.html#1225" class="Function">Env.append</a> <a id="9708" href="Function.Base.html#615" class="Function">id</a> <a id="9711" href="SMT.Script.Show.html#9612" class="Bound">ops₁</a> <a id="9716" href="SMT.Script.Show.html#9648" class="Bound">ops₂</a>

  <a id="9724" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
  <a id="9809" href="SMT.Script.Show.html#9809" class="Function">showScript</a> <a id="9820" class="Symbol">:</a> <a id="9822" href="SMT.Script.Base.html#10107" class="Datatype">Script</a> <a id="9829" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9832" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9834" class="Symbol">(</a><a id="9835" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="9837" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9839" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="9840" class="Symbol">)</a> <a id="9842" class="Symbol">→</a> <a id="9844" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="9851" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9853" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="9856" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="9863" class="Symbol">(</a><a id="9864" href="SMT.Script.Base.html#7262" class="Datatype">Outputs</a> <a id="9872" class="Symbol">(</a><a id="9873" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="9875" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9877" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="9878" class="Symbol">))</a> <a id="9881" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="9885" href="SMT.Script.Show.html#9809" class="Function">showScript</a> <a id="9896" href="SMT.Script.Show.html#9896" class="Bound">scr</a> <a id="9900" class="Symbol">=</a> <a id="9902" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="9911" href="Data.String.Base.html#2767" class="Function">String.unlines</a> <a id="9926" href="SMT.Script.Show.html#5899" class="Function">mkOutputParsers⁺</a> <a id="9943" class="Symbol">(</a><a id="9944" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9950" class="Symbol">(</a><a id="9951" href="SMT.Script.Show.html#9450" class="Function">showScriptS</a> <a id="9963" href="SMT.Script.Show.html#9896" class="Bound">scr</a> <a id="9967" class="Symbol">(</a><a id="9968" href="SMT.Script.Names.html#3140" class="Function">x′es</a> <a id="9973" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9975" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="9977" class="Symbol">)))</a>

  <a id="9984" class="Comment">-- |Get the variable parser for a script (for debugging purposes).</a>
  <a id="10053" href="SMT.Script.Show.html#10053" class="Function">getVarParser</a> <a id="10066" class="Symbol">:</a> <a id="10068" href="SMT.Script.Base.html#10107" class="Datatype">Script</a> <a id="10075" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10078" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="10080" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="10082" class="Symbol">→</a> <a id="10084" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="10087" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="10094" class="Symbol">(</a><a id="10095" href="Data.Product.html#1806" class="Function">∃[</a> <a id="10098" href="SMT.Script.Show.html#10098" class="Bound">σ</a> <a id="10100" href="Data.Product.html#1806" class="Function">]</a> <a id="10102" class="Symbol">(</a><a id="10103" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="10105" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="10107" href="SMT.Script.Show.html#10098" class="Bound">σ</a><a id="10108" class="Symbol">))</a> <a id="10111" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="10115" href="SMT.Script.Show.html#10053" class="Function">getVarParser</a> <a id="10128" href="SMT.Script.Show.html#10128" class="Bound">scr</a> <a id="10132" class="Symbol">=</a> <a id="10134" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="10146" class="Symbol">(</a><a id="10147" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10153" class="Symbol">(</a><a id="10154" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10160" class="Symbol">(</a><a id="10161" href="SMT.Script.Show.html#9450" class="Function">showScriptS</a> <a id="10173" href="SMT.Script.Show.html#10128" class="Bound">scr</a> <a id="10177" class="Symbol">(</a><a id="10178" href="SMT.Script.Names.html#3140" class="Function">x′es</a> <a id="10183" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10185" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="10187" class="Symbol">))))</a>
</pre></body></html>