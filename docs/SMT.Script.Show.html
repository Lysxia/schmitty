<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script.Show</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Comment">--------------------------------------------------------------------------------</a>
<a id="113" class="Comment">-- Schmitty the Solver</a>
<a id="136" class="Comment">--</a>
<a id="139" class="Comment">-- Defines `showScript`, which prints a script as an SMT query, as well as</a>
<a id="214" class="Comment">-- generating a parser which parses the output generated by the SMT solver for</a>
<a id="293" class="Comment">-- the query.</a>
<a id="307" class="Comment">--------------------------------------------------------------------------------</a>

<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="SMT.Theory.Base.html" class="Module">SMT.Theory.Base</a>

<a id="418" class="Keyword">module</a> <a id="425" href="SMT.Script.Show.html" class="Module">SMT.Script.Show</a> <a id="441" class="Symbol">(</a><a id="442" href="SMT.Script.Show.html#442" class="Bound">theory</a> <a id="449" class="Symbol">:</a> <a id="451" href="SMT.Theory.Base.html#3890" class="Record">Theory</a><a id="457" class="Symbol">)</a> <a id="459" class="Keyword">where</a>

<a id="466" class="Keyword">open</a> <a id="471" href="SMT.Theory.Base.html#3890" class="Module">Theory</a> <a id="478" href="SMT.Script.Show.html#442" class="Bound">theory</a>

<a id="486" class="Keyword">open</a> <a id="491" class="Keyword">import</a> <a id="498" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="547" class="Symbol">as</a> <a id="550" class="Module">Stream</a> <a id="557" class="Keyword">using</a> <a id="563" class="Symbol">(</a><a id="564" href="Codata.Musical.Stream.html#659" class="Datatype">Stream</a><a id="570" class="Symbol">)</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Data.Char.html" class="Module">Data.Char</a> <a id="594" class="Symbol">as</a> <a id="597" class="Module">Char</a> <a id="602" class="Keyword">using</a> <a id="608" class="Symbol">(</a><a id="609" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="613" class="Symbol">)</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="644" class="Symbol">as</a> <a id="647" class="Module">Env</a> <a id="651" class="Keyword">using</a> <a id="657" class="Symbol">(</a><a id="658" href="Data.Environment.html#360" class="Datatype">Env</a><a id="661" class="Symbol">;</a> <a id="663" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="666" class="Symbol">;</a> <a id="668" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="670" class="Symbol">)</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="693" class="Symbol">as</a> <a id="696" class="Module">Fin</a> <a id="700" class="Keyword">using</a> <a id="706" class="Symbol">(</a><a id="707" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a><a id="710" class="Symbol">;</a> <a id="712" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a><a id="715" class="Symbol">;</a> <a id="717" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a><a id="721" class="Symbol">)</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Data.List.html" class="Module">Data.List</a> <a id="745" class="Symbol">as</a> <a id="748" class="Module">List</a> <a id="753" class="Keyword">using</a> <a id="759" class="Symbol">(</a><a id="760" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="764" class="Symbol">;</a> <a id="766" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="769" class="Symbol">;</a> <a id="771" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="773" class="Symbol">;</a> <a id="775" href="Data.List.Base.html#5025" class="Function Operator">[_]</a><a id="778" class="Symbol">;</a> <a id="780" href="Data.List.Base.html#9934" class="Function Operator">_ʳ++_</a><a id="785" class="Symbol">;</a> <a id="787" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="791" class="Symbol">;</a> <a id="793" href="Data.List.Base.html#4864" class="Function">length</a><a id="799" class="Symbol">)</a>
<a id="801" class="Keyword">open</a> <a id="806" class="Keyword">import</a> <a id="813" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="842" class="Symbol">as</a> <a id="845" class="Module">All</a> <a id="849" class="Keyword">using</a> <a id="855" class="Symbol">(</a><a id="856" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a><a id="859" class="Symbol">;</a> <a id="861" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">_∷_</a><a id="864" class="Symbol">;</a> <a id="866" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="868" class="Symbol">)</a>
<a id="870" class="Keyword">open</a> <a id="875" class="Keyword">import</a> <a id="882" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="911" class="Symbol">as</a> <a id="914" class="Module">Any</a> <a id="918" class="Keyword">using</a> <a id="924" class="Symbol">(</a><a id="925" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a><a id="929" class="Symbol">;</a> <a id="931" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a><a id="936" class="Symbol">)</a>
<a id="938" class="Keyword">open</a> <a id="943" class="Keyword">import</a> <a id="950" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="969" class="Symbol">as</a> <a id="972" class="Module">List⁺</a> <a id="978" class="Keyword">using</a> <a id="984" class="Symbol">(</a><a id="985" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a><a id="990" class="Symbol">;</a> <a id="992" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">_∷_</a><a id="995" class="Symbol">)</a>
<a id="997" class="Keyword">open</a> <a id="1002" class="Keyword">import</a> <a id="1009" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1020" class="Symbol">as</a> <a id="1023" class="Module">Maybe</a> <a id="1029" class="Keyword">using</a> <a id="1035" class="Symbol">(</a><a id="1036" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="1041" class="Symbol">;</a> <a id="1043" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="1047" class="Symbol">;</a> <a id="1049" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="1056" class="Symbol">)</a>
<a id="1058" class="Keyword">import</a> <a id="1065" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="1088" class="Symbol">as</a> <a id="1091" class="Module">MaybeCat</a>
<a id="1100" class="Keyword">open</a> <a id="1105" class="Keyword">import</a> <a id="1112" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1121" class="Symbol">as</a> <a id="1124" class="Module">Nat</a> <a id="1128" class="Keyword">using</a> <a id="1134" class="Symbol">(</a><a id="1135" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1136" class="Symbol">;</a> <a id="1138" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1141" class="Symbol">;</a> <a id="1143" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1147" class="Symbol">)</a>
<a id="1149" class="Keyword">open</a> <a id="1154" class="Keyword">import</a> <a id="1161" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="1175" class="Keyword">renaming</a> <a id="1184" class="Symbol">(</a><a id="1185" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1190" class="Symbol">to</a> <a id="1193" class="Function">showℕ</a><a id="1198" class="Symbol">)</a>
<a id="1200" class="Keyword">open</a> <a id="1205" class="Keyword">import</a> <a id="1212" href="Data.Product.html" class="Module">Data.Product</a> <a id="1225" class="Symbol">as</a> <a id="1228" class="Module">Prod</a> <a id="1233" class="Keyword">using</a> <a id="1239" class="Symbol">(</a><a id="1240" href="Data.Product.html#1369" class="Function">∃</a><a id="1241" class="Symbol">;</a> <a id="1243" href="Data.Product.html#1806" class="Function">∃-syntax</a><a id="1251" class="Symbol">;</a> <a id="1253" href="Data.Product.html#2247" class="Function Operator">-,_</a><a id="1256" class="Symbol">;</a> <a id="1258" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="1261" class="Symbol">;</a> <a id="1263" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1266" class="Symbol">;</a> <a id="1268" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1273" class="Symbol">;</a> <a id="1275" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1280" class="Symbol">)</a>
<a id="1282" class="Keyword">open</a> <a id="1287" class="Keyword">import</a> <a id="1294" href="Data.String.html" class="Module">Data.String</a> <a id="1306" class="Symbol">as</a> <a id="1309" class="Module">String</a> <a id="1316" class="Keyword">using</a> <a id="1322" class="Symbol">(</a><a id="1323" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1329" class="Symbol">)</a>
<a id="1331" class="Keyword">open</a> <a id="1336" class="Keyword">import</a> <a id="1343" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1353" class="Symbol">as</a> <a id="1356" class="Module">Unit</a> <a id="1361" class="Keyword">using</a> <a id="1367" class="Symbol">(</a><a id="1368" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1369" class="Symbol">)</a>
<a id="1371" class="Keyword">open</a> <a id="1376" class="Keyword">import</a> <a id="1383" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1392" class="Symbol">as</a> <a id="1395" class="Module">Vec</a> <a id="1399" class="Keyword">using</a> <a id="1405" class="Symbol">(</a><a id="1406" href="Data.Vec.Base.html#998" class="Datatype">Vec</a><a id="1409" class="Symbol">;</a> <a id="1411" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">_∷_</a><a id="1414" class="Symbol">;</a> <a id="1416" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="1418" class="Symbol">)</a>
<a id="1420" class="Keyword">open</a> <a id="1425" class="Keyword">import</a> <a id="1432" href="Function.html" class="Module">Function</a> <a id="1441" class="Keyword">using</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1451" class="Symbol">;</a> <a id="1453" href="Function.Base.html#4121" class="Function Operator">case_of_</a><a id="1461" class="Symbol">;</a> <a id="1463" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1466" class="Symbol">;</a> <a id="1468" href="Function.Base.html#636" class="Function">const</a><a id="1473" class="Symbol">;</a> <a id="1475" href="Function.Base.html#1554" class="Function">flip</a><a id="1479" class="Symbol">;</a> <a id="1481" href="Function.Base.html#615" class="Function">id</a><a id="1483" class="Symbol">)</a>
<a id="1485" class="Keyword">import</a> <a id="1492" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1522" class="Symbol">as</a> <a id="1525" class="Module">Identity</a>
<a id="1534" class="Keyword">import</a> <a id="1541" href="Level.html" class="Module">Level</a>
<a id="1547" class="Keyword">import</a> <a id="1554" href="Reflection.html" class="Module">Reflection</a> <a id="1565" class="Symbol">as</a> <a id="1568" class="Module">Rfl</a>
<a id="1572" class="Keyword">open</a> <a id="1577" class="Keyword">import</a> <a id="1584" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1601" class="Keyword">using</a> <a id="1607" class="Symbol">(</a><a id="1608" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="1611" class="Symbol">;</a> <a id="1613" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="1615" class="Symbol">)</a>
<a id="1617" class="Keyword">open</a> <a id="1622" class="Keyword">import</a> <a id="1629" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1667" class="Keyword">using</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1677" class="Symbol">;</a> <a id="1679" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1683" class="Symbol">)</a>
<a id="1685" class="Keyword">open</a> <a id="1690" class="Keyword">import</a> <a id="1697" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1713" href="SMT.Theory.Base.html#3922" class="Field">baseTheory</a>
<a id="1724" class="Keyword">open</a> <a id="1729" class="Keyword">import</a> <a id="1736" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1753" href="SMT.Theory.Base.html#3922" class="Field">baseTheory</a>

<a id="1765" class="Keyword">private</a>
  <a id="1775" class="Keyword">variable</a>
    <a id="1788" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="1790" href="SMT.Script.Show.html#1790" class="Generalizable">σ′</a>    <a id="1796" class="Symbol">:</a> <a id="1798" href="SMT.Theory.Base.html#2591" class="Function">Sort</a>
    <a id="1807" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="1809" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="1812" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="1815" class="Symbol">:</a> <a id="1817" href="SMT.Script.Base.html#2516" class="Function">Ctxt</a>
    <a id="1826" href="SMT.Script.Show.html#1826" class="Generalizable">Δ</a> <a id="1828" href="SMT.Script.Show.html#1828" class="Generalizable">Δ′</a>    <a id="1834" class="Symbol">:</a> <a id="1836" href="SMT.Script.Base.html#2516" class="Function">Ctxt</a>
    <a id="1845" href="SMT.Script.Show.html#1845" class="Generalizable">Σ</a>       <a id="1853" class="Symbol">:</a> <a id="1855" href="SMT.Theory.Base.html#1984" class="Record">Signature</a> <a id="1865" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a>
    <a id="1871" href="SMT.Script.Show.html#1871" class="Generalizable">Σ′</a>      <a id="1879" class="Symbol">:</a> <a id="1881" href="SMT.Theory.Base.html#1984" class="Record">Signature</a> <a id="1891" href="SMT.Script.Show.html#1790" class="Generalizable">σ′</a>
    <a id="1898" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="1900" href="SMT.Script.Show.html#1900" class="Generalizable">ξ′</a>    <a id="1906" class="Symbol">:</a> <a id="1908" href="SMT.Script.Base.html#5651" class="Datatype">OutputType</a>
    <a id="1923" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="1925" href="SMT.Script.Show.html#1925" class="Generalizable">Ξ′</a> <a id="1928" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a> <a id="1931" class="Symbol">:</a> <a id="1933" href="SMT.Script.Base.html#5745" class="Function">OutputCtxt</a>


<a id="1946" class="Comment">-- * Parsers</a>

<a id="1960" class="Keyword">module</a> <a id="1967" href="SMT.Script.Show.html#1967" class="Module">_</a> <a id="1969" class="Keyword">where</a>

  <a id="1978" class="Keyword">open</a> <a id="1983" class="Keyword">import</a> <a id="1990" href="Text.Parser.String.html" class="Module">Text.Parser.String</a>

  <a id="2012" class="Comment">-- * Variable parsers</a>

  <a id="2037" class="Comment">-- |Environment of variable parsers.</a>
  <a id="2076" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2087" class="Symbol">:</a> <a id="2089" href="SMT.Script.Base.html#2516" class="Function">Ctxt</a> <a id="2094" class="Symbol">→</a> <a id="2096" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2102" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2113" class="Symbol">=</a> <a id="2115" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2119" class="Symbol">(λ</a> <a id="2122" href="SMT.Script.Show.html#2122" class="Bound">σ</a> <a id="2124" href="SMT.Script.Show.html#2124" class="Bound">Γ</a> <a id="2126" class="Symbol">→</a> <a id="2128" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2131" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="2138" class="Symbol">((</a><a id="2140" href="SMT.Script.Show.html#2122" class="Bound">σ</a> <a id="2142" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2144" href="SMT.Script.Show.html#2124" class="Bound">Γ</a><a id="2145" class="Symbol">)</a> <a id="2147" href="SMT.Script.Base.html#2739" class="Function Operator">∋</a> <a id="2149" href="SMT.Script.Show.html#2122" class="Bound">σ</a><a id="2150" class="Symbol">)</a> <a id="2152" href="Relation.Unary.html#3359" class="Function">]</a><a id="2153" class="Symbol">)</a>

  <a id="2158" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
  <a id="2240" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2252" class="Symbol">:</a> <a id="2254" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2265" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="2267" class="Symbol">→</a> <a id="2269" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2272" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="2279" class="Symbol">(</a><a id="2280" href="Data.Product.html#1806" class="Function">∃[</a> <a id="2283" href="SMT.Script.Show.html#2283" class="Bound">σ</a> <a id="2285" href="Data.Product.html#1806" class="Function">]</a> <a id="2287" class="Symbol">(</a><a id="2288" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="2290" href="SMT.Script.Base.html#2739" class="Function Operator">∋</a> <a id="2292" href="SMT.Script.Show.html#2283" class="Bound">σ</a><a id="2293" class="Symbol">))</a> <a id="2296" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2300" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2312" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="2326" class="Symbol">=</a> <a id="2328" href="Text.Parser.html#3882" class="Function">fail</a>
  <a id="2335" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2347" class="Symbol">(</a><a id="2348" href="SMT.Script.Show.html#2348" class="Bound">p</a> <a id="2350" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="2352" href="SMT.Script.Show.html#2352" class="Bound">env</a><a id="2355" class="Symbol">)</a> <a id="2357" class="Symbol">{</a><a id="2358" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2359" class="Symbol">}</a> <a id="2361" class="Symbol">=</a> <a id="2363" class="Symbol">(</a><a id="2364" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="2368" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="2372" href="SMT.Script.Show.html#2348" class="Bound">p</a> <a id="2374" class="Symbol">{</a><a id="2375" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2376" class="Symbol">})</a> <a id="2379" href="Text.Parser.html#3943" class="Function Operator">&lt;|&gt;</a> <a id="2383" class="Symbol">(</a><a id="2384" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="2393" href="Function.Base.html#615" class="Function">id</a> <a id="2396" href="SMT.Script.Base.html#2788" class="Function">extendVar</a> <a id="2406" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="2410" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2422" href="SMT.Script.Show.html#2352" class="Bound">env</a> <a id="2426" class="Symbol">{</a><a id="2427" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2428" class="Symbol">})</a>


  <a id="2435" class="Comment">-- * Output parsers</a>

  <a id="2458" class="Comment">-- |Mapping from output types to parser types.</a>
  <a id="2507" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2520" class="Symbol">:</a> <a id="2522" href="SMT.Script.Base.html#5651" class="Datatype">OutputType</a> <a id="2533" class="Symbol">→</a> <a id="2535" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2541" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2554" href="SMT.Script.Show.html#2554" class="Bound">ξ</a> <a id="2556" class="Symbol">=</a> <a id="2558" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2561" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="2568" class="Symbol">(</a><a id="2569" href="SMT.Script.Base.html#6872" class="Function">Output</a> <a id="2576" href="SMT.Script.Show.html#2554" class="Bound">ξ</a><a id="2577" class="Symbol">)</a> <a id="2579" href="Relation.Unary.html#3359" class="Function">]</a>

  <a id="2584" class="Comment">-- |Mapping from output contexts to parser types.</a>
  <a id="2636" class="Comment">--</a>
  <a id="2641" class="Comment">-- TODO: Replace use of Env with All.</a>
  <a id="2681" class="Comment">--</a>
  <a id="2686" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="2700" class="Symbol">:</a> <a id="2702" href="SMT.Script.Base.html#5745" class="Function">OutputCtxt</a> <a id="2713" class="Symbol">→</a> <a id="2715" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2721" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="2735" href="SMT.Script.Show.html#2735" class="Bound">Ξ</a> <a id="2737" class="Symbol">=</a> <a id="2739" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2743" class="Symbol">(λ</a> <a id="2746" href="SMT.Script.Show.html#2746" class="Bound">ξ</a> <a id="2748" href="SMT.Script.Show.html#2748" class="Bound Operator">_Ξ</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2766" href="SMT.Script.Show.html#2746" class="Bound">ξ</a><a id="2767" class="Symbol">)</a> <a id="2769" href="SMT.Script.Show.html#2735" class="Bound">Ξ</a>

  <a id="2774" class="Comment">-- |Parse a satisfiability result.</a>
  <a id="2811" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2816" class="Symbol">:</a> <a id="2818" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2821" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="2828" href="SMT.Script.Base.html#5896" class="Datatype">Sat</a> <a id="2832" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2836" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2841" class="Symbol">=</a> <a id="2843" href="SMT.Script.Base.html#5914" class="InductiveConstructor">sat</a>    <a id="2850" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="2853" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="2860" class="String">&quot;sat&quot;</a>
    <a id="2870" href="Text.Parser.html#3943" class="Function Operator">&lt;|&gt;</a> <a id="2874" href="SMT.Script.Base.html#5930" class="InductiveConstructor">unsat</a>   <a id="2882" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="2885" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="2892" class="String">&quot;unsat&quot;</a>
    <a id="2904" href="Text.Parser.html#3943" class="Function Operator">&lt;|&gt;</a> <a id="2908" href="SMT.Script.Base.html#5946" class="InductiveConstructor">unknown</a> <a id="2916" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="2919" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="2926" class="String">&quot;unknown&quot;</a>

  <a id="2939" href="SMT.Script.Show.html#2939" class="Function">_</a> <a id="2941" class="Symbol">:</a> <a id="2943" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2948" href="Text.Parser.String.html#1180" class="Function Operator">parses</a> <a id="2955" class="String">&quot;sat&quot;</a>
  <a id="2963" class="Symbol">_</a> <a id="2965" class="Symbol">=</a> <a id="2967" href="Data.Singleton.html#386" class="InductiveConstructor Operator">!</a> <a id="2969" href="SMT.Script.Base.html#5914" class="InductiveConstructor">sat</a>

  <a id="2976" href="SMT.Script.Show.html#2976" class="Function">_</a> <a id="2978" class="Symbol">:</a> <a id="2980" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2985" href="Text.Parser.String.html#1180" class="Function Operator">parses</a> <a id="2992" class="String">&quot;unsat&quot;</a>
  <a id="3002" class="Symbol">_</a> <a id="3004" class="Symbol">=</a> <a id="3006" href="Data.Singleton.html#386" class="InductiveConstructor Operator">!</a> <a id="3008" href="SMT.Script.Base.html#5930" class="InductiveConstructor">unsat</a>

  <a id="3017" href="SMT.Script.Show.html#3017" class="Function">_</a> <a id="3019" class="Symbol">:</a> <a id="3021" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="3026" href="Text.Parser.String.html#1180" class="Function Operator">parses</a> <a id="3033" class="String">&quot;unknown&quot;</a>
  <a id="3045" class="Symbol">_</a> <a id="3047" class="Symbol">=</a> <a id="3049" href="Data.Singleton.html#386" class="InductiveConstructor Operator">!</a> <a id="3051" href="SMT.Script.Base.html#5946" class="InductiveConstructor">unknown</a>

  <a id="3062" href="SMT.Script.Show.html#3062" class="Function">_</a> <a id="3064" class="Symbol">:</a> <a id="3066" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="3071" href="Text.Parser.String.html#1615" class="Function Operator">rejects</a> <a id="3079" class="String">&quot;dogfood&quot;</a>
  <a id="3091" class="Symbol">_</a> <a id="3093" class="Symbol">=</a> <a id="3095" class="Symbol">_</a>


  <a id="3101" class="Comment">-- |Construct a definitions parser from a variable parser.</a>
  <a id="3162" class="Comment">--</a>
  <a id="3167" class="Comment">-- @</a>
  <a id="3174" class="Comment">--   (define-fun x0 () Int (- 1))</a>
  <a id="3210" class="Comment">-- @</a>
  <a id="3217" class="Comment">--</a>
  <a id="3222" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3240" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="3247" class="Symbol">(</a><a id="3248" href="SMT.Script.Base.html#10543" class="Function">Var</a> <a id="3252" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3253" class="Symbol">)</a> <a id="3255" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3257" class="Symbol">→</a> <a id="3259" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3262" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="3269" class="Symbol">(</a><a id="3270" href="SMT.Script.Base.html#10618" class="Function">Defn</a> <a id="3275" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3276" class="Symbol">)</a> <a id="3278" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="3282" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="3295" class="Symbol">{</a><a id="3296" href="SMT.Script.Show.html#3296" class="Bound">Γ</a><a id="3297" class="Symbol">}</a> <a id="3299" href="SMT.Script.Show.html#3299" class="Bound">pVar</a> <a id="3304" class="Symbol">=</a> <a id="3306" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="3317" class="Symbol">(</a><a id="3318" href="Text.Parser.html#3575" class="Function">guardM</a> <a id="3325" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3335" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a><a id="3342" class="Symbol">)</a>
    <a id="3348" class="Keyword">where</a>
      <a id="3360" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a> <a id="3368" class="Symbol">:</a> <a id="3370" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3373" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="3380" class="Symbol">(</a><a id="3381" href="SMT.Script.Base.html#10543" class="Function">Var</a> <a id="3385" href="SMT.Script.Show.html#3296" class="Bound">Γ</a> <a id="3387" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3389" href="SMT.Script.Base.html#10584" class="Function">Val</a><a id="3392" class="Symbol">)</a> <a id="3394" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="3402" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a> <a id="3410" class="Symbol">=</a>
        <a id="3420" href="Text.Parser.html#8162" class="Function">parens</a> <a id="3427" class="Symbol">(</a><a id="3428" href="Text.Parser.html#3826" class="Function">box</a> <a id="3432" class="Symbol">(</a><a id="3433" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="3440" class="String">&quot;define-fun&quot;</a> <a id="3453" href="Text.Parser.html#5153" class="Function Operator">&amp;&gt;</a> <a id="3456" href="Text.Parser.html#3826" class="Function">box</a> <a id="3460" class="Symbol">(</a><a id="3461" href="SMT.Script.Show.html#3299" class="Bound">pVar</a> <a id="3466" href="Text.Parser.html#5004" class="Function Operator">&lt;&amp;&gt;</a>
          <a id="3480" href="Text.Parser.html#3826" class="Function">box</a> <a id="3484" class="Symbol">(</a><a id="3485" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="3492" class="String">&quot;()&quot;</a> <a id="3497" href="Text.Parser.html#5153" class="Function Operator">&amp;&gt;</a> <a id="3500" href="Text.Parser.html#3826" class="Function">box</a> <a id="3504" class="Symbol">(</a><a id="3505" href="SMT.Theory.Base.html#3800" class="Function">parseSort</a> <a id="3515" href="Text.Parser.html#4894" class="Function Operator">&gt;&gt;=</a> <a id="3519" class="Symbol">λ</a> <a id="3521" href="SMT.Script.Show.html#3521" class="Bound">σ</a> <a id="3523" class="Symbol">→</a> <a id="3525" href="Text.Parser.html#3826" class="Function">box</a> <a id="3529" class="Symbol">(</a><a id="3530" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="3534" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="3538" href="SMT.Theory.Base.html#3834" class="Function">parseValue</a> <a id="3549" href="SMT.Script.Show.html#3521" class="Bound">σ</a><a id="3550" class="Symbol">))))))</a>

      <a id="3564" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3574" class="Symbol">:</a> <a id="3576" href="SMT.Script.Base.html#10543" class="Function">Var</a> <a id="3580" href="SMT.Script.Show.html#3296" class="Bound">Γ</a> <a id="3582" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3584" href="SMT.Script.Base.html#10584" class="Function">Val</a> <a id="3588" class="Symbol">→</a> <a id="3590" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3596" class="Symbol">(</a><a id="3597" href="SMT.Script.Base.html#10618" class="Function">Defn</a> <a id="3602" href="SMT.Script.Show.html#3296" class="Bound">Γ</a><a id="3603" class="Symbol">)</a>
      <a id="3611" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3621" class="Symbol">((</a><a id="3623" href="SMT.Script.Show.html#3623" class="Bound">σ</a> <a id="3625" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3627" href="SMT.Script.Show.html#3627" class="Bound">i</a><a id="3628" class="Symbol">)</a> <a id="3630" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3632" class="Symbol">(</a><a id="3633" href="SMT.Script.Show.html#3633" class="Bound">σ′</a> <a id="3636" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3638" href="SMT.Script.Show.html#3638" class="Bound">v</a><a id="3639" class="Symbol">))</a> <a id="3642" class="Keyword">with</a> <a id="3647" href="SMT.Script.Show.html#3623" class="Bound">σ</a> <a id="3649" href="SMT.Theory.Base.html#2615" class="Function Operator">≟-Sort</a> <a id="3656" href="SMT.Script.Show.html#3633" class="Bound">σ′</a>
      <a id="3665" class="Symbol">...</a> <a id="3669" class="Symbol">|</a> <a id="3671" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3675" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3680" class="Symbol">=</a> <a id="3682" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3687" class="Symbol">(</a><a id="3688" class="Bound">σ</a> <a id="3690" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3692" class="Bound">i</a> <a id="3694" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3696" class="Bound">v</a><a id="3697" class="Symbol">)</a>
      <a id="3705" class="Symbol">...</a> <a id="3709" class="Symbol">|</a> <a id="3711" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="3715" class="Symbol">_</a>    <a id="3720" class="Symbol">=</a> <a id="3722" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="3734" class="Comment">-- |Construct a definition-list parser from a variable parser.</a>
  <a id="3799" class="Comment">--</a>
  <a id="3804" class="Comment">-- NOTE: The SMT-LIB standard specifies models as a series of definition.</a>
  <a id="3880" class="Comment">--       However, some versions of Z3 and CVC4 print them using &#39;model&#39;,</a>
  <a id="3955" class="Comment">--       e.g., `(model (define-fun x () Int 1))`, so Schmitty optionally</a>
  <a id="4030" class="Comment">--       allows the symbol &#39;model&#39; in the response.</a>
  <a id="4084" class="Comment">--</a>
  <a id="4089" href="SMT.Script.Show.html#4089" class="Function">mkDefnsParser</a> <a id="4103" class="Symbol">:</a> <a id="4105" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4108" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="4115" class="Symbol">(</a><a id="4116" href="SMT.Script.Base.html#10543" class="Function">Var</a> <a id="4120" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4121" class="Symbol">)</a> <a id="4123" href="Relation.Unary.html#3359" class="Function">]</a> <a id="4125" class="Symbol">→</a> <a id="4127" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4130" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="4137" class="Symbol">(</a><a id="4138" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="4144" class="Symbol">(</a><a id="4145" href="SMT.Script.Base.html#10618" class="Function">Defn</a> <a id="4150" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4151" class="Symbol">))</a> <a id="4154" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="4158" href="SMT.Script.Show.html#4089" class="Function">mkDefnsParser</a> <a id="4172" class="Symbol">{</a><a id="4173" href="SMT.Script.Show.html#4173" class="Bound">Γ</a><a id="4174" class="Symbol">}</a> <a id="4176" href="SMT.Script.Show.html#4176" class="Bound">pVar</a> <a id="4181" class="Symbol">=</a>
    <a id="4187" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="4198" class="Symbol">(</a><a id="4199" href="Text.Parser.html#8162" class="Function">parens</a> <a id="4206" class="Symbol">(</a><a id="4207" href="Text.Parser.html#3826" class="Function">box</a> <a id="4211" class="Symbol">(</a><a id="4212" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="4219" class="String">&quot;model&quot;</a> <a id="4227" href="Text.Parser.html#6011" class="Function Operator">?&amp;&gt;</a> <a id="4231" href="Text.Parser.html#7094" class="Function">list⁺</a> <a id="4237" class="Symbol">(</a><a id="4238" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="4251" class="Symbol">{</a><a id="4252" href="SMT.Script.Show.html#4173" class="Bound">Γ</a><a id="4253" class="Symbol">}</a> <a id="4255" href="SMT.Script.Show.html#4176" class="Bound">pVar</a><a id="4259" class="Symbol">))))</a>


  <a id="4268" class="Keyword">private</a>
    <a id="4280" href="SMT.Script.Show.html#4280" class="Function">MaybeModel</a> <a id="4291" class="Symbol">:</a> <a id="4293" href="SMT.Script.Base.html#2516" class="Function">Ctxt</a> <a id="4298" class="Symbol">→</a> <a id="4300" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="4308" href="SMT.Script.Show.html#4280" class="Function">MaybeModel</a> <a id="4319" href="SMT.Script.Show.html#4319" class="Bound">Γ</a> <a id="4321" class="Symbol">=</a> <a id="4323" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="4327" class="Symbol">(λ</a> <a id="4330" href="SMT.Script.Show.html#4330" class="Bound">σ</a> <a id="4332" href="SMT.Script.Show.html#4332" class="Bound Operator">_Γ</a> <a id="4335" class="Symbol">→</a> <a id="4337" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4342" class="Symbol">(</a><a id="4343" href="SMT.Theory.Base.html#3335" class="Function">Value</a> <a id="4349" href="SMT.Script.Show.html#4330" class="Bound">σ</a><a id="4350" class="Symbol">))</a> <a id="4353" href="SMT.Script.Show.html#4319" class="Bound">Γ</a>

    <a id="4360" href="SMT.Script.Show.html#4360" class="Function">insertMM</a> <a id="4369" class="Symbol">:</a> <a id="4371" href="Data.Product.html#1806" class="Function">∃[</a> <a id="4374" href="SMT.Script.Show.html#4374" class="Bound">σ</a> <a id="4376" href="Data.Product.html#1806" class="Function">]</a> <a id="4378" class="Symbol">(</a><a id="4379" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4381" href="SMT.Script.Base.html#2739" class="Function Operator">∋</a> <a id="4383" href="SMT.Script.Show.html#4374" class="Bound">σ</a> <a id="4385" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4387" href="SMT.Theory.Base.html#3335" class="Function">Value</a> <a id="4393" href="SMT.Script.Show.html#4374" class="Bound">σ</a><a id="4394" class="Symbol">)</a> <a id="4396" class="Symbol">→</a> <a id="4398" href="SMT.Script.Show.html#4280" class="Function">MaybeModel</a> <a id="4409" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4411" class="Symbol">→</a> <a id="4413" href="SMT.Script.Show.html#4280" class="Function">MaybeModel</a> <a id="4424" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a>
    <a id="4430" href="SMT.Script.Show.html#4360" class="Function">insertMM</a> <a id="4439" class="Symbol">{</a><a id="4440" class="DottedPattern Symbol">.</a><a id="4441" href="SMT.Script.Show.html#4449" class="DottedPattern Bound">σ</a> <a id="4443" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4445" href="SMT.Script.Show.html#4445" class="Bound">Γ</a><a id="4446" class="Symbol">}</a> <a id="4448" class="Symbol">(</a><a id="4449" href="SMT.Script.Show.html#4449" class="Bound">σ</a> <a id="4451" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4453" class="Symbol">(</a><a id="4454" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="4459" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="4463" class="Symbol">)</a> <a id="4465" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4467" href="SMT.Script.Show.html#4467" class="Bound">v</a><a id="4468" class="Symbol">)</a> <a id="4470" class="Symbol">(</a><a id="4471" href="SMT.Script.Show.html#4471" class="Bound">vs</a> <a id="4474" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4476" href="SMT.Script.Show.html#4476" class="Bound">env</a><a id="4479" class="Symbol">)</a> <a id="4481" class="Symbol">=</a> <a id="4483" class="Symbol">(</a><a id="4484" href="SMT.Script.Show.html#4467" class="Bound">v</a> <a id="4486" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4488" href="SMT.Script.Show.html#4471" class="Bound">vs</a><a id="4490" class="Symbol">)</a> <a id="4492" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4494" href="SMT.Script.Show.html#4476" class="Bound">env</a>
    <a id="4502" href="SMT.Script.Show.html#4360" class="Function">insertMM</a> <a id="4511" class="Symbol">{</a><a id="4512" href="SMT.Script.Show.html#4512" class="Bound">σ′</a> <a id="4515" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4517" href="SMT.Script.Show.html#4517" class="Bound">Γ</a><a id="4518" class="Symbol">}</a> <a id="4520" class="Symbol">(</a><a id="4521" href="SMT.Script.Show.html#4521" class="Bound">σ</a> <a id="4523" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4525" class="Symbol">(</a><a id="4526" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="4532" href="SMT.Script.Show.html#4532" class="Bound">p</a><a id="4533" class="Symbol">)</a>   <a id="4537" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4539" href="SMT.Script.Show.html#4539" class="Bound">v</a><a id="4540" class="Symbol">)</a> <a id="4542" class="Symbol">(</a><a id="4543" href="SMT.Script.Show.html#4543" class="Bound">vs</a> <a id="4546" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4548" href="SMT.Script.Show.html#4548" class="Bound">env</a><a id="4551" class="Symbol">)</a> <a id="4553" class="Symbol">=</a> <a id="4555" href="SMT.Script.Show.html#4543" class="Bound">vs</a> <a id="4558" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4560" href="SMT.Script.Show.html#4360" class="Function">insertMM</a> <a id="4569" class="Symbol">(</a><a id="4570" href="SMT.Script.Show.html#4521" class="Bound">σ</a> <a id="4572" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4574" href="SMT.Script.Show.html#4532" class="Bound">p</a> <a id="4576" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4578" href="SMT.Script.Show.html#4539" class="Bound">v</a><a id="4579" class="Symbol">)</a> <a id="4581" href="SMT.Script.Show.html#4548" class="Bound">env</a>

    <a id="4590" href="SMT.Script.Show.html#4590" class="Function">mkMM</a> <a id="4595" class="Symbol">:</a> <a id="4597" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4602" class="Symbol">(</a><a id="4603" href="SMT.Script.Base.html#10618" class="Function">Defn</a> <a id="4608" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4609" class="Symbol">)</a> <a id="4611" class="Symbol">→</a> <a id="4613" href="SMT.Script.Show.html#4280" class="Function">MaybeModel</a> <a id="4624" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a>
    <a id="4630" href="SMT.Script.Show.html#4590" class="Function">mkMM</a> <a id="4635" class="Symbol">{</a><a id="4636" href="SMT.Script.Show.html#4636" class="Bound">Γ</a><a id="4637" class="Symbol">}</a> <a id="4639" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="4648" class="Symbol">=</a> <a id="4650" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="4661" class="Symbol">(λ</a> <a id="4664" href="SMT.Script.Show.html#4664" class="Bound Operator">_σ</a> <a id="4667" href="SMT.Script.Show.html#4667" class="Bound Operator">_Γ</a> <a id="4670" class="Symbol">→</a> <a id="4672" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4674" class="Symbol">)</a> <a id="4676" href="SMT.Script.Show.html#4636" class="Bound">Γ</a>
    <a id="4682" href="SMT.Script.Show.html#4590" class="Function">mkMM</a> <a id="4687" class="Symbol">{</a><a id="4688" href="SMT.Script.Show.html#4688" class="Bound">Γ</a><a id="4689" class="Symbol">}</a> <a id="4691" class="Symbol">(</a><a id="4692" href="SMT.Script.Show.html#4692" class="Bound">v</a> <a id="4694" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4696" href="SMT.Script.Show.html#4696" class="Bound">vs</a><a id="4698" class="Symbol">)</a> <a id="4700" class="Symbol">=</a> <a id="4702" href="SMT.Script.Show.html#4360" class="Function">insertMM</a> <a id="4711" href="SMT.Script.Show.html#4692" class="Bound">v</a> <a id="4713" class="Symbol">(</a><a id="4714" href="SMT.Script.Show.html#4590" class="Function">mkMM</a> <a id="4719" href="SMT.Script.Show.html#4696" class="Bound">vs</a><a id="4721" class="Symbol">)</a>

    <a id="4728" href="SMT.Script.Show.html#4728" class="Function">fromSingleton</a> <a id="4742" class="Symbol">:</a> <a id="4744" class="Symbol">{</a><a id="4745" href="SMT.Script.Show.html#4745" class="Bound">A</a> <a id="4747" class="Symbol">:</a> <a id="4749" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4752" class="Symbol">}</a> <a id="4754" class="Symbol">→</a> <a id="4756" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4761" href="SMT.Script.Show.html#4745" class="Bound">A</a> <a id="4763" class="Symbol">→</a> <a id="4765" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4771" href="SMT.Script.Show.html#4745" class="Bound">A</a>
    <a id="4777" href="SMT.Script.Show.html#4728" class="Function">fromSingleton</a> <a id="4791" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4794" class="Symbol">=</a> <a id="4796" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="4808" href="SMT.Script.Show.html#4728" class="Function">fromSingleton</a> <a id="4822" class="Symbol">(</a><a id="4823" href="SMT.Script.Show.html#4823" class="Bound">v</a> <a id="4825" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4827" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4829" class="Symbol">)</a> <a id="4831" class="Symbol">=</a> <a id="4833" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4838" href="SMT.Script.Show.html#4823" class="Bound">v</a>
    <a id="4844" href="SMT.Script.Show.html#4728" class="Function">fromSingleton</a> <a id="4858" class="Symbol">(_</a> <a id="4861" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4863" class="Symbol">_</a> <a id="4865" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4867" class="Symbol">_)</a> <a id="4870" class="Symbol">=</a> <a id="4872" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

    <a id="4885" href="SMT.Script.Show.html#4885" class="Function">checkMM</a> <a id="4893" class="Symbol">:</a> <a id="4895" href="SMT.Script.Show.html#4280" class="Function">MaybeModel</a> <a id="4906" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4908" class="Symbol">→</a> <a id="4910" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4916" class="Symbol">(</a><a id="4917" href="SMT.Script.Base.html#6587" class="Datatype">Model</a> <a id="4923" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4924" class="Symbol">)</a>
    <a id="4930" href="SMT.Script.Show.html#4885" class="Function">checkMM</a> <a id="4938" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="4941" class="Symbol">=</a> <a id="4943" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4948" href="SMT.Script.Base.html#6620" class="InductiveConstructor">[]</a>
    <a id="4955" href="SMT.Script.Show.html#4885" class="Function">checkMM</a> <a id="4963" class="Symbol">(</a><a id="4964" href="SMT.Script.Show.html#4964" class="Bound">vs</a> <a id="4967" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4969" href="SMT.Script.Show.html#4969" class="Bound">env</a><a id="4972" class="Symbol">)</a> <a id="4974" class="Symbol">=</a> <a id="4976" href="Data.Maybe.Base.html#2868" class="Function">Maybe.zipWith</a> <a id="4990" href="SMT.Script.Base.html#6637" class="InductiveConstructor Operator">_∷_</a> <a id="4994" class="Symbol">(</a><a id="4995" href="SMT.Script.Show.html#4728" class="Function">fromSingleton</a> <a id="5009" href="SMT.Script.Show.html#4964" class="Bound">vs</a><a id="5011" class="Symbol">)</a> <a id="5013" class="Symbol">(</a><a id="5014" href="SMT.Script.Show.html#4885" class="Function">checkMM</a> <a id="5022" href="SMT.Script.Show.html#4969" class="Bound">env</a><a id="5025" class="Symbol">)</a>

  <a id="5030" href="SMT.Script.Show.html#5030" class="Function">pModelError</a> <a id="5042" class="Symbol">:</a> <a id="5044" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5047" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5054" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="5056" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="5060" href="SMT.Script.Show.html#5030" class="Function">pModelError</a> <a id="5072" class="Symbol">=</a> <a id="5074" class="Symbol">_</a> <a id="5076" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="5079" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="5090" class="Symbol">(</a><a id="5091" href="Text.Parser.html#8162" class="Function">parens</a> <a id="5098" class="Symbol">(</a>
    <a id="5104" href="Text.Parser.html#3826" class="Function">box</a> <a id="5108" class="Symbol">(</a><a id="5109" href="Text.Parser.String.html#496" class="Function">lexeme</a> <a id="5116" class="String">&quot;error&quot;</a> <a id="5124" href="Text.Parser.html#5153" class="Function Operator">&amp;&gt;</a> <a id="5127" href="Text.Parser.html#3826" class="Function">box</a> <a id="5131" class="Symbol">(</a><a id="5132" href="Text.Parser.html#6082" class="Function">between</a> <a id="5140" class="Symbol">(</a><a id="5141" href="Text.Parser.html#7748" class="Function">char</a> <a id="5146" class="String">&#39;&quot;&#39;</a><a id="5149" class="Symbol">)</a> <a id="5151" class="Symbol">(</a><a id="5152" href="Text.Parser.html#3826" class="Function">box</a> <a id="5156" class="Symbol">(</a><a id="5157" href="Text.Parser.html#7748" class="Function">char</a> <a id="5162" class="String">&#39;&quot;&#39;</a><a id="5165" class="Symbol">))</a> <a id="5168" class="Symbol">(</a><a id="5169" href="Text.Parser.html#3826" class="Function">box</a> <a id="5173" class="Symbol">(</a><a id="5174" href="Text.Parser.html#7094" class="Function">list⁺</a> <a id="5180" class="Symbol">(</a><a id="5181" href="Text.Parser.html#6610" class="Function">anyCharBut</a> <a id="5192" class="String">&#39;&quot;&#39;</a><a id="5195" class="Symbol">)))))))</a>

  <a id="5206" class="Comment">-- |Construct a model parser from a variable parser.</a>
  <a id="5261" href="SMT.Script.Show.html#5261" class="Function">mkModelParser</a> <a id="5275" class="Symbol">:</a> <a id="5277" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5280" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5287" class="Symbol">(</a><a id="5288" href="SMT.Script.Base.html#10543" class="Function">Var</a> <a id="5292" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="5293" class="Symbol">)</a> <a id="5295" href="Relation.Unary.html#3359" class="Function">]</a> <a id="5297" class="Symbol">→</a> <a id="5299" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5302" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5309" class="Symbol">(</a><a id="5310" href="SMT.Script.Base.html#6678" class="Function">QualifiedModel</a> <a id="5325" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="5326" class="Symbol">)</a> <a id="5328" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="5332" href="SMT.Script.Show.html#5261" class="Function">mkModelParser</a> <a id="5346" class="Symbol">{</a><a id="5347" href="SMT.Script.Show.html#5347" class="Bound">Γ</a><a id="5348" class="Symbol">}</a> <a id="5350" href="SMT.Script.Show.html#5350" class="Bound">pVar</a> <a id="5355" class="Symbol">=</a> <a id="5357" class="Keyword">do</a>
    <a id="5364" href="SMT.Script.Show.html#5364" class="Bound">s</a> <a id="5366" href="Text.Parser.html#4894" class="Function Operator">←</a> <a id="5368" href="SMT.Script.Show.html#2811" class="Function">pSat</a>
    <a id="5377" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="5382" href="SMT.Script.Show.html#5364" class="Bound">s</a> <a id="5384" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="5387" class="Symbol">λ</a> <a id="5389" class="Keyword">where</a>
      <a id="5401" href="SMT.Script.Base.html#5914" class="InductiveConstructor">sat</a>     <a id="5409" class="Symbol">→</a> <a id="5411" href="Text.Parser.html#3826" class="Function">box</a> <a id="5415" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5417" class="Symbol">(</a><a id="5418" href="SMT.Script.Base.html#5914" class="InductiveConstructor">sat</a> <a id="5422" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5424" class="Symbol">)</a>     <a id="5430" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="5434" href="SMT.Script.Show.html#5634" class="Function">pModel</a>
      <a id="5447" href="SMT.Script.Base.html#5930" class="InductiveConstructor">unsat</a>   <a id="5455" class="Symbol">→</a> <a id="5457" href="Text.Parser.html#3826" class="Function">box</a> <a id="5461" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5463" class="Symbol">(</a><a id="5464" href="SMT.Script.Base.html#5930" class="InductiveConstructor">unsat</a> <a id="5470" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5472" class="Symbol">)</a>   <a id="5476" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="5480" href="SMT.Script.Show.html#5030" class="Function">pModelError</a>
      <a id="5498" href="SMT.Script.Base.html#5946" class="InductiveConstructor">unknown</a> <a id="5506" class="Symbol">→</a> <a id="5508" href="Text.Parser.html#3826" class="Function">box</a> <a id="5512" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5514" class="Symbol">(</a><a id="5515" href="SMT.Script.Base.html#5946" class="InductiveConstructor">unknown</a> <a id="5523" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5525" class="Symbol">)</a> <a id="5527" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="5531" href="SMT.Script.Show.html#5030" class="Function">pModelError</a>
    <a id="5547" class="Keyword">where</a>
      <a id="5559" class="Comment">-- Insert each definition into a model, and check if it is complete.</a>
      <a id="5634" href="SMT.Script.Show.html#5634" class="Function">pModel</a> <a id="5641" class="Symbol">:</a> <a id="5643" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5646" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5653" class="Symbol">(</a><a id="5654" href="SMT.Script.Base.html#6587" class="Datatype">Model</a> <a id="5660" href="SMT.Script.Show.html#5347" class="Bound">Γ</a><a id="5661" class="Symbol">)</a> <a id="5663" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="5671" href="SMT.Script.Show.html#5634" class="Function">pModel</a> <a id="5678" class="Symbol">=</a> <a id="5680" href="Text.Parser.html#3575" class="Function">guardM</a> <a id="5687" href="SMT.Script.Show.html#4885" class="Function">checkMM</a> <a id="5695" class="Symbol">(</a><a id="5696" href="SMT.Script.Show.html#4590" class="Function">mkMM</a> <a id="5701" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5703" href="Data.List.NonEmpty.Base.html#1521" class="Function">List⁺.toList</a> <a id="5716" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="5720" href="SMT.Script.Show.html#4089" class="Function">mkDefnsParser</a> <a id="5734" class="Symbol">{</a><a id="5735" href="SMT.Script.Show.html#5347" class="Bound">Γ</a><a id="5736" class="Symbol">}</a> <a id="5738" href="SMT.Script.Show.html#5350" class="Bound">pVar</a><a id="5742" class="Symbol">)</a>

      <a id="5751" href="SMT.Script.Show.html#5751" class="Function">pMaybeQualifiedModel</a> <a id="5772" class="Symbol">:</a> <a id="5774" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5777" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="5784" class="Symbol">(</a><a id="5785" href="SMT.Script.Base.html#5896" class="Datatype">Sat</a> <a id="5789" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5791" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5797" class="Symbol">(</a><a id="5798" href="SMT.Script.Base.html#6587" class="Datatype">Model</a> <a id="5804" href="SMT.Script.Show.html#5347" class="Bound">Γ</a><a id="5805" class="Symbol">))</a> <a id="5808" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="5816" href="SMT.Script.Show.html#5751" class="Function">pMaybeQualifiedModel</a> <a id="5837" class="Symbol">=</a> <a id="5839" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="5844" href="Text.Parser.html#5484" class="Function Operator">&lt;&amp;?&gt;</a> <a id="5849" href="Text.Parser.html#3826" class="Function">box</a> <a id="5853" href="SMT.Script.Show.html#5634" class="Function">pModel</a>

      <a id="5867" href="SMT.Script.Show.html#5867" class="Function">mkQualifiedModel</a> <a id="5884" class="Symbol">:</a> <a id="5886" href="SMT.Script.Base.html#5896" class="Datatype">Sat</a> <a id="5890" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5892" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5898" class="Symbol">(</a><a id="5899" href="SMT.Script.Base.html#6587" class="Datatype">Model</a> <a id="5905" href="SMT.Script.Show.html#5347" class="Bound">Γ</a><a id="5906" class="Symbol">)</a> <a id="5908" class="Symbol">→</a> <a id="5910" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5916" class="Symbol">(</a><a id="5917" href="SMT.Script.Base.html#6678" class="Function">QualifiedModel</a> <a id="5932" href="SMT.Script.Show.html#5347" class="Bound">Γ</a><a id="5933" class="Symbol">)</a>
      <a id="5941" href="SMT.Script.Show.html#5867" class="Function">mkQualifiedModel</a> <a id="5958" class="Symbol">(</a><a id="5959" href="SMT.Script.Base.html#5914" class="InductiveConstructor">sat</a>     <a id="5967" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5969" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5974" href="SMT.Script.Show.html#5974" class="Bound">m</a><a id="5975" class="Symbol">)</a>  <a id="5978" class="Symbol">=</a> <a id="5980" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5985" class="Symbol">(</a><a id="5986" href="SMT.Script.Base.html#5914" class="InductiveConstructor">sat</a>     <a id="5994" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5996" href="SMT.Script.Show.html#5974" class="Bound">m</a><a id="5997" class="Symbol">)</a>
      <a id="6005" href="SMT.Script.Show.html#5867" class="Function">mkQualifiedModel</a> <a id="6022" class="Symbol">(</a><a id="6023" href="SMT.Script.Base.html#5930" class="InductiveConstructor">unsat</a>   <a id="6031" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6033" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="6040" class="Symbol">)</a> <a id="6042" class="Symbol">=</a> <a id="6044" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6049" class="Symbol">(</a><a id="6050" href="SMT.Script.Base.html#5930" class="InductiveConstructor">unsat</a>   <a id="6058" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6060" class="Symbol">_)</a>
      <a id="6069" href="SMT.Script.Show.html#5867" class="Function">mkQualifiedModel</a> <a id="6086" class="Symbol">(</a><a id="6087" href="SMT.Script.Base.html#5946" class="InductiveConstructor">unknown</a> <a id="6095" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6097" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="6104" class="Symbol">)</a> <a id="6106" class="Symbol">=</a> <a id="6108" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="6113" class="Symbol">(</a><a id="6114" href="SMT.Script.Base.html#5946" class="InductiveConstructor">unknown</a> <a id="6122" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6124" class="Symbol">_)</a>
      <a id="6133" href="SMT.Script.Show.html#5867" class="CatchallClause Function">mkQualifiedModel</a><a id="6149" class="CatchallClause"> </a><a id="6150" class="CatchallClause Symbol">(_</a><a id="6152" class="CatchallClause">       </a><a id="6159" href="Agda.Builtin.Sigma.html#236" class="CatchallClause InductiveConstructor Operator">,</a><a id="6160" class="CatchallClause"> </a><a id="6161" class="CatchallClause Symbol">_)</a>       <a id="6170" class="Symbol">=</a> <a id="6172" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="6184" href="SMT.Script.Show.html#6184" class="Function">mkOutputParsers⁺</a> <a id="6201" class="Symbol">:</a> <a id="6203" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="6217" class="Symbol">(</a><a id="6218" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="6220" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6222" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="6223" class="Symbol">)</a> <a id="6225" class="Symbol">→</a> <a id="6227" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="6230" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="6237" class="Symbol">(</a><a id="6238" href="SMT.Script.Base.html#7270" class="Datatype">Outputs</a> <a id="6246" class="Symbol">(</a><a id="6247" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="6249" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6251" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="6252" class="Symbol">))</a> <a id="6255" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="6259" href="SMT.Script.Show.html#6184" class="Function">mkOutputParsers⁺</a> <a id="6276" class="Symbol">(</a><a id="6277" href="SMT.Script.Show.html#6277" class="Bound">op</a> <a id="6280" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6282" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="6284" class="Symbol">)</a>          <a id="6295" class="Symbol">=</a> <a id="6297" class="Symbol">(</a><a id="6298" href="SMT.Script.Base.html#7330" class="InductiveConstructor Operator">_∷</a> <a id="6301" href="SMT.Script.Base.html#7311" class="InductiveConstructor">[]</a><a id="6303" class="Symbol">)</a> <a id="6305" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="6309" href="SMT.Script.Show.html#6277" class="Bound">op</a>
  <a id="6314" href="SMT.Script.Show.html#6184" class="Function">mkOutputParsers⁺</a> <a id="6331" class="Symbol">(</a><a id="6332" href="SMT.Script.Show.html#6332" class="Bound">op</a> <a id="6335" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6337" href="SMT.Script.Show.html#6337" class="Bound">ops</a><a id="6340" class="Symbol">@(_</a> <a id="6344" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6346" class="Symbol">_))</a> <a id="6350" class="Symbol">=</a> <a id="6352" href="Function.Base.html#1554" class="Function">flip</a> <a id="6357" href="SMT.Script.Base.html#7330" class="InductiveConstructor Operator">_∷_</a> <a id="6361" href="Text.Parser.html#4418" class="Function Operator">&lt;$&gt;</a> <a id="6365" href="SMT.Script.Show.html#6184" class="Function">mkOutputParsers⁺</a> <a id="6382" href="SMT.Script.Show.html#6337" class="Bound">ops</a> <a id="6386" href="Text.Parser.html#5377" class="Function Operator">&lt;*&gt;</a> <a id="6390" href="Text.Parser.html#3826" class="Function">box</a> <a id="6394" href="SMT.Script.Show.html#6332" class="Bound">op</a>



<a id="6400" class="Comment">-- * Pretty printer</a>

<a id="6421" class="Keyword">module</a> <a id="6428" href="SMT.Script.Show.html#6428" class="Module">_</a> <a id="6430" class="Keyword">where</a>

  <a id="6439" class="Keyword">open</a> <a id="6444" class="Keyword">import</a> <a id="6451" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="6472" class="Symbol">as</a> <a id="6475" class="Module">StateCat</a> <a id="6484" class="Keyword">using</a> <a id="6490" class="Symbol">(</a><a id="6491" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="6505" class="Symbol">;</a> <a id="6507" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="6514" class="Symbol">)</a>
  <a id="6518" class="Keyword">open</a> <a id="6523" class="Keyword">import</a> <a id="6530" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="6549" class="Keyword">using</a> <a id="6555" class="Symbol">(</a><a id="6556" href="Relation.Unary.html#3359" class="Function">IUniversal</a><a id="6566" class="Symbol">;</a> <a id="6568" href="Text.Parser.html#2710" class="Function">Parser</a><a id="6574" class="Symbol">;</a> <a id="6576" href="Text.Parser.html#4502" class="Function Operator">_&lt;$_</a><a id="6580" class="Symbol">;</a> <a id="6582" href="Text.Parser.html#8281" class="Function">withSpaces</a><a id="6592" class="Symbol">;</a> <a id="6594" href="Text.Parser.html#6390" class="Function">exacts</a><a id="6600" class="Symbol">)</a>

  <a id="6605" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="6615" class="Symbol">:</a> <a id="6617" class="Symbol">(</a><a id="6618" href="SMT.Script.Show.html#6618" class="Bound">Γ</a> <a id="6620" href="SMT.Script.Show.html#6620" class="Bound">Γ′</a> <a id="6623" class="Symbol">:</a> <a id="6625" href="SMT.Script.Base.html#2516" class="Function">Ctxt</a><a id="6629" class="Symbol">)</a> <a id="6631" class="Symbol">→</a> <a id="6633" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="6637" class="Symbol">→</a> <a id="6639" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="6645" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="6655" href="SMT.Script.Show.html#6655" class="Bound">Γ</a> <a id="6657" href="SMT.Script.Show.html#6657" class="Bound">Γ′</a> <a id="6660" href="SMT.Script.Show.html#6660" class="Bound">A</a> <a id="6662" class="Symbol">=</a> <a id="6664" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="6672" class="Symbol">(λ</a> <a id="6675" href="SMT.Script.Show.html#6675" class="Bound">Γ</a> <a id="6677" class="Symbol">→</a> <a id="6679" href="SMT.Script.Names.html#2385" class="Record">Names</a> <a id="6685" href="SMT.Script.Show.html#6675" class="Bound">Γ</a> <a id="6687" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6689" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="6700" href="SMT.Script.Show.html#6675" class="Bound">Γ</a><a id="6701" class="Symbol">)</a> <a id="6703" href="Function.Base.html#615" class="Function">id</a> <a id="6706" href="SMT.Script.Show.html#6655" class="Bound">Γ</a> <a id="6708" href="SMT.Script.Show.html#6657" class="Bound">Γ′</a> <a id="6711" href="SMT.Script.Show.html#6660" class="Bound">A</a>

  <a id="6716" class="Comment">-- When showing terms, we need to pass around a name state,</a>
  <a id="6778" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
  <a id="6845" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
  <a id="6909" class="Keyword">private</a>
    <a id="6921" href="SMT.Script.Show.html#6921" class="Function">monadStateNameState</a> <a id="6941" class="Symbol">=</a>
      <a id="6949" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="6976" class="Symbol">(λ</a> <a id="6979" href="SMT.Script.Show.html#6979" class="Bound">Γ</a> <a id="6981" class="Symbol">→</a> <a id="6983" href="SMT.Script.Names.html#2385" class="Record">Names</a> <a id="6989" href="SMT.Script.Show.html#6979" class="Bound">Γ</a> <a id="6991" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6993" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="7004" href="SMT.Script.Show.html#6979" class="Bound">Γ</a><a id="7005" class="Symbol">)</a> <a id="7007" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

  <a id="7025" class="Keyword">open</a> <a id="7030" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="7045" href="SMT.Script.Show.html#6921" class="Function">monadStateNameState</a>
    <a id="7069" class="Keyword">using</a> <a id="7075" class="Symbol">(</a><a id="7076" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="7082" class="Symbol">;</a> <a id="7084" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="7089" class="Symbol">;</a> <a id="7091" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="7095" class="Symbol">;</a> <a id="7097" href="Category.Monad.State.html#2831" class="Field">put</a><a id="7100" class="Symbol">;</a> <a id="7102" href="Category.Monad.State.html#2799" class="Field">get</a><a id="7105" class="Symbol">;</a> <a id="7107" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="7113" class="Symbol">)</a>

  <a id="7118" href="SMT.Script.Show.html#7118" class="Function">freshNameS</a> <a id="7129" class="Symbol">:</a> <a id="7131" class="Symbol">(</a><a id="7132" href="SMT.Script.Show.html#7132" class="Bound">n</a> <a id="7134" class="Symbol">:</a> <a id="7136" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="7142" class="Symbol">)</a> <a id="7144" class="Symbol">(</a><a id="7145" href="SMT.Script.Show.html#7145" class="Bound">σ</a> <a id="7147" class="Symbol">:</a> <a id="7149" href="SMT.Theory.Base.html#2591" class="Function">Sort</a><a id="7153" class="Symbol">)</a> <a id="7155" class="Symbol">→</a> <a id="7157" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="7167" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7169" class="Symbol">(</a><a id="7170" href="SMT.Script.Show.html#7145" class="Bound">σ</a> <a id="7172" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7174" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="7175" class="Symbol">)</a> <a id="7177" href="SMT.Script.Names.html#1799" class="Function">Name</a>
  <a id="7184" href="SMT.Script.Show.html#7118" class="Function">freshNameS</a> <a id="7195" href="SMT.Script.Show.html#7195" class="Bound">n</a> <a id="7197" href="SMT.Script.Show.html#7197" class="Bound">σ</a> <a id="7199" class="Symbol">=</a> <a id="7201" class="Keyword">do</a>
    <a id="7208" class="Symbol">(</a><a id="7209" href="SMT.Script.Show.html#7209" class="Bound">ns</a> <a id="7212" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7214" href="SMT.Script.Show.html#7214" class="Bound">vps</a><a id="7217" class="Symbol">)</a> <a id="7219" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7221" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7229" class="Keyword">let</a> <a id="7233" class="Symbol">(</a><a id="7234" href="SMT.Script.Show.html#7234" class="Bound">n′</a> <a id="7237" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7239" href="SMT.Script.Show.html#7239" class="Bound">ns</a><a id="7241" class="Symbol">)</a> <a id="7243" class="Symbol">=</a> <a id="7245" href="SMT.Script.Names.html#2595" class="Function">freshName</a> <a id="7255" href="SMT.Script.Show.html#7195" class="Bound">n</a> <a id="7257" href="SMT.Script.Show.html#7197" class="Bound">σ</a> <a id="7259" href="SMT.Script.Show.html#7209" class="Bound">ns</a>
    <a id="7266" class="Keyword">let</a> <a id="7270" href="SMT.Script.Show.html#7270" class="Bound">vps</a> <a id="7274" class="Symbol">=</a> <a id="7276" class="Symbol">(</a><a id="7277" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="7282" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7287" href="Text.Parser.html#4502" class="Function Operator">&lt;$</a> <a id="7290" href="Text.Parser.html#8281" class="Function">withSpaces</a> <a id="7301" class="Symbol">(</a><a id="7302" href="Text.Parser.html#6390" class="Function">exacts</a> <a id="7309" href="SMT.Script.Show.html#7234" class="Bound">n′</a><a id="7311" class="Symbol">))</a> <a id="7314" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7316" href="SMT.Script.Show.html#7214" class="Bound">vps</a>
    <a id="7324" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7328" class="Symbol">(</a><a id="7329" href="SMT.Script.Show.html#7239" class="Bound">ns</a> <a id="7332" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7334" href="SMT.Script.Show.html#7270" class="Bound">vps</a><a id="7337" class="Symbol">)</a>
    <a id="7343" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7350" href="SMT.Script.Show.html#7234" class="Bound">n′</a>

  <a id="7356" href="SMT.Script.Show.html#7356" class="Function">dropNameS</a> <a id="7366" class="Symbol">:</a> <a id="7368" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="7378" class="Symbol">(</a><a id="7379" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="7381" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7383" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="7384" class="Symbol">)</a> <a id="7386" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7388" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="7392" href="SMT.Script.Show.html#7356" class="Function">dropNameS</a> <a id="7402" class="Symbol">=</a> <a id="7404" class="Keyword">do</a>
    <a id="7411" class="Symbol">(</a><a id="7412" href="SMT.Script.Show.html#7412" class="Bound">ns</a> <a id="7415" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7417" class="Symbol">_</a> <a id="7419" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7421" href="SMT.Script.Show.html#7421" class="Bound">vps</a><a id="7424" class="Symbol">)</a> <a id="7426" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7428" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7436" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7440" class="Symbol">(</a><a id="7441" href="SMT.Script.Names.html#2921" class="Function">dropName</a> <a id="7450" href="SMT.Script.Show.html#7412" class="Bound">ns</a> <a id="7453" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7455" href="SMT.Script.Show.html#7421" class="Bound">vps</a><a id="7458" class="Symbol">)</a>
    <a id="7464" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7471" class="Symbol">_</a>

  <a id="7476" href="SMT.Script.Show.html#7476" class="Function">lookupNameS</a> <a id="7488" class="Symbol">:</a> <a id="7490" class="Symbol">(</a><a id="7491" href="SMT.Script.Show.html#7491" class="Bound">i</a> <a id="7493" class="Symbol">:</a> <a id="7495" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7497" href="SMT.Script.Base.html#2739" class="Function Operator">∋</a> <a id="7499" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a><a id="7500" class="Symbol">)</a> <a id="7502" class="Symbol">→</a> <a id="7504" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="7514" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7516" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7518" href="SMT.Script.Names.html#1799" class="Function">Name</a>
  <a id="7525" href="SMT.Script.Show.html#7476" class="Function">lookupNameS</a> <a id="7537" href="SMT.Script.Show.html#7537" class="Bound">p</a> <a id="7539" class="Symbol">=</a> <a id="7541" class="Keyword">do</a>
    <a id="7548" class="Symbol">(</a><a id="7549" href="SMT.Script.Show.html#7549" class="Bound">ns</a> <a id="7552" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7554" href="SMT.Script.Show.html#7554" class="Bound Operator">_vps</a><a id="7558" class="Symbol">)</a> <a id="7560" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7562" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7570" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7577" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7579" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="7590" class="Symbol">(</a><a id="7591" href="SMT.Script.Names.html#2426" class="Field">Names.nameEnv</a> <a id="7605" href="SMT.Script.Show.html#7549" class="Bound">ns</a><a id="7607" class="Symbol">)</a> <a id="7609" class="Symbol">(</a><a id="7610" href="Data.List.Relation.Unary.Any.html#1817" class="Function">Any.index</a> <a id="7620" href="SMT.Script.Show.html#7537" class="Bound">p</a><a id="7621" class="Symbol">)</a>


  <a id="7627" class="Comment">-- * Printing functions</a>

  <a id="7654" class="Keyword">mutual</a>

    <a id="7666" class="Comment">-- |Show a term as an S-expression.</a>
    <a id="7706" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="7716" class="Symbol">:</a> <a id="7718" href="SMT.Script.Base.html#3269" class="Datatype">Term</a> <a id="7723" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7725" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="7727" class="Symbol">→</a> <a id="7729" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="7739" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7741" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7743" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="7754" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="7764" class="Symbol">(</a><a id="7765" href="SMT.Script.Base.html#3314" class="InductiveConstructor">`var</a> <a id="7770" href="SMT.Script.Show.html#7770" class="Bound">i</a><a id="7771" class="Symbol">)</a> <a id="7773" class="Symbol">=</a> <a id="7775" class="Keyword">do</a>
      <a id="7784" href="SMT.Script.Show.html#7784" class="Bound">n</a> <a id="7786" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7788" href="SMT.Script.Show.html#7476" class="Function">lookupNameS</a> <a id="7800" href="SMT.Script.Show.html#7770" class="Bound">i</a>
      <a id="7808" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7815" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7817" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="7826" href="SMT.Script.Show.html#7784" class="Bound">n</a>
    <a id="7832" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="7842" class="Symbol">(</a><a id="7843" href="SMT.Script.Base.html#3364" class="InductiveConstructor">`lit</a> <a id="7848" href="SMT.Script.Show.html#7848" class="Bound">l</a><a id="7849" class="Symbol">)</a> <a id="7851" class="Symbol">=</a> <a id="7853" class="Keyword">do</a>
      <a id="7862" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7869" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7871" href="SMT.Theory.Base.html#3580" class="Function">showLiteral</a> <a id="7883" href="SMT.Script.Show.html#7848" class="Bound">l</a>
    <a id="7889" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="7899" class="Symbol">(</a><a id="7900" href="SMT.Script.Base.html#3418" class="InductiveConstructor">`app</a> <a id="7905" href="SMT.Script.Show.html#7905" class="Bound">x</a> <a id="7907" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="7909" class="Symbol">)</a> <a id="7911" class="Symbol">=</a> <a id="7913" class="Keyword">do</a>
      <a id="7922" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7929" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7931" href="SMT.Theory.Base.html#3633" class="Function">showIdentifier</a> <a id="7946" href="SMT.Script.Show.html#7905" class="Bound">x</a>
    <a id="7952" href="SMT.Script.Show.html#7706" class="CatchallClause Function">showTermS</a><a id="7961" class="CatchallClause"> </a><a id="7962" class="CatchallClause Symbol">(</a><a id="7963" href="SMT.Script.Base.html#3418" class="CatchallClause InductiveConstructor">`app</a><a id="7967" class="CatchallClause"> </a><a id="7968" href="SMT.Script.Show.html#7968" class="CatchallClause Bound">x</a><a id="7969" class="CatchallClause"> </a><a id="7970" href="SMT.Script.Show.html#7970" class="CatchallClause Bound">xs</a><a id="7972" class="CatchallClause Symbol">)</a> <a id="7974" class="Symbol">=</a> <a id="7976" class="Keyword">do</a>
      <a id="7985" class="Keyword">let</a> <a id="7989" href="SMT.Script.Show.html#7989" class="Bound">x</a> <a id="7991" class="Symbol">=</a> <a id="7993" href="SMT.Theory.Base.html#3633" class="Function">showIdentifier</a> <a id="8008" href="SMT.Script.Show.html#7968" class="Bound">x</a>
      <a id="8016" href="SMT.Script.Show.html#8016" class="Bound">xs</a> <a id="8019" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8021" href="SMT.Script.Show.html#8675" class="Function">showArgsS</a> <a id="8031" href="SMT.Script.Show.html#7970" class="Bound">xs</a>
      <a id="8040" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8047" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8049" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8057" class="Symbol">(</a><a id="8058" href="SMT.Script.Show.html#7989" class="Bound">x</a> <a id="8060" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8062" href="SMT.Script.Show.html#8016" class="Bound">xs</a><a id="8064" class="Symbol">)</a>
    <a id="8070" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8080" class="Symbol">(</a><a id="8081" href="SMT.Script.Base.html#3520" class="InductiveConstructor">`forall</a> <a id="8089" href="SMT.Script.Show.html#8089" class="Bound">n</a> <a id="8091" href="SMT.Script.Show.html#8091" class="Bound">σ</a> <a id="8093" href="SMT.Script.Show.html#8093" class="Bound">x</a><a id="8094" class="Symbol">)</a> <a id="8096" class="Symbol">=</a> <a id="8098" class="Keyword">do</a>
      <a id="8107" href="SMT.Script.Show.html#8107" class="Bound">n′</a> <a id="8110" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8112" href="SMT.Script.Show.html#7118" class="Function">freshNameS</a> <a id="8123" href="SMT.Script.Show.html#8089" class="Bound">n</a> <a id="8125" href="SMT.Script.Show.html#8091" class="Bound">σ</a>
      <a id="8133" href="SMT.Script.Show.html#8133" class="Bound">x</a> <a id="8135" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8137" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8147" href="SMT.Script.Show.html#8093" class="Bound">x</a>
      <a id="8155" href="SMT.Script.Show.html#7356" class="Function">dropNameS</a>
      <a id="8171" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8178" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8180" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8188" class="Symbol">(</a><a id="8189" class="String">&quot;forall&quot;</a> <a id="8198" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8200" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8208" class="Symbol">(</a><a id="8209" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8217" class="Symbol">(</a><a id="8218" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8227" href="SMT.Script.Show.html#8107" class="Bound">n′</a> <a id="8230" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8232" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="8241" href="SMT.Script.Show.html#8091" class="Bound">σ</a> <a id="8243" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8245" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8247" class="Symbol">)</a> <a id="8249" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8251" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8253" class="Symbol">)</a> <a id="8255" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8257" href="SMT.Script.Show.html#8133" class="Bound">x</a> <a id="8259" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8261" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8263" class="Symbol">)</a>
    <a id="8269" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8279" class="Symbol">(</a><a id="8280" href="SMT.Script.Base.html#3605" class="InductiveConstructor">`exists</a> <a id="8288" href="SMT.Script.Show.html#8288" class="Bound">n</a> <a id="8290" href="SMT.Script.Show.html#8290" class="Bound">σ</a> <a id="8292" href="SMT.Script.Show.html#8292" class="Bound">x</a><a id="8293" class="Symbol">)</a> <a id="8295" class="Symbol">=</a> <a id="8297" class="Keyword">do</a>
      <a id="8306" href="SMT.Script.Show.html#8306" class="Bound">n′</a> <a id="8309" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8311" href="SMT.Script.Show.html#7118" class="Function">freshNameS</a> <a id="8322" href="SMT.Script.Show.html#8288" class="Bound">n</a> <a id="8324" href="SMT.Script.Show.html#8290" class="Bound">σ</a>
      <a id="8332" href="SMT.Script.Show.html#8332" class="Bound">x</a> <a id="8334" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8336" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8346" href="SMT.Script.Show.html#8292" class="Bound">x</a>
      <a id="8354" href="SMT.Script.Show.html#7356" class="Function">dropNameS</a>
      <a id="8370" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8377" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8379" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8387" class="Symbol">(</a><a id="8388" class="String">&quot;exists&quot;</a> <a id="8397" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8399" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8407" class="Symbol">(</a><a id="8408" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8416" class="Symbol">(</a><a id="8417" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8426" href="SMT.Script.Show.html#8306" class="Bound">n′</a> <a id="8429" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8431" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="8440" href="SMT.Script.Show.html#8290" class="Bound">σ</a> <a id="8442" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8444" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8446" class="Symbol">)</a> <a id="8448" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8450" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8452" class="Symbol">)</a> <a id="8454" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8456" href="SMT.Script.Show.html#8332" class="Bound">x</a> <a id="8458" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8460" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8462" class="Symbol">)</a>
    <a id="8468" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8478" class="Symbol">(</a><a id="8479" href="SMT.Script.Base.html#3690" class="InductiveConstructor">`let</a> <a id="8484" href="SMT.Script.Show.html#8484" class="Bound">n</a> <a id="8486" href="SMT.Script.Show.html#8486" class="Bound">σ</a> <a id="8488" href="SMT.Script.Show.html#8488" class="Bound">x</a> <a id="8490" href="SMT.Script.Show.html#8490" class="Bound">y</a><a id="8491" class="Symbol">)</a> <a id="8493" class="Symbol">=</a> <a id="8495" class="Keyword">do</a>
      <a id="8504" href="SMT.Script.Show.html#8504" class="Bound">x</a> <a id="8506" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8508" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8518" href="SMT.Script.Show.html#8488" class="Bound">x</a>
      <a id="8526" href="SMT.Script.Show.html#8526" class="Bound">n</a> <a id="8528" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8530" href="SMT.Script.Show.html#7118" class="Function">freshNameS</a> <a id="8541" href="SMT.Script.Show.html#8484" class="Bound">n</a> <a id="8543" href="SMT.Script.Show.html#8486" class="Bound">σ</a>
      <a id="8551" href="SMT.Script.Show.html#8551" class="Bound">y</a> <a id="8553" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8555" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8565" href="SMT.Script.Show.html#8490" class="Bound">y</a>
      <a id="8573" href="SMT.Script.Show.html#7356" class="Function">dropNameS</a>
      <a id="8589" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8596" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8598" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8606" class="Symbol">((</a><a id="8608" class="String">&quot;let&quot;</a> <a id="8614" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8616" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8624" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="8626" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8634" class="Symbol">(</a><a id="8635" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8644" href="SMT.Script.Show.html#8526" class="Bound">n</a> <a id="8646" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8648" href="SMT.Script.Show.html#8504" class="Bound">x</a> <a id="8650" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8652" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8654" class="Symbol">)</a> <a id="8656" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="8658" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8660" href="SMT.Script.Show.html#8551" class="Bound">y</a> <a id="8662" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8664" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8666" class="Symbol">)</a> <a id="8668" class="Symbol">)</a>

    <a id="8675" href="SMT.Script.Show.html#8675" class="Function">showArgsS</a> <a id="8685" class="Symbol">:</a> <a id="8687" href="SMT.Script.Base.html#3777" class="Function">Args</a> <a id="8692" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8694" href="SMT.Script.Show.html#1826" class="Generalizable">Δ</a> <a id="8696" class="Symbol">→</a> <a id="8698" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="8708" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8710" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8712" class="Symbol">(</a><a id="8713" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8718" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="8724" class="Symbol">)</a>
    <a id="8730" href="SMT.Script.Show.html#8675" class="Function">showArgsS</a> <a id="8740" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>       <a id="8749" class="Symbol">=</a> <a id="8751" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8758" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="8765" href="SMT.Script.Show.html#8675" class="Function">showArgsS</a> <a id="8775" class="Symbol">(</a><a id="8776" href="SMT.Script.Show.html#8776" class="Bound">x</a> <a id="8778" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="8780" href="SMT.Script.Show.html#8780" class="Bound">xs</a><a id="8782" class="Symbol">)</a> <a id="8784" class="Symbol">=</a> <a id="8786" class="Keyword">do</a> <a id="8789" href="SMT.Script.Show.html#8789" class="Bound">x</a> <a id="8791" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8793" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="8803" href="SMT.Script.Show.html#8776" class="Bound">x</a><a id="8804" class="Symbol">;</a> <a id="8806" href="SMT.Script.Show.html#8806" class="Bound">xs</a> <a id="8809" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8811" href="SMT.Script.Show.html#8675" class="Function">showArgsS</a> <a id="8821" href="SMT.Script.Show.html#8780" class="Bound">xs</a><a id="8823" class="Symbol">;</a> <a id="8825" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8832" class="Symbol">(</a><a id="8833" href="SMT.Script.Show.html#8789" class="Bound">x</a> <a id="8835" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8837" href="SMT.Script.Show.html#8806" class="Bound">xs</a><a id="8839" class="Symbol">)</a>

  <a id="8844" class="Comment">-- |Show a command as an S-expression, and build up an environment of output parsers.</a>
  <a id="8932" href="SMT.Script.Show.html#8932" class="Function">showCommandS</a> <a id="8945" class="Symbol">:</a> <a id="8947" href="SMT.Script.Base.html#9702" class="Datatype">Command</a> <a id="8955" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8957" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="8960" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a> <a id="8963" class="Symbol">→</a> <a id="8965" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="8975" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8977" class="Symbol">(</a><a id="8978" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="8981" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="8984" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="8985" class="Symbol">)</a> <a id="8987" class="Symbol">(</a><a id="8988" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="8995" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8997" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="9011" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a><a id="9013" class="Symbol">)</a>
  <a id="9017" href="SMT.Script.Show.html#8932" class="Function">showCommandS</a> <a id="9030" class="Symbol">(</a><a id="9031" href="SMT.Script.Base.html#9767" class="InductiveConstructor">`set-logic</a> <a id="9042" href="SMT.Script.Show.html#9042" class="Bound">l</a><a id="9043" class="Symbol">)</a> <a id="9045" class="Symbol">=</a> <a id="9047" class="Keyword">do</a>
    <a id="9054" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9061" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9063" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9071" class="Symbol">(</a><a id="9072" class="String">&quot;set-logic&quot;</a> <a id="9084" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9086" href="SMT.Script.Show.html#9042" class="Bound">l</a> <a id="9088" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9090" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9092" class="Symbol">)</a> <a id="9094" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9096" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9101" href="SMT.Script.Show.html#8932" class="Function">showCommandS</a> <a id="9114" class="Symbol">(</a><a id="9115" href="SMT.Script.Base.html#9816" class="InductiveConstructor">`declare-const</a> <a id="9130" href="SMT.Script.Show.html#9130" class="Bound">n</a> <a id="9132" href="SMT.Script.Show.html#9132" class="Bound">σ</a><a id="9133" class="Symbol">)</a> <a id="9135" class="Symbol">=</a> <a id="9137" class="Keyword">do</a>
    <a id="9144" href="SMT.Script.Show.html#9144" class="Bound">n′</a> <a id="9147" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9149" href="SMT.Script.Show.html#7118" class="Function">freshNameS</a> <a id="9160" href="SMT.Script.Show.html#9130" class="Bound">n</a> <a id="9162" href="SMT.Script.Show.html#9132" class="Bound">σ</a>
    <a id="9168" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9175" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9177" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9185" class="Symbol">(</a><a id="9186" class="String">&quot;declare-const&quot;</a> <a id="9202" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9204" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="9213" href="SMT.Script.Show.html#9144" class="Bound">n′</a> <a id="9216" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9218" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="9227" href="SMT.Script.Show.html#9132" class="Bound">σ</a> <a id="9229" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9231" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9233" class="Symbol">)</a> <a id="9235" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9237" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9242" href="SMT.Script.Show.html#8932" class="Function">showCommandS</a> <a id="9255" class="Symbol">(</a><a id="9256" href="SMT.Script.Base.html#9883" class="InductiveConstructor">`assert</a> <a id="9264" href="SMT.Script.Show.html#9264" class="Bound">x</a><a id="9265" class="Symbol">)</a> <a id="9267" class="Symbol">=</a> <a id="9269" class="Keyword">do</a>
    <a id="9276" href="SMT.Script.Show.html#9276" class="Bound">x</a> <a id="9278" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9280" href="SMT.Script.Show.html#7706" class="Function">showTermS</a> <a id="9290" href="SMT.Script.Show.html#9264" class="Bound">x</a>
    <a id="9296" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9303" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9305" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9313" class="Symbol">(</a><a id="9314" class="String">&quot;assert&quot;</a> <a id="9323" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9325" href="SMT.Script.Show.html#9276" class="Bound">x</a> <a id="9327" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9329" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9331" class="Symbol">)</a> <a id="9333" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9335" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9340" href="SMT.Script.Show.html#8932" class="Function">showCommandS</a> <a id="9353" href="SMT.Script.Base.html#9932" class="InductiveConstructor">`check-sat</a> <a id="9364" class="Symbol">=</a> <a id="9366" class="Keyword">do</a>
    <a id="9373" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9380" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9382" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9390" class="Symbol">(</a><a id="9391" class="String">&quot;check-sat&quot;</a> <a id="9403" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9405" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9407" class="Symbol">)</a> <a id="9409" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9411" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="9416" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="9418" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9423" href="SMT.Script.Show.html#8932" class="Function">showCommandS</a> <a id="9436" href="SMT.Script.Base.html#9975" class="InductiveConstructor">`get-model</a> <a id="9447" class="Symbol">=</a> <a id="9449" class="Keyword">do</a>
    <a id="9456" class="Symbol">(</a><a id="9457" href="SMT.Script.Show.html#9457" class="Bound Operator">_ns</a> <a id="9461" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9463" href="SMT.Script.Show.html#9463" class="Bound">vps</a><a id="9466" class="Symbol">)</a> <a id="9468" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9470" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="9478" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9485" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9487" href="Data.String.Base.html#2767" class="Function">String.unlines</a> <a id="9502" class="Symbol">(</a> <a id="9504" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9512" class="Symbol">(</a><a id="9513" class="String">&quot;check-sat&quot;</a> <a id="9525" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9527" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9529" class="Symbol">)</a>
                            <a id="9559" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9561" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9569" class="Symbol">(</a><a id="9570" class="String">&quot;get-model&quot;</a> <a id="9582" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9584" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9586" class="Symbol">)</a> <a id="9588" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9590" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9593" class="Symbol">)</a>
           <a id="9606" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9608" href="SMT.Script.Show.html#5261" class="Function">mkModelParser</a> <a id="9622" class="Symbol">(</a><a id="9623" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="9635" href="SMT.Script.Show.html#9463" class="Bound">vps</a><a id="9638" class="Symbol">)</a> <a id="9640" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="9642" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>

  <a id="9648" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
  <a id="9735" href="SMT.Script.Show.html#9735" class="Function">showScriptS</a> <a id="9747" class="Symbol">:</a> <a id="9749" href="SMT.Script.Base.html#10115" class="Datatype">Script</a> <a id="9756" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9758" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="9761" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="9763" class="Symbol">→</a> <a id="9765" href="SMT.Script.Show.html#6605" class="Function">NameState</a> <a id="9775" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9777" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="9780" class="Symbol">(</a><a id="9781" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9786" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="9793" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9795" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="9809" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="9810" class="Symbol">)</a>
  <a id="9814" href="SMT.Script.Show.html#9735" class="Function">showScriptS</a> <a id="9826" href="SMT.Script.Base.html#10178" class="InductiveConstructor">[]</a> <a id="9829" class="Symbol">=</a> <a id="9831" class="Keyword">do</a>
    <a id="9838" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9845" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9847" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9850" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9852" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9857" href="SMT.Script.Show.html#9735" class="Function">showScriptS</a> <a id="9869" class="Symbol">(</a><a id="9870" href="SMT.Script.Show.html#9870" class="Bound">cmd</a> <a id="9874" href="SMT.Script.Base.html#10200" class="InductiveConstructor Operator">∷</a> <a id="9876" href="SMT.Script.Show.html#9876" class="Bound">scr</a><a id="9879" class="Symbol">)</a> <a id="9881" class="Symbol">=</a> <a id="9883" class="Keyword">do</a>
    <a id="9890" class="Symbol">(</a><a id="9891" href="SMT.Script.Show.html#9891" class="Bound">cmd</a> <a id="9895" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9897" href="SMT.Script.Show.html#9897" class="Bound">ops₁</a><a id="9901" class="Symbol">)</a> <a id="9903" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9905" href="SMT.Script.Show.html#8932" class="Function">showCommandS</a> <a id="9918" href="SMT.Script.Show.html#9870" class="Bound">cmd</a>
    <a id="9926" class="Symbol">(</a><a id="9927" href="SMT.Script.Show.html#9927" class="Bound">scr</a> <a id="9931" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9933" href="SMT.Script.Show.html#9933" class="Bound">ops₂</a><a id="9937" class="Symbol">)</a> <a id="9939" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9941" href="SMT.Script.Show.html#9735" class="Function">showScriptS</a> <a id="9953" href="SMT.Script.Show.html#9876" class="Bound">scr</a>
    <a id="9961" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9968" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9970" href="SMT.Script.Show.html#9891" class="Bound">cmd</a> <a id="9974" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9976" href="SMT.Script.Show.html#9927" class="Bound">scr</a> <a id="9980" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9982" href="Data.Environment.html#1225" class="Function">Env.append</a> <a id="9993" href="Function.Base.html#615" class="Function">id</a> <a id="9996" href="SMT.Script.Show.html#9897" class="Bound">ops₁</a> <a id="10001" href="SMT.Script.Show.html#9933" class="Bound">ops₂</a>

  <a id="10009" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
  <a id="10094" href="SMT.Script.Show.html#10094" class="Function">showScript</a> <a id="10105" class="Symbol">:</a> <a id="10107" href="SMT.Script.Base.html#10115" class="Datatype">Script</a> <a id="10114" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10117" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="10119" class="Symbol">(</a><a id="10120" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="10122" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10124" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="10125" class="Symbol">)</a> <a id="10127" class="Symbol">→</a> <a id="10129" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="10136" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="10138" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="10141" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="10148" class="Symbol">(</a><a id="10149" href="SMT.Script.Base.html#7270" class="Datatype">Outputs</a> <a id="10157" class="Symbol">(</a><a id="10158" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="10160" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10162" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="10163" class="Symbol">))</a> <a id="10166" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="10170" href="SMT.Script.Show.html#10094" class="Function">showScript</a> <a id="10181" href="SMT.Script.Show.html#10181" class="Bound">scr</a> <a id="10185" class="Symbol">=</a> <a id="10187" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="10196" href="Data.String.Base.html#2767" class="Function">String.unlines</a> <a id="10211" href="SMT.Script.Show.html#6184" class="Function">mkOutputParsers⁺</a> <a id="10228" class="Symbol">(</a><a id="10229" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="10235" class="Symbol">(</a><a id="10236" href="SMT.Script.Show.html#9735" class="Function">showScriptS</a> <a id="10248" href="SMT.Script.Show.html#10181" class="Bound">scr</a> <a id="10252" class="Symbol">(</a><a id="10253" href="SMT.Script.Names.html#3140" class="Function">x′es</a> <a id="10258" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10260" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="10262" class="Symbol">)))</a>

  <a id="10269" class="Comment">-- |Get the variable parser for a script (for debugging purposes).</a>
  <a id="10338" href="SMT.Script.Show.html#10338" class="Function">getVarParser</a> <a id="10351" class="Symbol">:</a> <a id="10353" href="SMT.Script.Base.html#10115" class="Datatype">Script</a> <a id="10360" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10363" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="10365" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="10367" class="Symbol">→</a> <a id="10369" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="10372" href="Text.Parser.html#2710" class="Function">Parser</a> <a id="10379" class="Symbol">(</a><a id="10380" href="Data.Product.html#1806" class="Function">∃[</a> <a id="10383" href="SMT.Script.Show.html#10383" class="Bound">σ</a> <a id="10385" href="Data.Product.html#1806" class="Function">]</a> <a id="10387" class="Symbol">(</a><a id="10388" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="10390" href="SMT.Script.Base.html#2739" class="Function Operator">∋</a> <a id="10392" href="SMT.Script.Show.html#10383" class="Bound">σ</a><a id="10393" class="Symbol">))</a> <a id="10396" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="10400" href="SMT.Script.Show.html#10338" class="Function">getVarParser</a> <a id="10413" href="SMT.Script.Show.html#10413" class="Bound">scr</a> <a id="10417" class="Symbol">=</a> <a id="10419" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="10431" class="Symbol">(</a><a id="10432" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10438" class="Symbol">(</a><a id="10439" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10445" class="Symbol">(</a><a id="10446" href="SMT.Script.Show.html#9735" class="Function">showScriptS</a> <a id="10458" href="SMT.Script.Show.html#10413" class="Bound">scr</a> <a id="10462" class="Symbol">(</a><a id="10463" href="SMT.Script.Names.html#3140" class="Function">x′es</a> <a id="10468" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10470" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="10472" class="Symbol">))))</a>
</pre></body></html>