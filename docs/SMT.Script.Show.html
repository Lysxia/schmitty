<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Script.Show</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Comment">--------------------------------------------------------------------------------</a>
<a id="113" class="Comment">-- Schmitty the Solver</a>
<a id="136" class="Comment">--</a>
<a id="139" class="Comment">-- Defines `showScript`, which prints a script as an SMT query, as well as</a>
<a id="214" class="Comment">-- generating a parser which parses the output generated by the SMT solver for</a>
<a id="293" class="Comment">-- the query.</a>
<a id="307" class="Comment">--------------------------------------------------------------------------------</a>

<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="SMT.Theory.Base.html" class="Module">SMT.Theory.Base</a>

<a id="418" class="Keyword">module</a> <a id="425" href="SMT.Script.Show.html" class="Module">SMT.Script.Show</a> <a id="441" class="Symbol">(</a><a id="442" href="SMT.Script.Show.html#442" class="Bound">theory</a> <a id="449" class="Symbol">:</a> <a id="451" href="SMT.Theory.Base.html#3890" class="Record">Theory</a><a id="457" class="Symbol">)</a> <a id="459" class="Keyword">where</a>

<a id="466" class="Keyword">open</a> <a id="471" href="SMT.Theory.Base.html#3890" class="Module">Theory</a> <a id="478" href="SMT.Script.Show.html#442" class="Bound">theory</a>

<a id="486" class="Keyword">open</a> <a id="491" class="Keyword">import</a> <a id="498" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Codata.Musical.Stream.html" class="Module">Codata.Musical.Stream</a> <a id="547" class="Symbol">as</a> <a id="550" class="Module">Stream</a> <a id="557" class="Keyword">using</a> <a id="563" class="Symbol">(</a><a id="564" href="Codata.Musical.Stream.html#659" class="Datatype">Stream</a><a id="570" class="Symbol">)</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Data.Char.html" class="Module">Data.Char</a> <a id="594" class="Symbol">as</a> <a id="597" class="Module">Char</a> <a id="602" class="Keyword">using</a> <a id="608" class="Symbol">(</a><a id="609" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="613" class="Symbol">)</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="644" class="Symbol">as</a> <a id="647" class="Module">Env</a> <a id="651" class="Keyword">using</a> <a id="657" class="Symbol">(</a><a id="658" href="Data.Environment.html#360" class="Datatype">Env</a><a id="661" class="Symbol">;</a> <a id="663" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="666" class="Symbol">;</a> <a id="668" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="670" class="Symbol">)</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="693" class="Symbol">as</a> <a id="696" class="Module">Fin</a> <a id="700" class="Keyword">using</a> <a id="706" class="Symbol">(</a><a id="707" href="Data.Fin.Base.html#1126" class="Datatype">Fin</a><a id="710" class="Symbol">;</a> <a id="712" href="Data.Fin.Base.html#1179" class="InductiveConstructor">suc</a><a id="715" class="Symbol">;</a> <a id="717" href="Data.Fin.Base.html#1148" class="InductiveConstructor">zero</a><a id="721" class="Symbol">)</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Data.List.html" class="Module">Data.List</a> <a id="745" class="Symbol">as</a> <a id="748" class="Module">List</a> <a id="753" class="Keyword">using</a> <a id="759" class="Symbol">(</a><a id="760" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="764" class="Symbol">;</a> <a id="766" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="769" class="Symbol">;</a> <a id="771" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="773" class="Symbol">;</a> <a id="775" href="Data.List.Base.html#5025" class="Function Operator">[_]</a><a id="778" class="Symbol">;</a> <a id="780" href="Data.List.Base.html#9934" class="Function Operator">_ʳ++_</a><a id="785" class="Symbol">;</a> <a id="787" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="791" class="Symbol">;</a> <a id="793" href="Data.List.Base.html#4864" class="Function">length</a><a id="799" class="Symbol">)</a>
<a id="801" class="Keyword">open</a> <a id="806" class="Keyword">import</a> <a id="813" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="842" class="Symbol">as</a> <a id="845" class="Module">All</a> <a id="849" class="Keyword">using</a> <a id="855" class="Symbol">(</a><a id="856" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a><a id="859" class="Symbol">;</a> <a id="861" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">_∷_</a><a id="864" class="Symbol">;</a> <a id="866" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="868" class="Symbol">)</a>
<a id="870" class="Keyword">open</a> <a id="875" class="Keyword">import</a> <a id="882" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="911" class="Symbol">as</a> <a id="914" class="Module">Any</a> <a id="918" class="Keyword">using</a> <a id="924" class="Symbol">(</a><a id="925" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a><a id="929" class="Symbol">;</a> <a id="931" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a><a id="936" class="Symbol">)</a>
<a id="938" class="Keyword">open</a> <a id="943" class="Keyword">import</a> <a id="950" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="969" class="Symbol">as</a> <a id="972" class="Module">List⁺</a> <a id="978" class="Keyword">using</a> <a id="984" class="Symbol">(</a><a id="985" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a><a id="990" class="Symbol">;</a> <a id="992" href="Data.List.NonEmpty.Base.html#1125" class="InductiveConstructor Operator">_∷_</a><a id="995" class="Symbol">)</a>
<a id="997" class="Keyword">open</a> <a id="1002" class="Keyword">import</a> <a id="1009" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="1020" class="Symbol">as</a> <a id="1023" class="Module">Maybe</a> <a id="1029" class="Keyword">using</a> <a id="1035" class="Symbol">(</a><a id="1036" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="1041" class="Symbol">;</a> <a id="1043" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="1047" class="Symbol">;</a> <a id="1049" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="1056" class="Symbol">)</a>
<a id="1058" class="Keyword">import</a> <a id="1065" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="1088" class="Symbol">as</a> <a id="1091" class="Module">MaybeCat</a>
<a id="1100" class="Keyword">open</a> <a id="1105" class="Keyword">import</a> <a id="1112" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="1121" class="Symbol">as</a> <a id="1124" class="Module">Nat</a> <a id="1128" class="Keyword">using</a> <a id="1134" class="Symbol">(</a><a id="1135" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1136" class="Symbol">;</a> <a id="1138" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1141" class="Symbol">;</a> <a id="1143" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1147" class="Symbol">)</a>
<a id="1149" class="Keyword">open</a> <a id="1154" class="Keyword">import</a> <a id="1161" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="1175" class="Keyword">renaming</a> <a id="1184" class="Symbol">(</a><a id="1185" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1190" class="Symbol">to</a> <a id="1193" class="Function">showℕ</a><a id="1198" class="Symbol">)</a>
<a id="1200" class="Keyword">open</a> <a id="1205" class="Keyword">import</a> <a id="1212" href="Data.Product.html" class="Module">Data.Product</a> <a id="1225" class="Symbol">as</a> <a id="1228" class="Module">Prod</a> <a id="1233" class="Keyword">using</a> <a id="1239" class="Symbol">(</a><a id="1240" href="Data.Product.html#1369" class="Function">∃</a><a id="1241" class="Symbol">;</a> <a id="1243" href="Data.Product.html#1806" class="Function">∃-syntax</a><a id="1251" class="Symbol">;</a> <a id="1253" href="Data.Product.html#2247" class="Function Operator">-,_</a><a id="1256" class="Symbol">;</a> <a id="1258" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="1261" class="Symbol">;</a> <a id="1263" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="1266" class="Symbol">;</a> <a id="1268" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="1273" class="Symbol">;</a> <a id="1275" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1280" class="Symbol">)</a>
<a id="1282" class="Keyword">open</a> <a id="1287" class="Keyword">import</a> <a id="1294" href="Data.String.html" class="Module">Data.String</a> <a id="1306" class="Symbol">as</a> <a id="1309" class="Module">String</a> <a id="1316" class="Keyword">using</a> <a id="1322" class="Symbol">(</a><a id="1323" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="1329" class="Symbol">)</a>
<a id="1331" class="Keyword">open</a> <a id="1336" class="Keyword">import</a> <a id="1343" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="1353" class="Symbol">as</a> <a id="1356" class="Module">Unit</a> <a id="1361" class="Keyword">using</a> <a id="1367" class="Symbol">(</a><a id="1368" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="1369" class="Symbol">)</a>
<a id="1371" class="Keyword">open</a> <a id="1376" class="Keyword">import</a> <a id="1383" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1392" class="Symbol">as</a> <a id="1395" class="Module">Vec</a> <a id="1399" class="Keyword">using</a> <a id="1405" class="Symbol">(</a><a id="1406" href="Data.Vec.Base.html#998" class="Datatype">Vec</a><a id="1409" class="Symbol">;</a> <a id="1411" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">_∷_</a><a id="1414" class="Symbol">;</a> <a id="1416" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="1418" class="Symbol">)</a>
<a id="1420" class="Keyword">open</a> <a id="1425" class="Keyword">import</a> <a id="1432" href="Function.html" class="Module">Function</a> <a id="1441" class="Keyword">using</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Function.Base.html#1919" class="Function Operator">_$_</a><a id="1451" class="Symbol">;</a> <a id="1453" href="Function.Base.html#4121" class="Function Operator">case_of_</a><a id="1461" class="Symbol">;</a> <a id="1463" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="1466" class="Symbol">;</a> <a id="1468" href="Function.Base.html#636" class="Function">const</a><a id="1473" class="Symbol">;</a> <a id="1475" href="Function.Base.html#1554" class="Function">flip</a><a id="1479" class="Symbol">;</a> <a id="1481" href="Function.Base.html#615" class="Function">id</a><a id="1483" class="Symbol">)</a>
<a id="1485" class="Keyword">import</a> <a id="1492" href="Function.Identity.Categorical.html" class="Module">Function.Identity.Categorical</a> <a id="1522" class="Symbol">as</a> <a id="1525" class="Module">Identity</a>
<a id="1534" class="Keyword">import</a> <a id="1541" href="Level.html" class="Module">Level</a>
<a id="1547" class="Keyword">import</a> <a id="1554" href="Reflection.html" class="Module">Reflection</a> <a id="1565" class="Symbol">as</a> <a id="1568" class="Module">Rfl</a>
<a id="1572" class="Keyword">open</a> <a id="1577" class="Keyword">import</a> <a id="1584" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1601" class="Keyword">using</a> <a id="1607" class="Symbol">(</a><a id="1608" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="1611" class="Symbol">;</a> <a id="1613" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="1615" class="Symbol">)</a>
<a id="1617" class="Keyword">open</a> <a id="1622" class="Keyword">import</a> <a id="1629" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1667" class="Keyword">using</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="1677" class="Symbol">;</a> <a id="1679" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1683" class="Symbol">)</a>
<a id="1685" class="Keyword">open</a> <a id="1690" class="Keyword">import</a> <a id="1697" href="SMT.Script.Base.html" class="Module">SMT.Script.Base</a> <a id="1713" href="SMT.Theory.Base.html#3922" class="Field">baseTheory</a>
<a id="1724" class="Keyword">open</a> <a id="1729" class="Keyword">import</a> <a id="1736" href="SMT.Script.Names.html" class="Module">SMT.Script.Names</a> <a id="1753" href="SMT.Theory.Base.html#3922" class="Field">baseTheory</a>

<a id="1765" class="Keyword">private</a>
  <a id="1775" class="Keyword">variable</a>
    <a id="1788" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="1790" href="SMT.Script.Show.html#1790" class="Generalizable">σ′</a>    <a id="1796" class="Symbol">:</a> <a id="1798" href="SMT.Theory.Base.html#2591" class="Function">Sort</a>
    <a id="1807" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="1809" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="1812" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="1815" class="Symbol">:</a> <a id="1817" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a>
    <a id="1826" href="SMT.Script.Show.html#1826" class="Generalizable">Δ</a> <a id="1828" href="SMT.Script.Show.html#1828" class="Generalizable">Δ′</a>    <a id="1834" class="Symbol">:</a> <a id="1836" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a>
    <a id="1845" href="SMT.Script.Show.html#1845" class="Generalizable">Σ</a>       <a id="1853" class="Symbol">:</a> <a id="1855" href="SMT.Theory.Base.html#1984" class="Record">Signature</a> <a id="1865" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a>
    <a id="1871" href="SMT.Script.Show.html#1871" class="Generalizable">Σ′</a>      <a id="1879" class="Symbol">:</a> <a id="1881" href="SMT.Theory.Base.html#1984" class="Record">Signature</a> <a id="1891" href="SMT.Script.Show.html#1790" class="Generalizable">σ′</a>
    <a id="1898" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="1900" href="SMT.Script.Show.html#1900" class="Generalizable">ξ′</a>    <a id="1906" class="Symbol">:</a> <a id="1908" href="SMT.Script.Base.html#5643" class="Datatype">OutputType</a>
    <a id="1923" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="1925" href="SMT.Script.Show.html#1925" class="Generalizable">Ξ′</a> <a id="1928" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a> <a id="1931" class="Symbol">:</a> <a id="1933" href="SMT.Script.Base.html#5737" class="Function">OutputCtxt</a>


<a id="1946" class="Comment">-- * Parsers</a>

<a id="1960" class="Keyword">module</a> <a id="1967" href="SMT.Script.Show.html#1967" class="Module">_</a> <a id="1969" class="Keyword">where</a>

  <a id="1978" class="Keyword">open</a> <a id="1983" class="Keyword">import</a> <a id="1990" href="Text.Parser.String.html" class="Module">Text.Parser.String</a>

  <a id="2012" class="Comment">-- * Variable parsers</a>

  <a id="2037" class="Comment">-- |Environment of variable parsers.</a>
  <a id="2076" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2087" class="Symbol">:</a> <a id="2089" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a> <a id="2094" class="Symbol">→</a> <a id="2096" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2102" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2113" class="Symbol">=</a> <a id="2115" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2119" class="Symbol">(λ</a> <a id="2122" href="SMT.Script.Show.html#2122" class="Bound">σ</a> <a id="2124" href="SMT.Script.Show.html#2124" class="Bound">Γ</a> <a id="2126" class="Symbol">→</a> <a id="2128" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2131" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2138" class="Symbol">((</a><a id="2140" href="SMT.Script.Show.html#2122" class="Bound">σ</a> <a id="2142" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2144" href="SMT.Script.Show.html#2124" class="Bound">Γ</a><a id="2145" class="Symbol">)</a> <a id="2147" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="2149" href="SMT.Script.Show.html#2122" class="Bound">σ</a><a id="2150" class="Symbol">)</a> <a id="2152" href="Relation.Unary.html#3359" class="Function">]</a><a id="2153" class="Symbol">)</a>

  <a id="2158" class="Comment">-- |Construct a single variable parser from an environment of variable parsers.</a>
  <a id="2240" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2252" class="Symbol">:</a> <a id="2254" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="2265" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="2267" class="Symbol">→</a> <a id="2269" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2272" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2279" class="Symbol">(</a><a id="2280" href="Data.Product.html#1806" class="Function">∃[</a> <a id="2283" href="SMT.Script.Show.html#2283" class="Bound">σ</a> <a id="2285" href="Data.Product.html#1806" class="Function">]</a> <a id="2287" class="Symbol">(</a><a id="2288" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="2290" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="2292" href="SMT.Script.Show.html#2283" class="Bound">σ</a><a id="2293" class="Symbol">))</a> <a id="2296" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2300" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2312" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>            <a id="2326" class="Symbol">=</a> <a id="2328" href="Text.Parser.String.html#5367" class="Function">fail</a>
  <a id="2335" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2347" class="Symbol">(</a><a id="2348" href="SMT.Script.Show.html#2348" class="Bound">p</a> <a id="2350" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="2352" href="SMT.Script.Show.html#2352" class="Bound">env</a><a id="2355" class="Symbol">)</a> <a id="2357" class="Symbol">{</a><a id="2358" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2359" class="Symbol">}</a> <a id="2361" class="Symbol">=</a> <a id="2363" class="Symbol">(</a><a id="2364" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="2368" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="2372" href="SMT.Script.Show.html#2348" class="Bound">p</a> <a id="2374" class="Symbol">{</a><a id="2375" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2376" class="Symbol">})</a> <a id="2379" href="Text.Parser.String.html#5440" class="Function Operator">&lt;|&gt;</a> <a id="2383" class="Symbol">(</a><a id="2384" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="2393" href="Function.Base.html#615" class="Function">id</a> <a id="2396" href="SMT.Script.Base.html#2780" class="Function">extendVar</a> <a id="2406" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="2410" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="2422" href="SMT.Script.Show.html#2352" class="Bound">env</a> <a id="2426" class="Symbol">{</a><a id="2427" href="SMT.Script.Show.html#2358" class="Bound">x</a><a id="2428" class="Symbol">})</a>


  <a id="2435" class="Comment">-- * Output parsers</a>

  <a id="2458" class="Comment">-- |Mapping from output types to parser types.</a>
  <a id="2507" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2520" class="Symbol">:</a> <a id="2522" href="SMT.Script.Base.html#5643" class="Datatype">OutputType</a> <a id="2533" class="Symbol">→</a> <a id="2535" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2541" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2554" href="SMT.Script.Show.html#2554" class="Bound">ξ</a> <a id="2556" class="Symbol">=</a> <a id="2558" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2561" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2568" class="Symbol">(</a><a id="2569" href="SMT.Script.Base.html#6864" class="Function">Output</a> <a id="2576" href="SMT.Script.Show.html#2554" class="Bound">ξ</a><a id="2577" class="Symbol">)</a> <a id="2579" href="Relation.Unary.html#3359" class="Function">]</a>

  <a id="2584" class="Comment">-- |Mapping from output contexts to parser types.</a>
  <a id="2636" class="Comment">--</a>
  <a id="2641" class="Comment">-- TODO: Replace use of Env with All.</a>
  <a id="2681" class="Comment">--</a>
  <a id="2686" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="2700" class="Symbol">:</a> <a id="2702" href="SMT.Script.Base.html#5737" class="Function">OutputCtxt</a> <a id="2713" class="Symbol">→</a> <a id="2715" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2721" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="2735" href="SMT.Script.Show.html#2735" class="Bound">Ξ</a> <a id="2737" class="Symbol">=</a> <a id="2739" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="2743" class="Symbol">(λ</a> <a id="2746" href="SMT.Script.Show.html#2746" class="Bound">ξ</a> <a id="2748" href="SMT.Script.Show.html#2748" class="Bound Operator">_Ξ</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="SMT.Script.Show.html#2507" class="Function">OutputParser</a> <a id="2766" href="SMT.Script.Show.html#2746" class="Bound">ξ</a><a id="2767" class="Symbol">)</a> <a id="2769" href="SMT.Script.Show.html#2735" class="Bound">Ξ</a>

  <a id="2774" class="Comment">-- |Parse a satisfiability result.</a>
  <a id="2811" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2816" class="Symbol">:</a> <a id="2818" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="2821" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="2828" href="SMT.Script.Base.html#5888" class="Datatype">Sat</a> <a id="2832" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="2836" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2841" class="Symbol">=</a> <a id="2843" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>    <a id="2850" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="2853" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="2860" class="String">&quot;sat&quot;</a>
    <a id="2870" href="Text.Parser.String.html#5440" class="Function Operator">&lt;|&gt;</a> <a id="2874" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="2882" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="2885" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="2892" class="String">&quot;unsat&quot;</a>
    <a id="2904" href="Text.Parser.String.html#5440" class="Function Operator">&lt;|&gt;</a> <a id="2908" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="2916" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="2919" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="2926" class="String">&quot;unknown&quot;</a>

  <a id="2939" href="SMT.Script.Show.html#2939" class="Function">_</a> <a id="2941" class="Symbol">:</a> <a id="2943" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2948" href="Text.Parser.String.html#8559" class="Function Operator">parses</a> <a id="2955" class="String">&quot;sat&quot;</a>
  <a id="2963" class="Symbol">_</a> <a id="2965" class="Symbol">=</a> <a id="2967" href="Text.Parser.String.html#8167" class="InductiveConstructor Operator">!</a> <a id="2969" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>

  <a id="2976" href="SMT.Script.Show.html#2976" class="Function">_</a> <a id="2978" class="Symbol">:</a> <a id="2980" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="2985" href="Text.Parser.String.html#8559" class="Function Operator">parses</a> <a id="2992" class="String">&quot;unsat&quot;</a>
  <a id="3002" class="Symbol">_</a> <a id="3004" class="Symbol">=</a> <a id="3006" href="Text.Parser.String.html#8167" class="InductiveConstructor Operator">!</a> <a id="3008" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>

  <a id="3017" href="SMT.Script.Show.html#3017" class="Function">_</a> <a id="3019" class="Symbol">:</a> <a id="3021" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="3026" href="Text.Parser.String.html#8559" class="Function Operator">parses</a> <a id="3033" class="String">&quot;unknown&quot;</a>
  <a id="3045" class="Symbol">_</a> <a id="3047" class="Symbol">=</a> <a id="3049" href="Text.Parser.String.html#8167" class="InductiveConstructor Operator">!</a> <a id="3051" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a>

  <a id="3062" href="SMT.Script.Show.html#3062" class="Function">_</a> <a id="3064" class="Symbol">:</a> <a id="3066" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="3071" href="Text.Parser.String.html#8991" class="Function Operator">rejects</a> <a id="3079" class="String">&quot;dogfood&quot;</a>
  <a id="3091" class="Symbol">_</a> <a id="3093" class="Symbol">=</a> <a id="3095" class="Symbol">_</a>


  <a id="3101" class="Comment">-- |Construct a definitions parser from a variable parser.</a>
  <a id="3162" class="Comment">--</a>
  <a id="3167" class="Comment">-- @</a>
  <a id="3174" class="Comment">--   (define-fun x0 () Int (- 1))</a>
  <a id="3210" class="Comment">-- @</a>
  <a id="3217" class="Comment">--</a>
  <a id="3222" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="3235" class="Symbol">:</a> <a id="3237" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3240" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3247" class="Symbol">(</a><a id="3248" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3252" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3253" class="Symbol">)</a> <a id="3255" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3257" class="Symbol">→</a> <a id="3259" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3262" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3269" class="Symbol">(</a><a id="3270" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="3275" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3276" class="Symbol">)</a> <a id="3278" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="3282" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="3295" class="Symbol">{</a><a id="3296" href="SMT.Script.Show.html#3296" class="Bound">Γ</a><a id="3297" class="Symbol">}</a> <a id="3299" href="SMT.Script.Show.html#3299" class="Bound">pVar</a> <a id="3304" class="Symbol">=</a> <a id="3306" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="3317" class="Symbol">(</a><a id="3318" href="Text.Parser.String.html#4234" class="Function">guardM</a> <a id="3325" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3335" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a><a id="3342" class="Symbol">)</a>
    <a id="3348" class="Keyword">where</a>
      <a id="3360" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a> <a id="3368" class="Symbol">:</a> <a id="3370" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3373" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3380" class="Symbol">(</a><a id="3381" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3385" href="SMT.Script.Show.html#3296" class="Bound">Γ</a> <a id="3387" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3389" href="SMT.Script.Base.html#10576" class="Function">Val</a><a id="3392" class="Symbol">)</a> <a id="3394" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="3402" href="SMT.Script.Show.html#3360" class="Function">pVarVal</a> <a id="3410" class="Symbol">=</a>
        <a id="3420" href="Text.Parser.String.html#7204" class="Function">parens</a> <a id="3427" class="Symbol">(</a><a id="3428" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3432" class="Symbol">(</a><a id="3433" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="3440" class="String">&quot;define-fun&quot;</a> <a id="3453" href="Text.Parser.String.html#4617" class="Function Operator">&amp;&gt;</a> <a id="3456" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3460" class="Symbol">(</a><a id="3461" href="SMT.Script.Show.html#3299" class="Bound">pVar</a> <a id="3466" href="Text.Parser.String.html#4446" class="Function Operator">&lt;&amp;&gt;</a>
          <a id="3480" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3484" class="Symbol">(</a><a id="3485" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="3492" class="String">&quot;()&quot;</a> <a id="3497" href="Text.Parser.String.html#4617" class="Function Operator">&amp;&gt;</a> <a id="3500" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3504" class="Symbol">(</a><a id="3505" href="SMT.Theory.Base.html#3800" class="Function">parseSort</a> <a id="3515" href="Text.Parser.String.html#4324" class="Function Operator">&gt;&gt;=</a> <a id="3519" class="Symbol">λ</a> <a id="3521" href="SMT.Script.Show.html#3521" class="Bound">σ</a> <a id="3523" class="Symbol">→</a> <a id="3525" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="3529" class="Symbol">(</a><a id="3530" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="3534" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="3538" href="SMT.Theory.Base.html#3834" class="Function">parseValue</a> <a id="3549" href="SMT.Script.Show.html#3521" class="Bound">σ</a><a id="3550" class="Symbol">))))))</a>

      <a id="3564" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3574" class="Symbol">:</a> <a id="3576" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3580" href="SMT.Script.Show.html#3296" class="Bound">Γ</a> <a id="3582" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3584" href="SMT.Script.Base.html#10576" class="Function">Val</a> <a id="3588" class="Symbol">→</a> <a id="3590" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3596" class="Symbol">(</a><a id="3597" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="3602" href="SMT.Script.Show.html#3296" class="Bound">Γ</a><a id="3603" class="Symbol">)</a>
      <a id="3611" href="SMT.Script.Show.html#3564" class="Function">checkDefn</a> <a id="3621" class="Symbol">((</a><a id="3623" href="SMT.Script.Show.html#3623" class="Bound">σ</a> <a id="3625" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3627" href="SMT.Script.Show.html#3627" class="Bound">i</a><a id="3628" class="Symbol">)</a> <a id="3630" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3632" class="Symbol">(</a><a id="3633" href="SMT.Script.Show.html#3633" class="Bound">σ′</a> <a id="3636" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3638" href="SMT.Script.Show.html#3638" class="Bound">v</a><a id="3639" class="Symbol">))</a> <a id="3642" class="Keyword">with</a> <a id="3647" href="SMT.Script.Show.html#3623" class="Bound">σ</a> <a id="3649" href="SMT.Theory.Base.html#2615" class="Function Operator">≟-Sort</a> <a id="3656" href="SMT.Script.Show.html#3633" class="Bound">σ′</a>
      <a id="3665" class="Symbol">...</a> <a id="3669" class="Symbol">|</a> <a id="3671" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3675" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3680" class="Symbol">=</a> <a id="3682" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3687" class="Symbol">(</a><a id="3688" class="Bound">σ</a> <a id="3690" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3692" class="Bound">i</a> <a id="3694" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3696" class="Bound">v</a><a id="3697" class="Symbol">)</a>
      <a id="3705" class="Symbol">...</a> <a id="3709" class="Symbol">|</a> <a id="3711" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="3715" class="Symbol">_</a>    <a id="3720" class="Symbol">=</a> <a id="3722" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="3734" class="Comment">-- |Construct a definition-list parser from a variable parser.</a>
  <a id="3799" class="Comment">--</a>
  <a id="3804" class="Comment">-- NOTE: z3 version 4.8.10 no longer seems to use the symbol &quot;model&quot; in its</a>
  <a id="3882" class="Comment">--       models, so the Schmitty output parser /optionally/ accepts it</a>
  <a id="3955" class="Comment">--</a>
  <a id="3960" href="SMT.Script.Show.html#3960" class="Function">mkDefnsParser</a> <a id="3974" class="Symbol">:</a> <a id="3976" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3979" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="3986" class="Symbol">(</a><a id="3987" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="3991" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="3992" class="Symbol">)</a> <a id="3994" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3996" class="Symbol">→</a> <a id="3998" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4001" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="4008" class="Symbol">(</a><a id="4009" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="4015" class="Symbol">(</a><a id="4016" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="4021" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4022" class="Symbol">))</a> <a id="4025" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="4029" href="SMT.Script.Show.html#3960" class="Function">mkDefnsParser</a> <a id="4043" class="Symbol">{</a><a id="4044" href="SMT.Script.Show.html#4044" class="Bound">Γ</a><a id="4045" class="Symbol">}</a> <a id="4047" href="SMT.Script.Show.html#4047" class="Bound">pVar</a> <a id="4052" class="Symbol">=</a>
    <a id="4058" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="4069" class="Symbol">(</a><a id="4070" href="Text.Parser.String.html#7204" class="Function">parens</a> <a id="4077" class="Symbol">(</a><a id="4078" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="4082" class="Symbol">(</a><a id="4083" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="4090" class="String">&quot;model&quot;</a> <a id="4098" href="Text.Parser.String.html#5218" class="Function Operator">?&amp;&gt;</a> <a id="4102" href="Text.Parser.String.html#5973" class="Function">list⁺</a> <a id="4108" class="Symbol">(</a><a id="4109" href="SMT.Script.Show.html#3222" class="Function">mkDefnParser</a> <a id="4122" class="Symbol">{</a><a id="4123" href="SMT.Script.Show.html#4044" class="Bound">Γ</a><a id="4124" class="Symbol">}</a> <a id="4126" href="SMT.Script.Show.html#4047" class="Bound">pVar</a><a id="4130" class="Symbol">))))</a>


  <a id="4139" class="Keyword">private</a>
    <a id="4151" href="SMT.Script.Show.html#4151" class="Function">MaybeModel</a> <a id="4162" class="Symbol">:</a> <a id="4164" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a> <a id="4169" class="Symbol">→</a> <a id="4171" href="Agda.Primitive.html#326" class="Primitive">Set</a>
    <a id="4179" href="SMT.Script.Show.html#4151" class="Function">MaybeModel</a> <a id="4190" href="SMT.Script.Show.html#4190" class="Bound">Γ</a> <a id="4192" class="Symbol">=</a> <a id="4194" href="Data.Environment.html#360" class="Datatype">Env</a> <a id="4198" class="Symbol">(λ</a> <a id="4201" href="SMT.Script.Show.html#4201" class="Bound">σ</a> <a id="4203" href="SMT.Script.Show.html#4203" class="Bound Operator">_Γ</a> <a id="4206" class="Symbol">→</a> <a id="4208" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4213" class="Symbol">(</a><a id="4214" href="SMT.Theory.Base.html#3335" class="Function">Value</a> <a id="4220" href="SMT.Script.Show.html#4201" class="Bound">σ</a><a id="4221" class="Symbol">))</a> <a id="4224" href="SMT.Script.Show.html#4190" class="Bound">Γ</a>

    <a id="4231" href="SMT.Script.Show.html#4231" class="Function">insertMM</a> <a id="4240" class="Symbol">:</a> <a id="4242" href="Data.Product.html#1806" class="Function">∃[</a> <a id="4245" href="SMT.Script.Show.html#4245" class="Bound">σ</a> <a id="4247" href="Data.Product.html#1806" class="Function">]</a> <a id="4249" class="Symbol">(</a><a id="4250" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4252" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="4254" href="SMT.Script.Show.html#4245" class="Bound">σ</a> <a id="4256" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4258" href="SMT.Theory.Base.html#3335" class="Function">Value</a> <a id="4264" href="SMT.Script.Show.html#4245" class="Bound">σ</a><a id="4265" class="Symbol">)</a> <a id="4267" class="Symbol">→</a> <a id="4269" href="SMT.Script.Show.html#4151" class="Function">MaybeModel</a> <a id="4280" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4282" class="Symbol">→</a> <a id="4284" href="SMT.Script.Show.html#4151" class="Function">MaybeModel</a> <a id="4295" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a>
    <a id="4301" href="SMT.Script.Show.html#4231" class="Function">insertMM</a> <a id="4310" class="Symbol">{</a><a id="4311" class="DottedPattern Symbol">.</a><a id="4312" href="SMT.Script.Show.html#4320" class="DottedPattern Bound">σ</a> <a id="4314" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4316" href="SMT.Script.Show.html#4316" class="Bound">Γ</a><a id="4317" class="Symbol">}</a> <a id="4319" class="Symbol">(</a><a id="4320" href="SMT.Script.Show.html#4320" class="Bound">σ</a> <a id="4322" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4324" class="Symbol">(</a><a id="4325" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="4330" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="4334" class="Symbol">)</a> <a id="4336" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4338" href="SMT.Script.Show.html#4338" class="Bound">v</a><a id="4339" class="Symbol">)</a> <a id="4341" class="Symbol">(</a><a id="4342" href="SMT.Script.Show.html#4342" class="Bound">vs</a> <a id="4345" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4347" href="SMT.Script.Show.html#4347" class="Bound">env</a><a id="4350" class="Symbol">)</a> <a id="4352" class="Symbol">=</a> <a id="4354" class="Symbol">(</a><a id="4355" href="SMT.Script.Show.html#4338" class="Bound">v</a> <a id="4357" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4359" href="SMT.Script.Show.html#4342" class="Bound">vs</a><a id="4361" class="Symbol">)</a> <a id="4363" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4365" href="SMT.Script.Show.html#4347" class="Bound">env</a>
    <a id="4373" href="SMT.Script.Show.html#4231" class="Function">insertMM</a> <a id="4382" class="Symbol">{</a><a id="4383" href="SMT.Script.Show.html#4383" class="Bound">σ′</a> <a id="4386" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4388" href="SMT.Script.Show.html#4388" class="Bound">Γ</a><a id="4389" class="Symbol">}</a> <a id="4391" class="Symbol">(</a><a id="4392" href="SMT.Script.Show.html#4392" class="Bound">σ</a> <a id="4394" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4396" class="Symbol">(</a><a id="4397" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="4403" href="SMT.Script.Show.html#4403" class="Bound">p</a><a id="4404" class="Symbol">)</a>   <a id="4408" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4410" href="SMT.Script.Show.html#4410" class="Bound">v</a><a id="4411" class="Symbol">)</a> <a id="4413" class="Symbol">(</a><a id="4414" href="SMT.Script.Show.html#4414" class="Bound">vs</a> <a id="4417" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4419" href="SMT.Script.Show.html#4419" class="Bound">env</a><a id="4422" class="Symbol">)</a> <a id="4424" class="Symbol">=</a> <a id="4426" href="SMT.Script.Show.html#4414" class="Bound">vs</a> <a id="4429" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4431" href="SMT.Script.Show.html#4231" class="Function">insertMM</a> <a id="4440" class="Symbol">(</a><a id="4441" href="SMT.Script.Show.html#4392" class="Bound">σ</a> <a id="4443" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4445" href="SMT.Script.Show.html#4403" class="Bound">p</a> <a id="4447" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4449" href="SMT.Script.Show.html#4410" class="Bound">v</a><a id="4450" class="Symbol">)</a> <a id="4452" href="SMT.Script.Show.html#4419" class="Bound">env</a>

    <a id="4461" href="SMT.Script.Show.html#4461" class="Function">mkMM</a> <a id="4466" class="Symbol">:</a> <a id="4468" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4473" class="Symbol">(</a><a id="4474" href="SMT.Script.Base.html#10610" class="Function">Defn</a> <a id="4479" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4480" class="Symbol">)</a> <a id="4482" class="Symbol">→</a> <a id="4484" href="SMT.Script.Show.html#4151" class="Function">MaybeModel</a> <a id="4495" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a>
    <a id="4501" href="SMT.Script.Show.html#4461" class="Function">mkMM</a> <a id="4506" class="Symbol">{</a><a id="4507" href="SMT.Script.Show.html#4507" class="Bound">Γ</a><a id="4508" class="Symbol">}</a> <a id="4510" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="4519" class="Symbol">=</a> <a id="4521" href="Data.Environment.html#1028" class="Function">Env.repeat</a> <a id="4532" class="Symbol">(λ</a> <a id="4535" href="SMT.Script.Show.html#4535" class="Bound Operator">_σ</a> <a id="4538" href="SMT.Script.Show.html#4538" class="Bound Operator">_Γ</a> <a id="4541" class="Symbol">→</a> <a id="4543" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4545" class="Symbol">)</a> <a id="4547" href="SMT.Script.Show.html#4507" class="Bound">Γ</a>
    <a id="4553" href="SMT.Script.Show.html#4461" class="Function">mkMM</a> <a id="4558" class="Symbol">{</a><a id="4559" href="SMT.Script.Show.html#4559" class="Bound">Γ</a><a id="4560" class="Symbol">}</a> <a id="4562" class="Symbol">(</a><a id="4563" href="SMT.Script.Show.html#4563" class="Bound">v</a> <a id="4565" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4567" href="SMT.Script.Show.html#4567" class="Bound">vs</a><a id="4569" class="Symbol">)</a> <a id="4571" class="Symbol">=</a> <a id="4573" href="SMT.Script.Show.html#4231" class="Function">insertMM</a> <a id="4582" href="SMT.Script.Show.html#4563" class="Bound">v</a> <a id="4584" class="Symbol">(</a><a id="4585" href="SMT.Script.Show.html#4461" class="Function">mkMM</a> <a id="4590" href="SMT.Script.Show.html#4567" class="Bound">vs</a><a id="4592" class="Symbol">)</a>

    <a id="4599" href="SMT.Script.Show.html#4599" class="Function">fromSingleton</a> <a id="4613" class="Symbol">:</a> <a id="4615" class="Symbol">{</a><a id="4616" href="SMT.Script.Show.html#4616" class="Bound">A</a> <a id="4618" class="Symbol">:</a> <a id="4620" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="4623" class="Symbol">}</a> <a id="4625" class="Symbol">→</a> <a id="4627" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4632" href="SMT.Script.Show.html#4616" class="Bound">A</a> <a id="4634" class="Symbol">→</a> <a id="4636" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4642" href="SMT.Script.Show.html#4616" class="Bound">A</a>
    <a id="4648" href="SMT.Script.Show.html#4599" class="Function">fromSingleton</a> <a id="4662" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4665" class="Symbol">=</a> <a id="4667" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
    <a id="4679" href="SMT.Script.Show.html#4599" class="Function">fromSingleton</a> <a id="4693" class="Symbol">(</a><a id="4694" href="SMT.Script.Show.html#4694" class="Bound">v</a> <a id="4696" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4698" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4700" class="Symbol">)</a> <a id="4702" class="Symbol">=</a> <a id="4704" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4709" href="SMT.Script.Show.html#4694" class="Bound">v</a>
    <a id="4715" href="SMT.Script.Show.html#4599" class="Function">fromSingleton</a> <a id="4729" class="Symbol">(_</a> <a id="4732" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4734" class="Symbol">_</a> <a id="4736" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4738" class="Symbol">_)</a> <a id="4741" class="Symbol">=</a> <a id="4743" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>

    <a id="4756" href="SMT.Script.Show.html#4756" class="Function">checkMM</a> <a id="4764" class="Symbol">:</a> <a id="4766" href="SMT.Script.Show.html#4151" class="Function">MaybeModel</a> <a id="4777" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="4779" class="Symbol">→</a> <a id="4781" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4787" class="Symbol">(</a><a id="4788" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="4794" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="4795" class="Symbol">)</a>
    <a id="4801" href="SMT.Script.Show.html#4756" class="Function">checkMM</a> <a id="4809" href="Data.Environment.html#410" class="InductiveConstructor">[]</a> <a id="4812" class="Symbol">=</a> <a id="4814" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4819" href="SMT.Script.Base.html#6612" class="InductiveConstructor">[]</a>
    <a id="4826" href="SMT.Script.Show.html#4756" class="Function">checkMM</a> <a id="4834" class="Symbol">(</a><a id="4835" href="SMT.Script.Show.html#4835" class="Bound">vs</a> <a id="4838" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="4840" href="SMT.Script.Show.html#4840" class="Bound">env</a><a id="4843" class="Symbol">)</a> <a id="4845" class="Symbol">=</a> <a id="4847" href="Data.Maybe.Base.html#2868" class="Function">Maybe.zipWith</a> <a id="4861" href="SMT.Script.Base.html#6629" class="InductiveConstructor Operator">_∷_</a> <a id="4865" class="Symbol">(</a><a id="4866" href="SMT.Script.Show.html#4599" class="Function">fromSingleton</a> <a id="4880" href="SMT.Script.Show.html#4835" class="Bound">vs</a><a id="4882" class="Symbol">)</a> <a id="4884" class="Symbol">(</a><a id="4885" href="SMT.Script.Show.html#4756" class="Function">checkMM</a> <a id="4893" href="SMT.Script.Show.html#4840" class="Bound">env</a><a id="4896" class="Symbol">)</a>

  <a id="4901" href="SMT.Script.Show.html#4901" class="Function">pModelError</a> <a id="4913" class="Symbol">:</a> <a id="4915" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4918" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="4925" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="4927" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="4931" href="SMT.Script.Show.html#4901" class="Function">pModelError</a> <a id="4943" class="Symbol">=</a> <a id="4945" class="Symbol">_</a> <a id="4947" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="4950" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="4961" class="Symbol">(</a><a id="4962" href="Text.Parser.String.html#7204" class="Function">parens</a> <a id="4969" class="Symbol">(</a>
    <a id="4975" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="4979" class="Symbol">(</a><a id="4980" href="Text.Parser.String.html#6662" class="Function">lexeme</a> <a id="4987" class="String">&quot;error&quot;</a> <a id="4995" href="Text.Parser.String.html#4617" class="Function Operator">&amp;&gt;</a> <a id="4998" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5002" class="Symbol">(</a><a id="5003" href="Text.Parser.String.html#6970" class="Function">between</a> <a id="5011" class="Symbol">(</a><a id="5012" href="Text.Parser.String.html#6052" class="Function">char</a> <a id="5017" class="String">&#39;&quot;&#39;</a><a id="5020" class="Symbol">)</a> <a id="5022" class="Symbol">(</a><a id="5023" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5027" class="Symbol">(</a><a id="5028" href="Text.Parser.String.html#6052" class="Function">char</a> <a id="5033" class="String">&#39;&quot;&#39;</a><a id="5036" class="Symbol">))</a> <a id="5039" class="Symbol">(</a><a id="5040" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5044" class="Symbol">(</a><a id="5045" href="Text.Parser.String.html#5973" class="Function">list⁺</a> <a id="5051" class="Symbol">(</a><a id="5052" href="Text.Parser.String.html#6120" class="Function">anyCharBut</a> <a id="5063" class="String">&#39;&quot;&#39;</a><a id="5066" class="Symbol">)))))))</a>

  <a id="5077" class="Comment">-- |Construct a model parser from a variable parser.</a>
  <a id="5132" href="SMT.Script.Show.html#5132" class="Function">mkModelParser</a> <a id="5146" class="Symbol">:</a> <a id="5148" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5151" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5158" class="Symbol">(</a><a id="5159" href="SMT.Script.Base.html#10535" class="Function">Var</a> <a id="5163" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="5164" class="Symbol">)</a> <a id="5166" href="Relation.Unary.html#3359" class="Function">]</a> <a id="5168" class="Symbol">→</a> <a id="5170" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5173" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5180" class="Symbol">(</a><a id="5181" href="SMT.Script.Base.html#6670" class="Function">QualifiedModel</a> <a id="5196" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="5197" class="Symbol">)</a> <a id="5199" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="5203" href="SMT.Script.Show.html#5132" class="Function">mkModelParser</a> <a id="5217" class="Symbol">{</a><a id="5218" href="SMT.Script.Show.html#5218" class="Bound">Γ</a><a id="5219" class="Symbol">}</a> <a id="5221" href="SMT.Script.Show.html#5221" class="Bound">pVar</a> <a id="5226" class="Symbol">=</a> <a id="5228" class="Keyword">do</a>
    <a id="5235" href="SMT.Script.Show.html#5235" class="Bound">s</a> <a id="5237" href="Text.Parser.String.html#4324" class="Function Operator">←</a> <a id="5239" href="SMT.Script.Show.html#2811" class="Function">pSat</a>
    <a id="5248" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="5253" href="SMT.Script.Show.html#5235" class="Bound">s</a> <a id="5255" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="5258" class="Symbol">λ</a> <a id="5260" class="Keyword">where</a>
      <a id="5272" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>     <a id="5280" class="Symbol">→</a> <a id="5282" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5286" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5288" class="Symbol">(</a><a id="5289" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a> <a id="5293" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5295" class="Symbol">)</a>     <a id="5301" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5305" href="SMT.Script.Show.html#5505" class="Function">pModel</a>
      <a id="5318" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="5326" class="Symbol">→</a> <a id="5328" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5332" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5334" class="Symbol">(</a><a id="5335" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a> <a id="5341" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5343" class="Symbol">)</a>   <a id="5347" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5351" href="SMT.Script.Show.html#4901" class="Function">pModelError</a>
      <a id="5369" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5377" class="Symbol">→</a> <a id="5379" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5383" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="5385" class="Symbol">(</a><a id="5386" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5394" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a><a id="5396" class="Symbol">)</a> <a id="5398" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5402" href="SMT.Script.Show.html#4901" class="Function">pModelError</a>
    <a id="5418" class="Keyword">where</a>
      <a id="5430" class="Comment">-- Insert each definition into a model, and check if it is complete.</a>
      <a id="5505" href="SMT.Script.Show.html#5505" class="Function">pModel</a> <a id="5512" class="Symbol">:</a> <a id="5514" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5517" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5524" class="Symbol">(</a><a id="5525" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="5531" href="SMT.Script.Show.html#5218" class="Bound">Γ</a><a id="5532" class="Symbol">)</a> <a id="5534" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="5542" href="SMT.Script.Show.html#5505" class="Function">pModel</a> <a id="5549" class="Symbol">=</a> <a id="5551" href="Text.Parser.String.html#4234" class="Function">guardM</a> <a id="5558" href="SMT.Script.Show.html#4756" class="Function">checkMM</a> <a id="5566" class="Symbol">(</a><a id="5567" href="SMT.Script.Show.html#4461" class="Function">mkMM</a> <a id="5572" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5574" href="Data.List.NonEmpty.Base.html#1521" class="Function">List⁺.toList</a> <a id="5587" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="5591" href="SMT.Script.Show.html#3960" class="Function">mkDefnsParser</a> <a id="5605" class="Symbol">{</a><a id="5606" href="SMT.Script.Show.html#5218" class="Bound">Γ</a><a id="5607" class="Symbol">}</a> <a id="5609" href="SMT.Script.Show.html#5221" class="Bound">pVar</a><a id="5613" class="Symbol">)</a>

      <a id="5622" href="SMT.Script.Show.html#5622" class="Function">pMaybeQualifiedModel</a> <a id="5643" class="Symbol">:</a> <a id="5645" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5648" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="5655" class="Symbol">(</a><a id="5656" href="SMT.Script.Base.html#5888" class="Datatype">Sat</a> <a id="5660" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5662" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5668" class="Symbol">(</a><a id="5669" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="5675" href="SMT.Script.Show.html#5218" class="Bound">Γ</a><a id="5676" class="Symbol">))</a> <a id="5679" href="Relation.Unary.html#3359" class="Function">]</a>
      <a id="5687" href="SMT.Script.Show.html#5622" class="Function">pMaybeQualifiedModel</a> <a id="5708" class="Symbol">=</a> <a id="5710" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="5715" href="Text.Parser.String.html#4727" class="Function Operator">&lt;&amp;?&gt;</a> <a id="5720" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="5724" href="SMT.Script.Show.html#5505" class="Function">pModel</a>

      <a id="5738" href="SMT.Script.Show.html#5738" class="Function">mkQualifiedModel</a> <a id="5755" class="Symbol">:</a> <a id="5757" href="SMT.Script.Base.html#5888" class="Datatype">Sat</a> <a id="5761" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5763" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5769" class="Symbol">(</a><a id="5770" href="SMT.Script.Base.html#6579" class="Datatype">Model</a> <a id="5776" href="SMT.Script.Show.html#5218" class="Bound">Γ</a><a id="5777" class="Symbol">)</a> <a id="5779" class="Symbol">→</a> <a id="5781" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5787" class="Symbol">(</a><a id="5788" href="SMT.Script.Base.html#6670" class="Function">QualifiedModel</a> <a id="5803" href="SMT.Script.Show.html#5218" class="Bound">Γ</a><a id="5804" class="Symbol">)</a>
      <a id="5812" href="SMT.Script.Show.html#5738" class="Function">mkQualifiedModel</a> <a id="5829" class="Symbol">(</a><a id="5830" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>     <a id="5838" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5840" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5845" href="SMT.Script.Show.html#5845" class="Bound">m</a><a id="5846" class="Symbol">)</a>  <a id="5849" class="Symbol">=</a> <a id="5851" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5856" class="Symbol">(</a><a id="5857" href="SMT.Script.Base.html#5906" class="InductiveConstructor">sat</a>     <a id="5865" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5867" href="SMT.Script.Show.html#5845" class="Bound">m</a><a id="5868" class="Symbol">)</a>
      <a id="5876" href="SMT.Script.Show.html#5738" class="Function">mkQualifiedModel</a> <a id="5893" class="Symbol">(</a><a id="5894" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="5902" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5904" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="5911" class="Symbol">)</a> <a id="5913" class="Symbol">=</a> <a id="5915" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5920" class="Symbol">(</a><a id="5921" href="SMT.Script.Base.html#5922" class="InductiveConstructor">unsat</a>   <a id="5929" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5931" class="Symbol">_)</a>
      <a id="5940" href="SMT.Script.Show.html#5738" class="Function">mkQualifiedModel</a> <a id="5957" class="Symbol">(</a><a id="5958" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5966" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5968" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="5975" class="Symbol">)</a> <a id="5977" class="Symbol">=</a> <a id="5979" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5984" class="Symbol">(</a><a id="5985" href="SMT.Script.Base.html#5938" class="InductiveConstructor">unknown</a> <a id="5993" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5995" class="Symbol">_)</a>
      <a id="6004" href="SMT.Script.Show.html#5738" class="CatchallClause Function">mkQualifiedModel</a><a id="6020" class="CatchallClause"> </a><a id="6021" class="CatchallClause Symbol">(_</a><a id="6023" class="CatchallClause">       </a><a id="6030" href="Agda.Builtin.Sigma.html#236" class="CatchallClause InductiveConstructor Operator">,</a><a id="6031" class="CatchallClause"> </a><a id="6032" class="CatchallClause Symbol">_)</a>       <a id="6041" class="Symbol">=</a> <a id="6043" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>


  <a id="6055" href="SMT.Script.Show.html#6055" class="Function">mkOutputParsers⁺</a> <a id="6072" class="Symbol">:</a> <a id="6074" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="6088" class="Symbol">(</a><a id="6089" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="6091" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6093" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="6094" class="Symbol">)</a> <a id="6096" class="Symbol">→</a> <a id="6098" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="6101" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="6108" class="Symbol">(</a><a id="6109" href="SMT.Script.Base.html#7262" class="Datatype">Outputs</a> <a id="6117" class="Symbol">(</a><a id="6118" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="6120" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6122" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="6123" class="Symbol">))</a> <a id="6126" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="6130" href="SMT.Script.Show.html#6055" class="Function">mkOutputParsers⁺</a> <a id="6147" class="Symbol">(</a><a id="6148" href="SMT.Script.Show.html#6148" class="Bound">op</a> <a id="6151" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6153" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="6155" class="Symbol">)</a>          <a id="6166" class="Symbol">=</a> <a id="6168" class="Symbol">(</a><a id="6169" href="SMT.Script.Base.html#7322" class="InductiveConstructor Operator">_∷</a> <a id="6172" href="SMT.Script.Base.html#7303" class="InductiveConstructor">[]</a><a id="6174" class="Symbol">)</a> <a id="6176" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="6180" href="SMT.Script.Show.html#6148" class="Bound">op</a>
  <a id="6185" href="SMT.Script.Show.html#6055" class="Function">mkOutputParsers⁺</a> <a id="6202" class="Symbol">(</a><a id="6203" href="SMT.Script.Show.html#6203" class="Bound">op</a> <a id="6206" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6208" href="SMT.Script.Show.html#6208" class="Bound">ops</a><a id="6211" class="Symbol">@(_</a> <a id="6215" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="6217" class="Symbol">_))</a> <a id="6221" class="Symbol">=</a> <a id="6223" href="Function.Base.html#1554" class="Function">flip</a> <a id="6228" href="SMT.Script.Base.html#7322" class="InductiveConstructor Operator">_∷_</a> <a id="6232" href="Text.Parser.String.html#5538" class="Function Operator">&lt;$&gt;</a> <a id="6236" href="SMT.Script.Show.html#6055" class="Function">mkOutputParsers⁺</a> <a id="6253" href="SMT.Script.Show.html#6208" class="Bound">ops</a> <a id="6257" href="Text.Parser.String.html#5722" class="Function Operator">&lt;*&gt;</a> <a id="6261" href="Text.Parser.String.html#5300" class="Function">box</a> <a id="6265" href="SMT.Script.Show.html#6203" class="Bound">op</a>



<a id="6271" class="Comment">-- * Pretty printer</a>

<a id="6292" class="Keyword">module</a> <a id="6299" href="SMT.Script.Show.html#6299" class="Module">_</a> <a id="6301" class="Keyword">where</a>

  <a id="6310" class="Keyword">open</a> <a id="6315" class="Keyword">import</a> <a id="6322" href="Category.Monad.State.html" class="Module">Category.Monad.State</a> <a id="6343" class="Symbol">as</a> <a id="6346" class="Module">StateCat</a> <a id="6355" class="Keyword">using</a> <a id="6361" class="Symbol">(</a><a id="6362" href="Category.Monad.State.html#2659" class="Record">RawIMonadState</a><a id="6376" class="Symbol">;</a> <a id="6378" href="Category.Monad.State.html#666" class="Function">IStateT</a><a id="6385" class="Symbol">)</a>
  <a id="6389" class="Keyword">open</a> <a id="6394" class="Keyword">import</a> <a id="6401" href="Text.Parser.String.html" class="Module">Text.Parser.String</a> <a id="6420" class="Keyword">using</a> <a id="6426" class="Symbol">(</a><a id="6427" href="Relation.Unary.html#3359" class="Function">IUniversal</a><a id="6437" class="Symbol">;</a> <a id="6439" href="Text.Parser.String.html#3063" class="Function">Parser</a><a id="6445" class="Symbol">;</a> <a id="6447" href="Text.Parser.String.html#5634" class="Function Operator">_&lt;$_</a><a id="6451" class="Symbol">;</a> <a id="6453" href="Text.Parser.String.html#6575" class="Function">withSpaces</a><a id="6463" class="Symbol">;</a> <a id="6465" href="Text.Parser.String.html#6875" class="Function">exacts</a><a id="6471" class="Symbol">)</a>

  <a id="6476" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="6486" class="Symbol">:</a> <a id="6488" class="Symbol">(</a><a id="6489" href="SMT.Script.Show.html#6489" class="Bound">Γ</a> <a id="6491" href="SMT.Script.Show.html#6491" class="Bound">Γ′</a> <a id="6494" class="Symbol">:</a> <a id="6496" href="SMT.Script.Base.html#2508" class="Function">Ctxt</a><a id="6500" class="Symbol">)</a> <a id="6502" class="Symbol">→</a> <a id="6504" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="6508" class="Symbol">→</a> <a id="6510" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="6516" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="6526" href="SMT.Script.Show.html#6526" class="Bound">Γ</a> <a id="6528" href="SMT.Script.Show.html#6528" class="Bound">Γ′</a> <a id="6531" href="SMT.Script.Show.html#6531" class="Bound">A</a> <a id="6533" class="Symbol">=</a> <a id="6535" href="Category.Monad.State.html#666" class="Function">IStateT</a> <a id="6543" class="Symbol">(λ</a> <a id="6546" href="SMT.Script.Show.html#6546" class="Bound">Γ</a> <a id="6548" class="Symbol">→</a> <a id="6550" href="SMT.Script.Names.html#2385" class="Record">Names</a> <a id="6556" href="SMT.Script.Show.html#6546" class="Bound">Γ</a> <a id="6558" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6560" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="6571" href="SMT.Script.Show.html#6546" class="Bound">Γ</a><a id="6572" class="Symbol">)</a> <a id="6574" href="Function.Base.html#615" class="Function">id</a> <a id="6577" href="SMT.Script.Show.html#6526" class="Bound">Γ</a> <a id="6579" href="SMT.Script.Show.html#6528" class="Bound">Γ′</a> <a id="6582" href="SMT.Script.Show.html#6531" class="Bound">A</a>

  <a id="6587" class="Comment">-- When showing terms, we need to pass around a name state,</a>
  <a id="6649" class="Comment">-- for which we&#39;ll use an indexed monad, indexed by the context,</a>
  <a id="6716" class="Comment">-- so we bring the functions from the indexed monad in scope.</a>
  <a id="6780" class="Keyword">private</a>
    <a id="6792" href="SMT.Script.Show.html#6792" class="Function">monadStateNameState</a> <a id="6812" class="Symbol">=</a>
      <a id="6820" href="Category.Monad.State.html#2986" class="Function">StateCat.StateTIMonadState</a> <a id="6847" class="Symbol">(λ</a> <a id="6850" href="SMT.Script.Show.html#6850" class="Bound">Γ</a> <a id="6852" class="Symbol">→</a> <a id="6854" href="SMT.Script.Names.html#2385" class="Record">Names</a> <a id="6860" href="SMT.Script.Show.html#6850" class="Bound">Γ</a> <a id="6862" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6864" href="SMT.Script.Show.html#2076" class="Function">VarParsers</a> <a id="6875" href="SMT.Script.Show.html#6850" class="Bound">Γ</a><a id="6876" class="Symbol">)</a> <a id="6878" href="Function.Identity.Categorical.html#651" class="Function">Identity.monad</a>

  <a id="6896" class="Keyword">open</a> <a id="6901" href="Category.Monad.State.html#2659" class="Module">RawIMonadState</a> <a id="6916" href="SMT.Script.Show.html#6792" class="Function">monadStateNameState</a>
    <a id="6940" class="Keyword">using</a> <a id="6946" class="Symbol">(</a><a id="6947" href="Category.Monad.Indexed.html#644" class="Function">return</a><a id="6953" class="Symbol">;</a> <a id="6955" href="Category.Monad.Indexed.html#677" class="Function Operator">_&gt;&gt;=_</a><a id="6960" class="Symbol">;</a> <a id="6962" href="Category.Monad.Indexed.html#735" class="Function Operator">_&gt;&gt;_</a><a id="6966" class="Symbol">;</a> <a id="6968" href="Category.Monad.State.html#2831" class="Field">put</a><a id="6971" class="Symbol">;</a> <a id="6973" href="Category.Monad.State.html#2799" class="Field">get</a><a id="6976" class="Symbol">;</a> <a id="6978" href="Category.Monad.State.html#2906" class="Function">modify</a><a id="6984" class="Symbol">)</a>

  <a id="6989" href="SMT.Script.Show.html#6989" class="Function">freshNameS</a> <a id="7000" class="Symbol">:</a> <a id="7002" class="Symbol">(</a><a id="7003" href="SMT.Script.Show.html#7003" class="Bound">n</a> <a id="7005" class="Symbol">:</a> <a id="7007" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="7013" class="Symbol">)</a> <a id="7015" class="Symbol">(</a><a id="7016" href="SMT.Script.Show.html#7016" class="Bound">σ</a> <a id="7018" class="Symbol">:</a> <a id="7020" href="SMT.Theory.Base.html#2591" class="Function">Sort</a><a id="7024" class="Symbol">)</a> <a id="7026" class="Symbol">→</a> <a id="7028" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="7038" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7040" class="Symbol">(</a><a id="7041" href="SMT.Script.Show.html#7016" class="Bound">σ</a> <a id="7043" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7045" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="7046" class="Symbol">)</a> <a id="7048" href="SMT.Script.Names.html#1799" class="Function">Name</a>
  <a id="7055" href="SMT.Script.Show.html#6989" class="Function">freshNameS</a> <a id="7066" href="SMT.Script.Show.html#7066" class="Bound">n</a> <a id="7068" href="SMT.Script.Show.html#7068" class="Bound">σ</a> <a id="7070" class="Symbol">=</a> <a id="7072" class="Keyword">do</a>
    <a id="7079" class="Symbol">(</a><a id="7080" href="SMT.Script.Show.html#7080" class="Bound">ns</a> <a id="7083" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7085" href="SMT.Script.Show.html#7085" class="Bound">vps</a><a id="7088" class="Symbol">)</a> <a id="7090" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7092" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7100" class="Keyword">let</a> <a id="7104" class="Symbol">(</a><a id="7105" href="SMT.Script.Show.html#7105" class="Bound">n′</a> <a id="7108" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7110" href="SMT.Script.Show.html#7110" class="Bound">ns</a><a id="7112" class="Symbol">)</a> <a id="7114" class="Symbol">=</a> <a id="7116" href="SMT.Script.Names.html#2595" class="Function">freshName</a> <a id="7126" href="SMT.Script.Show.html#7066" class="Bound">n</a> <a id="7128" href="SMT.Script.Show.html#7068" class="Bound">σ</a> <a id="7130" href="SMT.Script.Show.html#7080" class="Bound">ns</a>
    <a id="7137" class="Keyword">let</a> <a id="7141" href="SMT.Script.Show.html#7141" class="Bound">vps</a> <a id="7145" class="Symbol">=</a> <a id="7147" class="Symbol">(</a><a id="7148" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="7153" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7158" href="Text.Parser.String.html#5634" class="Function Operator">&lt;$</a> <a id="7161" href="Text.Parser.String.html#6575" class="Function">withSpaces</a> <a id="7172" class="Symbol">(</a><a id="7173" href="Text.Parser.String.html#6875" class="Function">exacts</a> <a id="7180" href="SMT.Script.Show.html#7105" class="Bound">n′</a><a id="7182" class="Symbol">))</a> <a id="7185" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7187" href="SMT.Script.Show.html#7085" class="Bound">vps</a>
    <a id="7195" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7199" class="Symbol">(</a><a id="7200" href="SMT.Script.Show.html#7110" class="Bound">ns</a> <a id="7203" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7205" href="SMT.Script.Show.html#7141" class="Bound">vps</a><a id="7208" class="Symbol">)</a>
    <a id="7214" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7221" href="SMT.Script.Show.html#7105" class="Bound">n′</a>

  <a id="7227" href="SMT.Script.Show.html#7227" class="Function">dropNameS</a> <a id="7237" class="Symbol">:</a> <a id="7239" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="7249" class="Symbol">(</a><a id="7250" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="7252" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7254" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="7255" class="Symbol">)</a> <a id="7257" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7259" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="7263" href="SMT.Script.Show.html#7227" class="Function">dropNameS</a> <a id="7273" class="Symbol">=</a> <a id="7275" class="Keyword">do</a>
    <a id="7282" class="Symbol">(</a><a id="7283" href="SMT.Script.Show.html#7283" class="Bound">ns</a> <a id="7286" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7288" class="Symbol">_</a> <a id="7290" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="7292" href="SMT.Script.Show.html#7292" class="Bound">vps</a><a id="7295" class="Symbol">)</a> <a id="7297" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7299" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7307" href="Category.Monad.State.html#2831" class="Function">put</a> <a id="7311" class="Symbol">(</a><a id="7312" href="SMT.Script.Names.html#2921" class="Function">dropName</a> <a id="7321" href="SMT.Script.Show.html#7283" class="Bound">ns</a> <a id="7324" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7326" href="SMT.Script.Show.html#7292" class="Bound">vps</a><a id="7329" class="Symbol">)</a>
    <a id="7335" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7342" class="Symbol">_</a>

  <a id="7347" href="SMT.Script.Show.html#7347" class="Function">lookupNameS</a> <a id="7359" class="Symbol">:</a> <a id="7361" class="Symbol">(</a><a id="7362" href="SMT.Script.Show.html#7362" class="Bound">i</a> <a id="7364" class="Symbol">:</a> <a id="7366" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7368" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="7370" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a><a id="7371" class="Symbol">)</a> <a id="7373" class="Symbol">→</a> <a id="7375" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="7385" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7387" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7389" href="SMT.Script.Names.html#1799" class="Function">Name</a>
  <a id="7396" href="SMT.Script.Show.html#7347" class="Function">lookupNameS</a> <a id="7408" href="SMT.Script.Show.html#7408" class="Bound">p</a> <a id="7410" class="Symbol">=</a> <a id="7412" class="Keyword">do</a>
    <a id="7419" class="Symbol">(</a><a id="7420" href="SMT.Script.Show.html#7420" class="Bound">ns</a> <a id="7423" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7425" href="SMT.Script.Show.html#7425" class="Bound Operator">_vps</a><a id="7429" class="Symbol">)</a> <a id="7431" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7433" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="7441" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7448" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7450" href="Data.Environment.html#849" class="Function">Env.lookup</a> <a id="7461" class="Symbol">(</a><a id="7462" href="SMT.Script.Names.html#2426" class="Field">Names.nameEnv</a> <a id="7476" href="SMT.Script.Show.html#7420" class="Bound">ns</a><a id="7478" class="Symbol">)</a> <a id="7480" class="Symbol">(</a><a id="7481" href="Data.List.Relation.Unary.Any.html#1817" class="Function">Any.index</a> <a id="7491" href="SMT.Script.Show.html#7408" class="Bound">p</a><a id="7492" class="Symbol">)</a>


  <a id="7498" class="Comment">-- * Printing functions</a>

  <a id="7525" class="Keyword">mutual</a>

    <a id="7537" class="Comment">-- |Show a term as an S-expression.</a>
    <a id="7577" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="7587" class="Symbol">:</a> <a id="7589" href="SMT.Script.Base.html#3261" class="Datatype">Term</a> <a id="7594" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7596" href="SMT.Script.Show.html#1788" class="Generalizable">σ</a> <a id="7598" class="Symbol">→</a> <a id="7600" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="7610" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7612" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="7614" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
    <a id="7625" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="7635" class="Symbol">(</a><a id="7636" href="SMT.Script.Base.html#3306" class="InductiveConstructor">`var</a> <a id="7641" href="SMT.Script.Show.html#7641" class="Bound">i</a><a id="7642" class="Symbol">)</a> <a id="7644" class="Symbol">=</a> <a id="7646" class="Keyword">do</a>
      <a id="7655" href="SMT.Script.Show.html#7655" class="Bound">n</a> <a id="7657" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7659" href="SMT.Script.Show.html#7347" class="Function">lookupNameS</a> <a id="7671" href="SMT.Script.Show.html#7641" class="Bound">i</a>
      <a id="7679" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7686" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7688" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="7697" href="SMT.Script.Show.html#7655" class="Bound">n</a>
    <a id="7703" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="7713" class="Symbol">(</a><a id="7714" href="SMT.Script.Base.html#3356" class="InductiveConstructor">`lit</a> <a id="7719" href="SMT.Script.Show.html#7719" class="Bound">l</a><a id="7720" class="Symbol">)</a> <a id="7722" class="Symbol">=</a> <a id="7724" class="Keyword">do</a>
      <a id="7733" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7740" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7742" href="SMT.Theory.Base.html#3580" class="Function">showLiteral</a> <a id="7754" href="SMT.Script.Show.html#7719" class="Bound">l</a>
    <a id="7760" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="7770" class="Symbol">(</a><a id="7771" href="SMT.Script.Base.html#3410" class="InductiveConstructor">`app</a> <a id="7776" href="SMT.Script.Show.html#7776" class="Bound">x</a> <a id="7778" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a><a id="7780" class="Symbol">)</a> <a id="7782" class="Symbol">=</a> <a id="7784" class="Keyword">do</a>
      <a id="7793" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7800" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7802" href="SMT.Theory.Base.html#3633" class="Function">showIdentifier</a> <a id="7817" href="SMT.Script.Show.html#7776" class="Bound">x</a>
    <a id="7823" href="SMT.Script.Show.html#7577" class="CatchallClause Function">showTermS</a><a id="7832" class="CatchallClause"> </a><a id="7833" class="CatchallClause Symbol">(</a><a id="7834" href="SMT.Script.Base.html#3410" class="CatchallClause InductiveConstructor">`app</a><a id="7838" class="CatchallClause"> </a><a id="7839" href="SMT.Script.Show.html#7839" class="CatchallClause Bound">x</a><a id="7840" class="CatchallClause"> </a><a id="7841" href="SMT.Script.Show.html#7841" class="CatchallClause Bound">xs</a><a id="7843" class="CatchallClause Symbol">)</a> <a id="7845" class="Symbol">=</a> <a id="7847" class="Keyword">do</a>
      <a id="7856" class="Keyword">let</a> <a id="7860" href="SMT.Script.Show.html#7860" class="Bound">x</a> <a id="7862" class="Symbol">=</a> <a id="7864" href="SMT.Theory.Base.html#3633" class="Function">showIdentifier</a> <a id="7879" href="SMT.Script.Show.html#7839" class="Bound">x</a>
      <a id="7887" href="SMT.Script.Show.html#7887" class="Bound">xs</a> <a id="7890" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7892" href="SMT.Script.Show.html#8546" class="Function">showArgsS</a> <a id="7902" href="SMT.Script.Show.html#7841" class="Bound">xs</a>
      <a id="7911" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="7918" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="7920" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="7928" class="Symbol">(</a><a id="7929" href="SMT.Script.Show.html#7860" class="Bound">x</a> <a id="7931" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7933" href="SMT.Script.Show.html#7887" class="Bound">xs</a><a id="7935" class="Symbol">)</a>
    <a id="7941" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="7951" class="Symbol">(</a><a id="7952" href="SMT.Script.Base.html#3512" class="InductiveConstructor">`forall</a> <a id="7960" href="SMT.Script.Show.html#7960" class="Bound">n</a> <a id="7962" href="SMT.Script.Show.html#7962" class="Bound">σ</a> <a id="7964" href="SMT.Script.Show.html#7964" class="Bound">x</a><a id="7965" class="Symbol">)</a> <a id="7967" class="Symbol">=</a> <a id="7969" class="Keyword">do</a>
      <a id="7978" href="SMT.Script.Show.html#7978" class="Bound">n′</a> <a id="7981" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="7983" href="SMT.Script.Show.html#6989" class="Function">freshNameS</a> <a id="7994" href="SMT.Script.Show.html#7960" class="Bound">n</a> <a id="7996" href="SMT.Script.Show.html#7962" class="Bound">σ</a>
      <a id="8004" href="SMT.Script.Show.html#8004" class="Bound">x</a> <a id="8006" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8008" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="8018" href="SMT.Script.Show.html#7964" class="Bound">x</a>
      <a id="8026" href="SMT.Script.Show.html#7227" class="Function">dropNameS</a>
      <a id="8042" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8049" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8051" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8059" class="Symbol">(</a><a id="8060" class="String">&quot;forall&quot;</a> <a id="8069" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8071" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8079" class="Symbol">(</a><a id="8080" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8088" class="Symbol">(</a><a id="8089" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8098" href="SMT.Script.Show.html#7978" class="Bound">n′</a> <a id="8101" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8103" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="8112" href="SMT.Script.Show.html#7962" class="Bound">σ</a> <a id="8114" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8116" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8118" class="Symbol">)</a> <a id="8120" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8122" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8124" class="Symbol">)</a> <a id="8126" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8128" href="SMT.Script.Show.html#8004" class="Bound">x</a> <a id="8130" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8132" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8134" class="Symbol">)</a>
    <a id="8140" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="8150" class="Symbol">(</a><a id="8151" href="SMT.Script.Base.html#3597" class="InductiveConstructor">`exists</a> <a id="8159" href="SMT.Script.Show.html#8159" class="Bound">n</a> <a id="8161" href="SMT.Script.Show.html#8161" class="Bound">σ</a> <a id="8163" href="SMT.Script.Show.html#8163" class="Bound">x</a><a id="8164" class="Symbol">)</a> <a id="8166" class="Symbol">=</a> <a id="8168" class="Keyword">do</a>
      <a id="8177" href="SMT.Script.Show.html#8177" class="Bound">n′</a> <a id="8180" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8182" href="SMT.Script.Show.html#6989" class="Function">freshNameS</a> <a id="8193" href="SMT.Script.Show.html#8159" class="Bound">n</a> <a id="8195" href="SMT.Script.Show.html#8161" class="Bound">σ</a>
      <a id="8203" href="SMT.Script.Show.html#8203" class="Bound">x</a> <a id="8205" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8207" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="8217" href="SMT.Script.Show.html#8163" class="Bound">x</a>
      <a id="8225" href="SMT.Script.Show.html#7227" class="Function">dropNameS</a>
      <a id="8241" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8248" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8250" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8258" class="Symbol">(</a><a id="8259" class="String">&quot;exists&quot;</a> <a id="8268" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8270" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8278" class="Symbol">(</a><a id="8279" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8287" class="Symbol">(</a><a id="8288" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8297" href="SMT.Script.Show.html#8177" class="Bound">n′</a> <a id="8300" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8302" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="8311" href="SMT.Script.Show.html#8161" class="Bound">σ</a> <a id="8313" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8315" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8317" class="Symbol">)</a> <a id="8319" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8321" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8323" class="Symbol">)</a> <a id="8325" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8327" href="SMT.Script.Show.html#8203" class="Bound">x</a> <a id="8329" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8331" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8333" class="Symbol">)</a>
    <a id="8339" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="8349" class="Symbol">(</a><a id="8350" href="SMT.Script.Base.html#3682" class="InductiveConstructor">`let</a> <a id="8355" href="SMT.Script.Show.html#8355" class="Bound">n</a> <a id="8357" href="SMT.Script.Show.html#8357" class="Bound">σ</a> <a id="8359" href="SMT.Script.Show.html#8359" class="Bound">x</a> <a id="8361" href="SMT.Script.Show.html#8361" class="Bound">y</a><a id="8362" class="Symbol">)</a> <a id="8364" class="Symbol">=</a> <a id="8366" class="Keyword">do</a>
      <a id="8375" href="SMT.Script.Show.html#8375" class="Bound">x</a> <a id="8377" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8379" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="8389" href="SMT.Script.Show.html#8359" class="Bound">x</a>
      <a id="8397" href="SMT.Script.Show.html#8397" class="Bound">n</a> <a id="8399" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8401" href="SMT.Script.Show.html#6989" class="Function">freshNameS</a> <a id="8412" href="SMT.Script.Show.html#8355" class="Bound">n</a> <a id="8414" href="SMT.Script.Show.html#8357" class="Bound">σ</a>
      <a id="8422" href="SMT.Script.Show.html#8422" class="Bound">y</a> <a id="8424" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8426" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="8436" href="SMT.Script.Show.html#8361" class="Bound">y</a>
      <a id="8444" href="SMT.Script.Show.html#7227" class="Function">dropNameS</a>
      <a id="8460" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8467" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8469" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8477" class="Symbol">((</a><a id="8479" class="String">&quot;let&quot;</a> <a id="8485" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8487" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8495" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="8497" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8505" class="Symbol">(</a><a id="8506" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="8515" href="SMT.Script.Show.html#8397" class="Bound">n</a> <a id="8517" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8519" href="SMT.Script.Show.html#8375" class="Bound">x</a> <a id="8521" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8523" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8525" class="Symbol">)</a> <a id="8527" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="8529" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8531" href="SMT.Script.Show.html#8422" class="Bound">y</a> <a id="8533" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8535" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8537" class="Symbol">)</a> <a id="8539" class="Symbol">)</a>

    <a id="8546" href="SMT.Script.Show.html#8546" class="Function">showArgsS</a> <a id="8556" class="Symbol">:</a> <a id="8558" href="SMT.Script.Base.html#3769" class="Function">Args</a> <a id="8563" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8565" href="SMT.Script.Show.html#1826" class="Generalizable">Δ</a> <a id="8567" class="Symbol">→</a> <a id="8569" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="8579" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8581" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8583" class="Symbol">(</a><a id="8584" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8589" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="8595" class="Symbol">)</a>
    <a id="8601" href="SMT.Script.Show.html#8546" class="Function">showArgsS</a> <a id="8611" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>       <a id="8620" class="Symbol">=</a> <a id="8622" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8629" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
    <a id="8636" href="SMT.Script.Show.html#8546" class="Function">showArgsS</a> <a id="8646" class="Symbol">(</a><a id="8647" href="SMT.Script.Show.html#8647" class="Bound">x</a> <a id="8649" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="8651" href="SMT.Script.Show.html#8651" class="Bound">xs</a><a id="8653" class="Symbol">)</a> <a id="8655" class="Symbol">=</a> <a id="8657" class="Keyword">do</a> <a id="8660" href="SMT.Script.Show.html#8660" class="Bound">x</a> <a id="8662" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8664" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="8674" href="SMT.Script.Show.html#8647" class="Bound">x</a><a id="8675" class="Symbol">;</a> <a id="8677" href="SMT.Script.Show.html#8677" class="Bound">xs</a> <a id="8680" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="8682" href="SMT.Script.Show.html#8546" class="Function">showArgsS</a> <a id="8692" href="SMT.Script.Show.html#8651" class="Bound">xs</a><a id="8694" class="Symbol">;</a> <a id="8696" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8703" class="Symbol">(</a><a id="8704" href="SMT.Script.Show.html#8660" class="Bound">x</a> <a id="8706" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8708" href="SMT.Script.Show.html#8677" class="Bound">xs</a><a id="8710" class="Symbol">)</a>

  <a id="8715" class="Comment">-- |Show a command as an S-expression, and build up an environment of output parsers.</a>
  <a id="8803" href="SMT.Script.Show.html#8803" class="Function">showCommandS</a> <a id="8816" class="Symbol">:</a> <a id="8818" href="SMT.Script.Base.html#9694" class="Datatype">Command</a> <a id="8826" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8828" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="8831" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a> <a id="8834" class="Symbol">→</a> <a id="8836" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="8846" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="8848" class="Symbol">(</a><a id="8849" href="SMT.Script.Show.html#1812" class="Generalizable">δΓ</a> <a id="8852" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="8855" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a><a id="8856" class="Symbol">)</a> <a id="8858" class="Symbol">(</a><a id="8859" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="8866" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8868" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="8882" href="SMT.Script.Show.html#1928" class="Generalizable">δΞ</a><a id="8884" class="Symbol">)</a>
  <a id="8888" href="SMT.Script.Show.html#8803" class="Function">showCommandS</a> <a id="8901" class="Symbol">(</a><a id="8902" href="SMT.Script.Base.html#9759" class="InductiveConstructor">`set-logic</a> <a id="8913" href="SMT.Script.Show.html#8913" class="Bound">l</a><a id="8914" class="Symbol">)</a> <a id="8916" class="Symbol">=</a> <a id="8918" class="Keyword">do</a>
    <a id="8925" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="8932" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="8934" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="8942" class="Symbol">(</a><a id="8943" class="String">&quot;set-logic&quot;</a> <a id="8955" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8957" href="SMT.Script.Show.html#8913" class="Bound">l</a> <a id="8959" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8961" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="8963" class="Symbol">)</a> <a id="8965" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8967" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="8972" href="SMT.Script.Show.html#8803" class="Function">showCommandS</a> <a id="8985" class="Symbol">(</a><a id="8986" href="SMT.Script.Base.html#9808" class="InductiveConstructor">`declare-const</a> <a id="9001" href="SMT.Script.Show.html#9001" class="Bound">n</a> <a id="9003" href="SMT.Script.Show.html#9003" class="Bound">σ</a><a id="9004" class="Symbol">)</a> <a id="9006" class="Symbol">=</a> <a id="9008" class="Keyword">do</a>
    <a id="9015" href="SMT.Script.Show.html#9015" class="Bound">n′</a> <a id="9018" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9020" href="SMT.Script.Show.html#6989" class="Function">freshNameS</a> <a id="9031" href="SMT.Script.Show.html#9001" class="Bound">n</a> <a id="9033" href="SMT.Script.Show.html#9003" class="Bound">σ</a>
    <a id="9039" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9046" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9048" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9056" class="Symbol">(</a><a id="9057" class="String">&quot;declare-const&quot;</a> <a id="9073" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9075" href="SMT.Script.Names.html#1845" class="Function">showName</a> <a id="9084" href="SMT.Script.Show.html#9015" class="Bound">n′</a> <a id="9087" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9089" href="SMT.Theory.Base.html#3545" class="Function">showSort</a> <a id="9098" href="SMT.Script.Show.html#9003" class="Bound">σ</a> <a id="9100" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9102" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9104" class="Symbol">)</a> <a id="9106" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9108" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9113" href="SMT.Script.Show.html#8803" class="Function">showCommandS</a> <a id="9126" class="Symbol">(</a><a id="9127" href="SMT.Script.Base.html#9875" class="InductiveConstructor">`assert</a> <a id="9135" href="SMT.Script.Show.html#9135" class="Bound">x</a><a id="9136" class="Symbol">)</a> <a id="9138" class="Symbol">=</a> <a id="9140" class="Keyword">do</a>
    <a id="9147" href="SMT.Script.Show.html#9147" class="Bound">x</a> <a id="9149" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9151" href="SMT.Script.Show.html#7577" class="Function">showTermS</a> <a id="9161" href="SMT.Script.Show.html#9135" class="Bound">x</a>
    <a id="9167" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9174" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9176" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9184" class="Symbol">(</a><a id="9185" class="String">&quot;assert&quot;</a> <a id="9194" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9196" href="SMT.Script.Show.html#9147" class="Bound">x</a> <a id="9198" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9200" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9202" class="Symbol">)</a> <a id="9204" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9206" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9211" href="SMT.Script.Show.html#8803" class="Function">showCommandS</a> <a id="9224" href="SMT.Script.Base.html#9924" class="InductiveConstructor">`check-sat</a> <a id="9235" class="Symbol">=</a> <a id="9237" class="Keyword">do</a>
    <a id="9244" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9251" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9253" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9261" class="Symbol">(</a><a id="9262" class="String">&quot;check-sat&quot;</a> <a id="9274" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9276" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9278" class="Symbol">)</a> <a id="9280" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9282" href="SMT.Script.Show.html#2811" class="Function">pSat</a> <a id="9287" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="9289" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9294" href="SMT.Script.Show.html#8803" class="Function">showCommandS</a> <a id="9307" href="SMT.Script.Base.html#9967" class="InductiveConstructor">`get-model</a> <a id="9318" class="Symbol">=</a> <a id="9320" class="Keyword">do</a>
    <a id="9327" class="Symbol">(</a><a id="9328" href="SMT.Script.Show.html#9328" class="Bound Operator">_ns</a> <a id="9332" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9334" href="SMT.Script.Show.html#9334" class="Bound">vps</a><a id="9337" class="Symbol">)</a> <a id="9339" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9341" href="Category.Monad.State.html#2799" class="Function">get</a>
    <a id="9349" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9356" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9358" href="Data.String.Base.html#2767" class="Function">String.unlines</a> <a id="9373" class="Symbol">(</a> <a id="9375" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9383" class="Symbol">(</a><a id="9384" class="String">&quot;check-sat&quot;</a> <a id="9396" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9398" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9400" class="Symbol">)</a>
                            <a id="9430" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9432" href="SMT.Theory.Base.html#4329" class="Function">mkSTerm</a> <a id="9440" class="Symbol">(</a><a id="9441" class="String">&quot;get-model&quot;</a> <a id="9453" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9455" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="9457" class="Symbol">)</a> <a id="9459" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9461" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9464" class="Symbol">)</a>
           <a id="9477" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9479" href="SMT.Script.Show.html#5132" class="Function">mkModelParser</a> <a id="9493" class="Symbol">(</a><a id="9494" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="9506" href="SMT.Script.Show.html#9334" class="Bound">vps</a><a id="9509" class="Symbol">)</a> <a id="9511" href="Data.Environment.html#427" class="InductiveConstructor Operator">∷</a> <a id="9513" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>

  <a id="9519" class="Comment">-- |Show a script as an S-expression, and build up an environment of output parsers.</a>
  <a id="9606" href="SMT.Script.Show.html#9606" class="Function">showScriptS</a> <a id="9618" class="Symbol">:</a> <a id="9620" href="SMT.Script.Base.html#10107" class="Datatype">Script</a> <a id="9627" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9629" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="9632" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="9634" class="Symbol">→</a> <a id="9636" href="SMT.Script.Show.html#6476" class="Function">NameState</a> <a id="9646" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9648" href="SMT.Script.Show.html#1809" class="Generalizable">Γ′</a> <a id="9651" class="Symbol">(</a><a id="9652" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9657" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="9664" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9666" href="SMT.Script.Show.html#2686" class="Function">OutputParsers</a> <a id="9680" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="9681" class="Symbol">)</a>
  <a id="9685" href="SMT.Script.Show.html#9606" class="Function">showScriptS</a> <a id="9697" href="SMT.Script.Base.html#10170" class="InductiveConstructor">[]</a> <a id="9700" class="Symbol">=</a> <a id="9702" class="Keyword">do</a>
    <a id="9709" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9716" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9718" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9721" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9723" href="Data.Environment.html#410" class="InductiveConstructor">[]</a>
  <a id="9728" href="SMT.Script.Show.html#9606" class="Function">showScriptS</a> <a id="9740" class="Symbol">(</a><a id="9741" href="SMT.Script.Show.html#9741" class="Bound">cmd</a> <a id="9745" href="SMT.Script.Base.html#10192" class="InductiveConstructor Operator">∷</a> <a id="9747" href="SMT.Script.Show.html#9747" class="Bound">scr</a><a id="9750" class="Symbol">)</a> <a id="9752" class="Symbol">=</a> <a id="9754" class="Keyword">do</a>
    <a id="9761" class="Symbol">(</a><a id="9762" href="SMT.Script.Show.html#9762" class="Bound">cmd</a> <a id="9766" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9768" href="SMT.Script.Show.html#9768" class="Bound">ops₁</a><a id="9772" class="Symbol">)</a> <a id="9774" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9776" href="SMT.Script.Show.html#8803" class="Function">showCommandS</a> <a id="9789" href="SMT.Script.Show.html#9741" class="Bound">cmd</a>
    <a id="9797" class="Symbol">(</a><a id="9798" href="SMT.Script.Show.html#9798" class="Bound">scr</a> <a id="9802" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9804" href="SMT.Script.Show.html#9804" class="Bound">ops₂</a><a id="9808" class="Symbol">)</a> <a id="9810" href="Category.Monad.Indexed.html#677" class="Function Operator">←</a> <a id="9812" href="SMT.Script.Show.html#9606" class="Function">showScriptS</a> <a id="9824" href="SMT.Script.Show.html#9747" class="Bound">scr</a>
    <a id="9832" href="Category.Monad.Indexed.html#644" class="Function">return</a> <a id="9839" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9841" href="SMT.Script.Show.html#9762" class="Bound">cmd</a> <a id="9845" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9847" href="SMT.Script.Show.html#9798" class="Bound">scr</a> <a id="9851" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9853" href="Data.Environment.html#1225" class="Function">Env.append</a> <a id="9864" href="Function.Base.html#615" class="Function">id</a> <a id="9867" href="SMT.Script.Show.html#9768" class="Bound">ops₁</a> <a id="9872" href="SMT.Script.Show.html#9804" class="Bound">ops₂</a>

  <a id="9880" class="Comment">-- |Show a script as an S-expression, and return an environment of output parsers.</a>
  <a id="9965" href="SMT.Script.Show.html#9965" class="Function">showScript</a> <a id="9976" class="Symbol">:</a> <a id="9978" href="SMT.Script.Base.html#10107" class="Datatype">Script</a> <a id="9985" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9988" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="9990" class="Symbol">(</a><a id="9991" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="9993" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9995" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="9996" class="Symbol">)</a> <a id="9998" class="Symbol">→</a> <a id="10000" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="10007" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="10009" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="10012" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="10019" class="Symbol">(</a><a id="10020" href="SMT.Script.Base.html#7262" class="Datatype">Outputs</a> <a id="10028" class="Symbol">(</a><a id="10029" href="SMT.Script.Show.html#1898" class="Generalizable">ξ</a> <a id="10031" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="10033" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a><a id="10034" class="Symbol">))</a> <a id="10037" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="10041" href="SMT.Script.Show.html#9965" class="Function">showScript</a> <a id="10052" href="SMT.Script.Show.html#10052" class="Bound">scr</a> <a id="10056" class="Symbol">=</a> <a id="10058" href="Data.Product.html#2486" class="Function">Prod.map</a> <a id="10067" href="Data.String.Base.html#2767" class="Function">String.unlines</a> <a id="10082" href="SMT.Script.Show.html#6055" class="Function">mkOutputParsers⁺</a> <a id="10099" class="Symbol">(</a><a id="10100" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="10106" class="Symbol">(</a><a id="10107" href="SMT.Script.Show.html#9606" class="Function">showScriptS</a> <a id="10119" href="SMT.Script.Show.html#10052" class="Bound">scr</a> <a id="10123" class="Symbol">(</a><a id="10124" href="SMT.Script.Names.html#3140" class="Function">x′es</a> <a id="10129" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10131" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="10133" class="Symbol">)))</a>

  <a id="10140" class="Comment">-- |Get the variable parser for a script (for debugging purposes).</a>
  <a id="10209" href="SMT.Script.Show.html#10209" class="Function">getVarParser</a> <a id="10222" class="Symbol">:</a> <a id="10224" href="SMT.Script.Base.html#10107" class="Datatype">Script</a> <a id="10231" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10234" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="10236" href="SMT.Script.Show.html#1923" class="Generalizable">Ξ</a> <a id="10238" class="Symbol">→</a> <a id="10240" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="10243" href="Text.Parser.String.html#3063" class="Function">Parser</a> <a id="10250" class="Symbol">(</a><a id="10251" href="Data.Product.html#1806" class="Function">∃[</a> <a id="10254" href="SMT.Script.Show.html#10254" class="Bound">σ</a> <a id="10256" href="Data.Product.html#1806" class="Function">]</a> <a id="10258" class="Symbol">(</a><a id="10259" href="SMT.Script.Show.html#1807" class="Generalizable">Γ</a> <a id="10261" href="SMT.Script.Base.html#2731" class="Function Operator">∋</a> <a id="10263" href="SMT.Script.Show.html#10254" class="Bound">σ</a><a id="10264" class="Symbol">))</a> <a id="10267" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="10271" href="SMT.Script.Show.html#10209" class="Function">getVarParser</a> <a id="10284" href="SMT.Script.Show.html#10284" class="Bound">scr</a> <a id="10288" class="Symbol">=</a> <a id="10290" href="SMT.Script.Show.html#2240" class="Function">mkVarParser</a> <a id="10302" class="Symbol">(</a><a id="10303" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10309" class="Symbol">(</a><a id="10310" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10316" class="Symbol">(</a><a id="10317" href="SMT.Script.Show.html#9606" class="Function">showScriptS</a> <a id="10329" href="SMT.Script.Show.html#10284" class="Bound">scr</a> <a id="10333" class="Symbol">(</a><a id="10334" href="SMT.Script.Names.html#3140" class="Function">x′es</a> <a id="10339" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10341" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="10343" class="Symbol">))))</a>
</pre></body></html>