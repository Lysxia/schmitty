<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Theories.Core.Example</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-exec</a> <a id="26" class="Symbol">#-}</a>

<a id="31" class="Keyword">module</a> <a id="38" href="SMT.Theories.Core.Example.html" class="Module">SMT.Theories.Core.Example</a> <a id="64" class="Keyword">where</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="100" class="Symbol">as</a> <a id="103" class="Module">Env</a> <a id="107" class="Keyword">using</a> <a id="113" class="Symbol">(</a><a id="114" href="Data.Environment.html#360" class="Datatype">Env</a><a id="117" class="Symbol">;</a> <a id="119" href="Data.Environment.html#427" class="InductiveConstructor Operator">_∷_</a><a id="122" class="Symbol">;</a> <a id="124" href="Data.Environment.html#410" class="InductiveConstructor">[]</a><a id="126" class="Symbol">)</a>
<a id="128" class="Keyword">open</a> <a id="133" class="Keyword">import</a> <a id="140" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="149" class="Keyword">using</a> <a id="155" class="Symbol">(</a><a id="156" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a><a id="159" class="Symbol">;</a> <a id="161" href="Data.Fin.Base.html#1119" class="InductiveConstructor">suc</a><a id="164" class="Symbol">;</a> <a id="166" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a><a id="170" class="Symbol">)</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Data.List.html" class="Module">Data.List</a> <a id="194" class="Keyword">using</a> <a id="200" class="Symbol">(</a><a id="201" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="205" class="Symbol">;</a> <a id="207" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="210" class="Symbol">;</a> <a id="212" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="214" class="Symbol">)</a>
<a id="216" class="Keyword">open</a> <a id="221" class="Keyword">import</a> <a id="228" href="Data.Product.html" class="Module">Data.Product</a> <a id="241" class="Keyword">using</a> <a id="247" class="Symbol">(</a><a id="248" href="Data.Product.html#1788" class="Function">∃-syntax</a><a id="256" class="Symbol">;</a> <a id="258" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="261" class="Symbol">;</a> <a id="263" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="266" class="Symbol">)</a>
<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Reflection.External.html" class="Module">Reflection.External</a>
<a id="300" class="Keyword">open</a> <a id="305" class="Keyword">import</a> <a id="312" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="350" class="Keyword">using</a> <a id="356" class="Symbol">(</a><a id="357" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="360" class="Symbol">;</a> <a id="362" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="366" class="Symbol">)</a>
<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Text.Parser.String.html" class="Module">Text.Parser.String</a>
<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="SMT.Theories.Core.html" class="Module">SMT.Theories.Core</a> <a id="429" class="Symbol">as</a> <a id="432" class="Module">Core</a>
<a id="437" class="Keyword">open</a> <a id="442" class="Keyword">import</a> <a id="449" href="SMT.Backend.Z3.html" class="Module">SMT.Backend.Z3</a> <a id="464" href="SMT.Theories.Core.html#2439" class="Function">Core.corePrintable</a> <a id="483" href="SMT.Theories.Core.html#2648" class="Function">Core.coreParsable</a>

<a id="502" class="Comment">-- |Taken from &lt;http://smtlib.cs.uiowa.edu/examples.shtml&gt;</a>
<a id="561" class="Comment">--</a>
<a id="564" class="Comment">-- @</a>
<a id="569" class="Comment">--   ; Boolean example</a>
<a id="592" class="Comment">--   (set-option :print-success false)</a>
<a id="631" class="Comment">--   (set-logic QF_UF)</a>
<a id="654" class="Comment">--   (declare-const p Bool)</a>
<a id="682" class="Comment">--   (assert (and p (not p)))</a>
<a id="712" class="Comment">--   (check-sat)</a>
<a id="729" class="Comment">--   ; unsat</a>
<a id="742" class="Comment">--   (exit)</a>
<a id="754" class="Comment">-- @</a>
<a id="759" class="Comment">--</a>
<a id="script₁"></a><a id="762" href="SMT.Theories.Core.Example.html#762" class="Function">script₁</a> <a id="770" class="Symbol">:</a> <a id="772" href="SMT.Script.Base.html#6232" class="Datatype">Script</a> <a id="779" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="782" class="Symbol">(</a><a id="783" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="788" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="790" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="792" class="Symbol">)</a> <a id="794" class="Symbol">(</a><a id="795" href="SMT.Script.Base.html#2738" class="InductiveConstructor">SAT</a> <a id="799" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="801" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="803" class="Symbol">)</a>
<a id="805" href="SMT.Theories.Core.Example.html#762" class="Function">script₁</a> <a id="813" class="Symbol">=</a> <a id="815" href="SMT.Script.Base.html#5950" class="InductiveConstructor">declare-const</a> <a id="829" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a>
        <a id="842" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="844" href="SMT.Script.Base.html#6003" class="InductiveConstructor">assert</a> <a id="851" class="Symbol">(</a><a id="852" href="SMT.Script.Base.html#1563" class="InductiveConstructor">app₂</a> <a id="857" href="SMT.Theories.Core.html#936" class="InductiveConstructor">and</a> <a id="861" href="SMT.Theories.Core.Example.html#934" class="Function">p</a> <a id="863" class="Symbol">(</a><a id="864" href="SMT.Script.Base.html#1525" class="InductiveConstructor">app₁</a> <a id="869" href="SMT.Theories.Core.html#860" class="InductiveConstructor">not</a> <a id="873" href="SMT.Theories.Core.Example.html#934" class="Function">p</a><a id="874" class="Symbol">))</a>
        <a id="885" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="887" href="SMT.Script.Base.html#6051" class="InductiveConstructor">check-sat</a>
        <a id="905" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="907" href="SMT.Script.Base.html#6295" class="InductiveConstructor">[]</a>
        <a id="918" class="Keyword">where</a>
          <a id="934" href="SMT.Theories.Core.Example.html#934" class="Function">p</a> <a id="936" class="Symbol">=</a> <a id="938" href="SMT.Script.Base.html#1146" class="InductiveConstructor">var</a> <a id="942" class="Symbol">(</a><a id="943" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="948" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="950" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="954" class="Symbol">)</a>

<a id="test₁"></a><a id="957" href="SMT.Theories.Core.Example.html#957" class="Function">test₁</a> <a id="963" class="Symbol">:</a> <a id="965" href="SMT.Backend.Z3.html#1863" class="Macro">z3</a> <a id="968" href="SMT.Theories.Core.Example.html#762" class="Function">script₁</a> <a id="976" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="978" href="SMT.Script.Base.html#2992" class="InductiveConstructor">unsat</a> <a id="984" href="SMT.Script.Base.html#4227" class="InductiveConstructor Operator">∷</a> <a id="986" href="SMT.Script.Base.html#4208" class="InductiveConstructor">[]</a>
<a id="989" href="SMT.Theories.Core.Example.html#957" class="Function">test₁</a> <a id="995" class="Symbol">=</a> <a id="997" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1003" class="Comment">-- |Pierce&#39;s law.</a>
<a id="term₂"></a><a id="1021" href="SMT.Theories.Core.Example.html#1021" class="Function">term₂</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="SMT.Script.Base.html#1101" class="Datatype">Term</a> <a id="1034" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1037" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a>
<a id="1042" href="SMT.Theories.Core.Example.html#1021" class="Function">term₂</a> <a id="1048" class="Symbol">=</a> <a id="1050" href="SMT.Script.Base.html#1328" class="InductiveConstructor">forAll</a> <a id="1057" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="1062" class="Symbol">(</a><a id="1063" href="SMT.Script.Base.html#1328" class="InductiveConstructor">forAll</a> <a id="1070" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="1075" class="Symbol">((</a><a id="1077" href="SMT.Script.Base.html#1563" class="InductiveConstructor">app₂</a> <a id="1082" href="SMT.Theories.Core.html#898" class="InductiveConstructor">implies</a> <a id="1090" class="Symbol">(</a><a id="1091" href="SMT.Script.Base.html#1563" class="InductiveConstructor">app₂</a> <a id="1096" href="SMT.Theories.Core.html#898" class="InductiveConstructor">implies</a> <a id="1104" class="Symbol">(</a><a id="1105" href="SMT.Script.Base.html#1563" class="InductiveConstructor">app₂</a> <a id="1110" href="SMT.Theories.Core.html#898" class="InductiveConstructor">implies</a> <a id="1118" href="SMT.Theories.Core.Example.html#1143" class="Function">p</a> <a id="1120" href="SMT.Theories.Core.Example.html#1173" class="Function">q</a><a id="1121" class="Symbol">)</a> <a id="1123" href="SMT.Theories.Core.Example.html#1143" class="Function">p</a><a id="1124" class="Symbol">)</a> <a id="1126" href="SMT.Theories.Core.Example.html#1143" class="Function">p</a><a id="1127" class="Symbol">)))</a>
  <a id="1133" class="Keyword">where</a>
    <a id="1143" href="SMT.Theories.Core.Example.html#1143" class="Function">p</a> <a id="1145" class="Symbol">=</a> <a id="1147" href="SMT.Script.Base.html#1146" class="InductiveConstructor">var</a> <a id="1151" class="Symbol">(</a><a id="1152" href="Data.Fin.Base.html#1119" class="InductiveConstructor">suc</a> <a id="1156" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="1161" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1163" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1167" class="Symbol">)</a>
    <a id="1173" href="SMT.Theories.Core.Example.html#1173" class="Function">q</a> <a id="1175" class="Symbol">=</a> <a id="1177" href="SMT.Script.Base.html#1146" class="InductiveConstructor">var</a> <a id="1181" class="Symbol">(</a>    <a id="1186" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="1191" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1193" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1197" class="Symbol">)</a>

<a id="script₂"></a><a id="1200" href="SMT.Theories.Core.Example.html#1200" class="Function">script₂</a> <a id="1208" class="Symbol">:</a> <a id="1210" href="SMT.Script.Base.html#6232" class="Datatype">Script</a> <a id="1217" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1220" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1223" class="Symbol">(</a><a id="1224" href="SMT.Script.Base.html#2738" class="InductiveConstructor">SAT</a> <a id="1228" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1230" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1232" class="Symbol">)</a>
<a id="1234" href="SMT.Theories.Core.Example.html#1200" class="Function">script₂</a> <a id="1242" class="Symbol">=</a> <a id="1244" href="SMT.Script.Base.html#6003" class="InductiveConstructor">assert</a> <a id="1251" href="SMT.Theories.Core.Example.html#1021" class="Function">term₂</a>
        <a id="1265" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="1267" href="SMT.Script.Base.html#6051" class="InductiveConstructor">check-sat</a>
        <a id="1285" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="1287" href="SMT.Script.Base.html#6295" class="InductiveConstructor">[]</a>

<a id="test₂"></a><a id="1291" href="SMT.Theories.Core.Example.html#1291" class="Function">test₂</a> <a id="1297" class="Symbol">:</a> <a id="1299" href="SMT.Backend.Z3.html#1863" class="Macro">z3</a> <a id="1302" href="SMT.Theories.Core.Example.html#1200" class="Function">script₂</a> <a id="1310" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1312" href="SMT.Script.Base.html#2976" class="InductiveConstructor">sat</a> <a id="1316" href="SMT.Script.Base.html#4227" class="InductiveConstructor Operator">∷</a> <a id="1318" href="SMT.Script.Base.html#4208" class="InductiveConstructor">[]</a>
<a id="1321" href="SMT.Theories.Core.Example.html#1291" class="Function">test₂</a> <a id="1327" class="Symbol">=</a> <a id="1329" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1335" class="Comment">-- |Getting models.</a>
<a id="script₃"></a><a id="1355" href="SMT.Theories.Core.Example.html#1355" class="Function">script₃</a> <a id="1363" class="Symbol">:</a> <a id="1365" href="SMT.Script.Base.html#6232" class="Datatype">Script</a> <a id="1372" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1375" class="Symbol">(</a><a id="1376" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="1381" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1383" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1385" class="Symbol">)</a> <a id="1387" class="Symbol">(</a><a id="1388" href="SMT.Script.Base.html#2759" class="InductiveConstructor">MODEL</a> <a id="1394" class="Symbol">(</a><a id="1395" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="1400" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1402" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1404" class="Symbol">)</a> <a id="1406" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1408" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1410" class="Symbol">)</a>
<a id="1412" href="SMT.Theories.Core.Example.html#1355" class="Function">script₃</a> <a id="1420" class="Symbol">=</a> <a id="1422" href="SMT.Script.Base.html#5950" class="InductiveConstructor">declare-const</a> <a id="1436" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a>
        <a id="1449" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="1451" href="SMT.Script.Base.html#6003" class="InductiveConstructor">assert</a> <a id="1458" class="Symbol">(</a><a id="1459" href="SMT.Script.Base.html#1146" class="InductiveConstructor">var</a> <a id="1463" class="Symbol">(</a><a id="1464" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="1469" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1471" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1475" class="Symbol">))</a>
        <a id="1486" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="1488" href="SMT.Script.Base.html#6093" class="InductiveConstructor">get-model</a>
        <a id="1506" href="SMT.Script.Base.html#6317" class="InductiveConstructor Operator">∷</a> <a id="1508" href="SMT.Script.Base.html#6295" class="InductiveConstructor">[]</a>

<a id="vp₃"></a><a id="1512" href="SMT.Theories.Core.Example.html#1512" class="Function">vp₃</a> <a id="1516" class="Symbol">:</a> <a id="1518" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1521" href="Text.Parser.String.html#2397" class="Function">Parser</a> <a id="1528" class="Symbol">(</a><a id="1529" href="Data.Product.html#1788" class="Function">∃[</a> <a id="1532" href="SMT.Theories.Core.Example.html#1532" class="Bound">σ</a> <a id="1534" href="Data.Product.html#1788" class="Function">]</a> <a id="1536" class="Symbol">((</a><a id="1538" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="1543" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1545" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1547" class="Symbol">)</a> <a id="1549" href="SMT.Script.Base.html#878" class="Function Operator">∋</a> <a id="1551" href="SMT.Theories.Core.Example.html#1532" class="Bound">σ</a><a id="1552" class="Symbol">))</a> <a id="1555" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="1557" href="SMT.Theories.Core.Example.html#1512" class="Function">vp₃</a> <a id="1561" class="Symbol">=</a> <a id="1563" href="SMT.Script.html#9173" class="Function">varParser</a> <a id="1573" href="SMT.Theories.Core.Example.html#1355" class="Function">script₃</a>

<a id="1582" href="SMT.Theories.Core.Example.html#1582" class="Function">_</a> <a id="1584" class="Symbol">:</a> <a id="1586" href="SMT.Theories.Core.Example.html#1512" class="Function">vp₃</a> <a id="1590" href="Text.Parser.String.html#7175" class="Function Operator">parses</a> <a id="1597" class="String">&quot;x0&quot;</a>
<a id="1602" class="Symbol">_</a> <a id="1604" class="Symbol">=</a> <a id="1606" href="Text.Parser.String.html#6783" class="InductiveConstructor Operator">!</a> <a id="1608" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="1613" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1615" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="1620" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1622" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>