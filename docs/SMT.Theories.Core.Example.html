<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SMT.Theories.Core.Example</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-exec</a> <a id="26" class="Symbol">#-}</a>

<a id="31" class="Keyword">module</a> <a id="38" href="SMT.Theories.Core.Example.html" class="Module">SMT.Theories.Core.Example</a> <a id="64" class="Keyword">where</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Data.Environment.html" class="Module">Data.Environment</a> <a id="100" class="Symbol">as</a> <a id="103" class="Module">Env</a> <a id="107" class="Keyword">using</a> <a id="113" class="Symbol">(</a><a id="114" href="Data.Environment.html#352" class="Datatype">Env</a><a id="117" class="Symbol">;</a> <a id="119" href="Data.Environment.html#419" class="InductiveConstructor Operator">_∷_</a><a id="122" class="Symbol">;</a> <a id="124" href="Data.Environment.html#402" class="InductiveConstructor">[]</a><a id="126" class="Symbol">)</a>
<a id="128" class="Keyword">open</a> <a id="133" class="Keyword">import</a> <a id="140" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="149" class="Keyword">using</a> <a id="155" class="Symbol">(</a><a id="156" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a><a id="159" class="Symbol">;</a> <a id="161" href="Data.Fin.Base.html#1119" class="InductiveConstructor">suc</a><a id="164" class="Symbol">;</a> <a id="166" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a><a id="170" class="Symbol">)</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Data.List.html" class="Module">Data.List</a> <a id="194" class="Keyword">using</a> <a id="200" class="Symbol">(</a><a id="201" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="205" class="Symbol">;</a> <a id="207" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="210" class="Symbol">;</a> <a id="212" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="214" class="Symbol">)</a>
<a id="216" class="Keyword">open</a> <a id="221" class="Keyword">import</a> <a id="228" href="Data.Product.html" class="Module">Data.Product</a> <a id="241" class="Keyword">using</a> <a id="247" class="Symbol">(</a><a id="248" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="251" class="Symbol">;</a> <a id="253" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="256" class="Symbol">)</a>
<a id="258" class="Keyword">open</a> <a id="263" class="Keyword">import</a> <a id="270" href="Reflection.External.html" class="Module">Reflection.External</a>
<a id="290" class="Keyword">open</a> <a id="295" class="Keyword">import</a> <a id="302" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="340" class="Keyword">using</a> <a id="346" class="Symbol">(</a><a id="347" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="350" class="Symbol">;</a> <a id="352" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="356" class="Symbol">)</a>

<a id="359" class="Keyword">open</a> <a id="364" class="Keyword">import</a> <a id="371" href="SMT.Theories.Core.html" class="Module">SMT.Theories.Core</a> <a id="389" class="Symbol">as</a> <a id="392" class="Module">Core</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="SMT.Script.html" class="Module">SMT.Script</a> <a id="420" href="SMT.Theories.Core.html#1999" class="Function">Core.coreTheory</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="SMT.Backend.Z3.html" class="Module">SMT.Backend.Z3</a> <a id="463" href="SMT.Theories.Core.html#2185" class="Function">Core.corePrintable</a> <a id="482" href="SMT.Theories.Core.html#2394" class="Function">Core.coreParsable</a>

<a id="501" class="Comment">-- |Taken from &lt;http://smtlib.cs.uiowa.edu/examples.shtml&gt;</a>
<a id="560" class="Comment">--</a>
<a id="563" class="Comment">-- @</a>
<a id="568" class="Comment">--   ; Boolean example</a>
<a id="591" class="Comment">--   (set-option :print-success false)</a>
<a id="630" class="Comment">--   (set-logic QF_UF)</a>
<a id="653" class="Comment">--   (declare-const p Bool)</a>
<a id="681" class="Comment">--   (assert (and p (not p)))</a>
<a id="711" class="Comment">--   (check-sat)</a>
<a id="728" class="Comment">--   ; unsat</a>
<a id="741" class="Comment">--   (exit)</a>
<a id="753" class="Comment">-- @</a>
<a id="758" class="Comment">--</a>
<a id="script₁"></a><a id="761" href="SMT.Theories.Core.Example.html#761" class="Function">script₁</a> <a id="769" class="Symbol">:</a> <a id="771" href="SMT.Script.html#4729" class="Datatype">Script</a> <a id="778" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="781" class="Symbol">(</a><a id="782" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a> <a id="787" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="789" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="791" class="Symbol">)</a> <a id="793" class="Symbol">(</a><a id="794" href="SMT.Script.html#2455" class="InductiveConstructor">SAT</a> <a id="798" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="800" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="802" class="Symbol">)</a>
<a id="804" href="SMT.Theories.Core.Example.html#761" class="Function">script₁</a> <a id="812" class="Symbol">=</a> <a id="814" href="SMT.Script.html#4431" class="InductiveConstructor">declare-const</a> <a id="828" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a>
        <a id="841" href="SMT.Script.html#4814" class="InductiveConstructor Operator">∷</a> <a id="843" href="SMT.Script.html#4486" class="InductiveConstructor">assert</a> <a id="850" class="Symbol">(</a><a id="851" href="SMT.Script.html#1492" class="InductiveConstructor">app₂</a> <a id="856" href="SMT.Theories.Core.html#936" class="InductiveConstructor">and</a> <a id="860" href="SMT.Theories.Core.Example.html#933" class="Function">p</a> <a id="862" class="Symbol">(</a><a id="863" href="SMT.Script.html#1454" class="InductiveConstructor">app₁</a> <a id="868" href="SMT.Theories.Core.html#860" class="InductiveConstructor">not</a> <a id="872" href="SMT.Theories.Core.Example.html#933" class="Function">p</a><a id="873" class="Symbol">))</a>
        <a id="884" href="SMT.Script.html#4814" class="InductiveConstructor Operator">∷</a> <a id="886" href="SMT.Script.html#4536" class="InductiveConstructor">check-sat</a>
        <a id="904" href="SMT.Script.html#4814" class="InductiveConstructor Operator">∷</a> <a id="906" href="SMT.Script.html#4792" class="InductiveConstructor">[]</a>
        <a id="917" class="Keyword">where</a>
          <a id="933" href="SMT.Theories.Core.Example.html#933" class="Function">p</a> <a id="935" class="Symbol">=</a> <a id="937" href="SMT.Script.html#1089" class="InductiveConstructor">var</a> <a id="941" class="Symbol">(</a><a id="942" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="947" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="949" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="953" class="Symbol">)</a>

<a id="test₁"></a><a id="956" href="SMT.Theories.Core.Example.html#956" class="Function">test₁</a> <a id="962" class="Symbol">:</a> <a id="964" href="SMT.Backend.Z3.html#1371" class="Macro">runZ3</a> <a id="970" href="SMT.Theories.Core.Example.html#761" class="Function">script₁</a> <a id="978" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="980" href="SMT.Script.html#2708" class="InductiveConstructor">unsat</a> <a id="986" href="SMT.Script.html#3633" class="InductiveConstructor Operator">∷</a> <a id="988" href="SMT.Script.html#3614" class="InductiveConstructor">[]</a>
<a id="991" href="SMT.Theories.Core.Example.html#956" class="Function">test₁</a> <a id="997" class="Symbol">=</a> <a id="999" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="1005" class="Comment">-- |Pierce&#39;s law.</a>
<a id="term₂"></a><a id="1023" href="SMT.Theories.Core.Example.html#1023" class="Function">term₂</a> <a id="1029" class="Symbol">:</a> <a id="1031" href="SMT.Script.html#1044" class="Datatype">Term</a> <a id="1036" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1039" href="SMT.Theories.Core.html#472" class="InductiveConstructor">BOOL</a>
<a id="1044" href="SMT.Theories.Core.Example.html#1023" class="Function">term₂</a> <a id="1050" class="Symbol">=</a> <a id="1052" href="SMT.Script.html#1271" class="InductiveConstructor">forAll</a> <a id="1059" class="Symbol">(</a><a id="1060" href="SMT.Script.html#1271" class="InductiveConstructor">forAll</a> <a id="1067" class="Symbol">((</a><a id="1069" href="SMT.Script.html#1492" class="InductiveConstructor">app₂</a> <a id="1074" href="SMT.Theories.Core.html#898" class="InductiveConstructor">implies</a> <a id="1082" class="Symbol">(</a><a id="1083" href="SMT.Script.html#1492" class="InductiveConstructor">app₂</a> <a id="1088" href="SMT.Theories.Core.html#898" class="InductiveConstructor">implies</a> <a id="1096" class="Symbol">(</a><a id="1097" href="SMT.Script.html#1492" class="InductiveConstructor">app₂</a> <a id="1102" href="SMT.Theories.Core.html#898" class="InductiveConstructor">implies</a> <a id="1110" href="SMT.Theories.Core.Example.html#1135" class="Function">p</a> <a id="1112" href="SMT.Theories.Core.Example.html#1165" class="Function">q</a><a id="1113" class="Symbol">)</a> <a id="1115" href="SMT.Theories.Core.Example.html#1135" class="Function">p</a><a id="1116" class="Symbol">)</a> <a id="1118" href="SMT.Theories.Core.Example.html#1135" class="Function">p</a><a id="1119" class="Symbol">)))</a>
  <a id="1125" class="Keyword">where</a>
    <a id="1135" href="SMT.Theories.Core.Example.html#1135" class="Function">p</a> <a id="1137" class="Symbol">=</a> <a id="1139" href="SMT.Script.html#1089" class="InductiveConstructor">var</a> <a id="1143" class="Symbol">(</a><a id="1144" href="Data.Fin.Base.html#1119" class="InductiveConstructor">suc</a> <a id="1148" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="1153" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1155" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1159" class="Symbol">)</a>
    <a id="1165" href="SMT.Theories.Core.Example.html#1165" class="Function">q</a> <a id="1167" class="Symbol">=</a> <a id="1169" href="SMT.Script.html#1089" class="InductiveConstructor">var</a> <a id="1173" class="Symbol">(</a>    <a id="1178" href="Data.Fin.Base.html#1088" class="InductiveConstructor">zero</a> <a id="1183" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1185" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1189" class="Symbol">)</a>

<a id="script₂"></a><a id="1192" href="SMT.Theories.Core.Example.html#1192" class="Function">script₂</a> <a id="1200" class="Symbol">:</a> <a id="1202" href="SMT.Script.html#4729" class="Datatype">Script</a> <a id="1209" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1212" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1215" class="Symbol">(</a><a id="1216" href="SMT.Script.html#2455" class="InductiveConstructor">SAT</a> <a id="1220" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1222" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1224" class="Symbol">)</a>
<a id="1226" href="SMT.Theories.Core.Example.html#1192" class="Function">script₂</a> <a id="1234" class="Symbol">=</a> <a id="1236" href="SMT.Script.html#4486" class="InductiveConstructor">assert</a> <a id="1243" href="SMT.Theories.Core.Example.html#1023" class="Function">term₂</a>
        <a id="1257" href="SMT.Script.html#4814" class="InductiveConstructor Operator">∷</a> <a id="1259" href="SMT.Script.html#4536" class="InductiveConstructor">check-sat</a>
        <a id="1277" href="SMT.Script.html#4814" class="InductiveConstructor Operator">∷</a> <a id="1279" href="SMT.Script.html#4792" class="InductiveConstructor">[]</a>

<a id="test₂"></a><a id="1283" href="SMT.Theories.Core.Example.html#1283" class="Function">test₂</a> <a id="1289" class="Symbol">:</a> <a id="1291" href="SMT.Backend.Z3.html#1371" class="Macro">runZ3</a> <a id="1297" href="SMT.Theories.Core.Example.html#1192" class="Function">script₂</a> <a id="1305" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1307" href="SMT.Script.html#2692" class="InductiveConstructor">sat</a> <a id="1311" href="SMT.Script.html#3633" class="InductiveConstructor Operator">∷</a> <a id="1313" href="SMT.Script.html#3614" class="InductiveConstructor">[]</a>
<a id="1316" href="SMT.Theories.Core.Example.html#1283" class="Function">test₂</a> <a id="1322" class="Symbol">=</a> <a id="1324" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>